"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1337],{6463:function(e,r,t){var n=t(1169);t.o(n,"useParams")&&t.d(r,{useParams:function(){return n.useParams}}),t.o(n,"usePathname")&&t.d(r,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(r,{useRouter:function(){return n.useRouter}}),t.o(n,"useSearchParams")&&t.d(r,{useSearchParams:function(){return n.useSearchParams}})},97:function(e,r,t){t.d(r,{Z:function(){return l}});var n=t(7437),s=t(2265);function l(e){let{text:r,side:t="top",className:l="",sizePx:a=16}=e,i=s.useId(),o=(()=>{switch(t){case"bottom":return"left-1/2 -translate-x-1/2 top-full mt-1";case"left":return"right-full mr-2 top-1/2 -translate-y-1/2";case"right":return"left-full ml-2 top-1/2 -translate-y-1/2";default:return"left-1/2 -translate-x-1/2 bottom-full mb-1"}})(),d="absolute w-0 h-0 border-transparent",u=Math.max(12,Math.min(22,a)),c=(()=>{switch(t){case"bottom":return(0,n.jsx)("span",{"aria-hidden":!0,className:"".concat(d," left-1/2 -translate-x-1/2 -top-[6px] border-b-white border-[6px]"),style:{borderTopWidth:0,borderLeftColor:"transparent",borderRightColor:"transparent"}});case"left":return(0,n.jsx)("span",{"aria-hidden":!0,className:"".concat(d," -right-[6px] top-1/2 -translate-y-1/2 border-l-white border-[6px]"),style:{borderTopColor:"transparent",borderBottomColor:"transparent",borderRightWidth:0}});case"right":return(0,n.jsx)("span",{"aria-hidden":!0,className:"".concat(d," -left-[6px] top-1/2 -translate-y-1/2 border-r-white border-[6px]"),style:{borderTopColor:"transparent",borderBottomColor:"transparent",borderLeftWidth:0}});default:return(0,n.jsx)("span",{"aria-hidden":!0,className:"".concat(d," left-1/2 -translate-x-1/2 -bottom-[6px] border-t-white border-[6px]"),style:{borderLeftColor:"transparent",borderRightColor:"transparent",borderBottomWidth:0}})}})();return(0,n.jsx)("span",{className:"relative inline-flex items-center align-middle ".concat(l),children:(0,n.jsxs)("span",{className:"group relative inline-flex",children:[(0,n.jsx)("button",{type:"button","aria-describedby":i,className:"inline-flex items-center justify-center rounded-full border text-[10px] leading-none select-none cursor-help text-gray-700 border-gray-300 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-black",style:{width:u,height:u},children:"?"}),(0,n.jsxs)("span",{id:i,role:"tooltip",className:"".concat("pointer-events-none absolute z-50 hidden max-w-xs rounded-md border bg-white px-2 py-1 text-xs text-gray-700 shadow-lg"," ").concat(o," group-hover:block group-focus-within:block"),children:[r,c]})]})})}},939:function(e,r,t){t.d(r,{Z:function(){return d}});var n=t(7437),s=t(2265),l=t(6163),a=t(5058);function i(e){let{title:r,children:t}=e;return(0,n.jsxs)("section",{className:"rounded-xl border bg-white p-3",children:[(0,n.jsx)("div",{className:"text-[12px] font-semibold uppercase mb-1",children:r}),t]})}function o(e){let{values:r,maxHint:t,height:s=60,barWidth:l=12,gap:a=4,titlePrefix:i="",tone:o="emerald"}=e,d=Math.max(null!=t?t:0,...r,1),u={gray:"bg-gray-300",emerald:"bg-emerald-400/80",amber:"bg-amber-400/80",red:"bg-red-400/80"};return(0,n.jsx)("div",{className:"flex items-end gap-1 overflow-x-auto",style:{height:s},children:r.map((e,r)=>(0,n.jsx)("div",{title:"".concat(i).concat(e),className:"rounded-sm ".concat(u[o]),style:{width:l,height:Math.max(2,Math.round(e/d*(s-10))),marginRight:a}},r))})}function d(e){var r;let{open:t,onClose:d,playerName:u,date:c}=e,[h,x]=(0,s.useState)(!1),[m,f]=(0,s.useState)([]),[p,b]=(0,s.useState)(null),[g,v]=(0,s.useState)([]);(0,s.useEffect)(()=>{t&&u&&(async()=>{x(!0);try{let t=Array.from({length:7},(e,r)=>(0,l.Op)((0,l.E4)((0,l.lN)(c),-r))),n=await Promise.all(t.map(e=>fetch("/api/metrics/wellness?date=".concat(e),{cache:"no-store"}).then(e=>e.ok?e.json():[]))),s=[],i=null;for(let e=0;e<n.length;e++){let r=(Array.isArray(n[e])?n[e]:[]).find(e=>{var r,t;return(e.userName||(null===(r=e.user)||void 0===r?void 0:r.name)||(null===(t=e.user)||void 0===t?void 0:t.email)||e.playerKey||"—")===u});0===e&&(i=null!=r?r:null),s.push(r?Number((0,l.bq)(r).toFixed(2)):0)}b(i),f(s);let o=Array.from({length:10},(e,r)=>(0,l.Op)((0,l.E4)((0,l.lN)(c),-r))),d=await Promise.all(o.map(e=>fetch("/api/metrics/rpe?date=".concat(e),{cache:"no-store"}).then(e=>e.ok?e.json():[]))),h=[];for(let t=0;t<d.length;t++)for(let n of Array.isArray(d[t])?d[t]:[]){var e,r;(n.userName||n.playerKey||(null===(e=n.user)||void 0===e?void 0:e.name)||(null===(r=n.user)||void 0===r?void 0:r.email)||"Jugador")===u&&h.push({...n,date:o[t]})}let x=h.map(e=>({...e,_au:(0,a.uC)(e)})).filter(e=>e._au&&!Number.isNaN(e._au));x.sort((e,r)=>r.date>e.date?1:r.date<e.date?-1:0),v(x.slice(0,5))}finally{x(!1)}})()},[t,u,c]);let j=(0,s.useMemo)(()=>m.length?Number((0,l.J6)(m).toFixed(2)):null,[m]);return t?(0,n.jsxs)("div",{className:"fixed inset-0 z-[60]",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:d,"aria-hidden":"true"}),(0,n.jsxs)("div",{className:"absolute right-0 top-0 h-full w-full max-w-[420px] bg-white shadow-2xl flex flex-col",children:[(0,n.jsxs)("div",{className:"p-3 border-b flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-xs uppercase text-gray-500",children:"Resumen r\xe1pido"}),(0,n.jsx)("div",{className:"text-lg font-bold",children:u||"Jugador"})]}),(0,n.jsx)("button",{onClick:d,className:"rounded-lg border px-2 py-1 text-sm hover:bg-gray-50","aria-label":"Cerrar",children:"Cerrar"})]}),(0,n.jsx)("div",{className:"p-3 space-y-3 overflow-auto",children:h?(0,n.jsx)("div",{className:"text-gray-500",children:"Cargando…"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i,{title:"Wellness — \xfaltimos 7 d\xedas",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-[11px] text-gray-500",children:"SDW promedio (7d)"}),(0,n.jsx)("div",{className:"text-xl font-semibold",children:null!=j?j:"—"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-[11px] text-gray-500",children:"Hoy"}),(0,n.jsx)("div",{className:"text-xl font-semibold",children:p?(0,l.bq)(p).toFixed(2):"—"})]})]}),(0,n.jsxs)("div",{className:"mt-2",children:[(0,n.jsx)(o,{values:m,maxHint:5,titlePrefix:"SDW: "}),(0,n.jsx)("div",{className:"mt-1 text-[11px] text-gray-500",children:"Serie: hoy → hace 6 d\xedas (m\xe1s alto = mejor)"})]}),p&&(0,n.jsxs)("div",{className:"mt-2 text-xs text-gray-700 grid grid-cols-2 gap-1",children:[(0,n.jsxs)("div",{children:["Sue\xf1o: ",(0,n.jsx)("b",{children:p.sleepQuality})]}),(0,n.jsxs)("div",{children:["Horas: ",(0,n.jsx)("b",{children:null!==(r=p.sleepHours)&&void 0!==r?r:"—"})]}),(0,n.jsxs)("div",{children:["Fatiga: ",(0,n.jsx)("b",{children:p.fatigue})]}),(0,n.jsxs)("div",{children:["Dolor: ",(0,n.jsx)("b",{children:p.muscleSoreness})]}),(0,n.jsxs)("div",{children:["Estr\xe9s: ",(0,n.jsx)("b",{children:p.stress})]}),(0,n.jsxs)("div",{children:["\xc1nimo: ",(0,n.jsx)("b",{children:p.mood})]})]})]}),(0,n.jsx)(i,{title:"RPE — \xfaltimos registros",children:0===g.length?(0,n.jsx)("div",{className:"text-gray-500 text-sm",children:"Sin AU recientes"}):(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-[11px] text-gray-500",children:[(0,n.jsx)("div",{children:"Fecha"}),(0,n.jsx)("div",{children:"RPE \xd7 min"}),(0,n.jsx)("div",{className:"text-right",children:"sRPE (AU)"})]}),g.map((e,r)=>{var t;let s=(0,a.uC)(e);return(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,n.jsx)("div",{children:e.date}),(0,n.jsxs)("div",{children:[Number(e.rpe).toFixed(0)," \xd7 ",null!==(t=e.duration)&&void 0!==t?t:"—"]}),(0,n.jsx)("div",{className:"text-right font-semibold",children:s?Math.round(s):"—"})]},r)})]})})]})})]})]}):null}},5058:function(e,r,t){function n(e){var r;if(null!=e.load)return Number(e.load);let t=null==e.duration?0:Number(e.duration);return Number(null!==(r=e.rpe)&&void 0!==r?r:0)*t}function s(e){return e.length?e.reduce((e,r)=>e+r,0)/e.length:0}t.d(r,{J6:function(){return s},uC:function(){return n}})},6163:function(e,r,t){function n(e){return e.toISOString().slice(0,10)}function s(e){let[r,t,n]=e.split("-").map(Number);return new Date(r,t-1,n)}function l(e,r){let t=new Date(e);return t.setDate(t.getDate()+r),t}function a(e){return n(l(s(e),-1))}function i(e){return e.length?e.reduce((e,r)=>e+r,0)/e.length:0}function o(e){let r=e.length;if(r<2)return 0;let t=i(e);return Math.sqrt(e.reduce((e,r)=>e+(r-t)*(r-t),0)/(r-1))}function d(e){var r,t,n,s,l;let a=[Number(null!==(r=e.sleepQuality)&&void 0!==r?r:0),Number(null!==(t=e.fatigue)&&void 0!==t?t:0),Number(null!==(n=e.muscleSoreness)&&void 0!==n?n:0),Number(null!==(s=e.stress)&&void 0!==s?s:0),Number(null!==(l=e.mood)&&void 0!==l?l:0)].filter(e=>e>0);return a.length?a.reduce((e,r)=>e+r,0)/a.length:0}function u(e){return null===e?"yellow":e>=-.5?"green":e>=-1?"yellow":"red"}function c(e,r){var t,n,s;let l=e,a=null!==(t=r.sleepHours)&&void 0!==t?t:null;return null!==a&&a<4&&(l="green"===l?"yellow":l),(null!==(n=r.muscleSoreness)&&void 0!==n?n:3)<=2&&(l="red"),(null!==(s=r.stress)&&void 0!==s?s:3)<=2&&(l="green"===l?"yellow":l),l}t.d(r,{Cv:function(){return a},D1:function(){return o},E4:function(){return l},HW:function(){return u},J6:function(){return i},Op:function(){return n},RW:function(){return c},bq:function(){return d},lN:function(){return s}})}}]);