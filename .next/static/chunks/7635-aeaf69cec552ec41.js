"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7635],{6463:function(e,t,l){var a=l(1169);l.o(a,"useParams")&&l.d(t,{useParams:function(){return a.useParams}}),l.o(a,"usePathname")&&l.d(t,{usePathname:function(){return a.usePathname}}),l.o(a,"useRouter")&&l.d(t,{useRouter:function(){return a.useRouter}}),l.o(a,"useSearchParams")&&l.d(t,{useSearchParams:function(){return a.useSearchParams}})},97:function(e,t,l){l.d(t,{Z:function(){return n}});var a=l(7437),s=l(2265);function n(e){let{text:t,side:l="top",className:n="",sizePx:r=16}=e,i=s.useId(),d=(()=>{switch(l){case"bottom":return"left-1/2 -translate-x-1/2 top-full mt-1";case"left":return"right-full mr-2 top-1/2 -translate-y-1/2";case"right":return"left-full ml-2 top-1/2 -translate-y-1/2";default:return"left-1/2 -translate-x-1/2 bottom-full mb-1"}})(),o="absolute w-0 h-0 border-transparent",c=Math.max(12,Math.min(22,r)),u=(()=>{switch(l){case"bottom":return(0,a.jsx)("span",{"aria-hidden":!0,className:"".concat(o," left-1/2 -translate-x-1/2 -top-[6px] border-b-white border-[6px]"),style:{borderTopWidth:0,borderLeftColor:"transparent",borderRightColor:"transparent"}});case"left":return(0,a.jsx)("span",{"aria-hidden":!0,className:"".concat(o," -right-[6px] top-1/2 -translate-y-1/2 border-l-white border-[6px]"),style:{borderTopColor:"transparent",borderBottomColor:"transparent",borderRightWidth:0}});case"right":return(0,a.jsx)("span",{"aria-hidden":!0,className:"".concat(o," -left-[6px] top-1/2 -translate-y-1/2 border-r-white border-[6px]"),style:{borderTopColor:"transparent",borderBottomColor:"transparent",borderLeftWidth:0}});default:return(0,a.jsx)("span",{"aria-hidden":!0,className:"".concat(o," left-1/2 -translate-x-1/2 -bottom-[6px] border-t-white border-[6px]"),style:{borderLeftColor:"transparent",borderRightColor:"transparent",borderBottomWidth:0}})}})();return(0,a.jsx)("span",{className:"relative inline-flex items-center align-middle ".concat(n),children:(0,a.jsxs)("span",{className:"group relative inline-flex",children:[(0,a.jsx)("button",{type:"button","aria-describedby":i,className:"inline-flex items-center justify-center rounded-full border text-[10px] leading-none select-none cursor-help text-gray-700 border-gray-300 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-black",style:{width:c,height:c},children:"?"}),(0,a.jsxs)("span",{id:i,role:"tooltip",className:"".concat("pointer-events-none absolute z-50 hidden max-w-xs rounded-md border bg-white px-2 py-1 text-xs text-gray-700 shadow-lg"," ").concat(d," group-hover:block group-focus-within:block"),children:[t,u]})]})})}},3010:function(e,t,l){l.d(t,{Z:function(){return o}});var a=l(7437),s=l(2265);function n(e){let{value:t,onChange:l,label:n="Jugador",disabled:r,className:i}=e,{players:d,loading:o,error:c,reload:u}=function(e){let[t,l]=s.useState([]),[a,n]=s.useState(!1),[r,i]=s.useState(null),d=s.useCallback(async()=>{n(!0),i(null);try{let t=await fetch(e,{cache:"no-store"});if(!t.ok)throw Error("HTTP ".concat(t.status));let a=await t.json(),s=(Array.isArray(a)?a:[]).map(e=>({id:e.id,label:e.name||e.email||e.id}));l(s),0===s.length&&i("EMPTY")}catch(e){l([]),i("ERR")}finally{n(!1)}},[e]);return s.useEffect(()=>{d()},[d]),{players:t,loading:a,error:r,reload:d}}("/api/medico/users/players");return(0,a.jsxs)("div",{className:null!=i?i:"",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:n}),(0,a.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,a.jsxs)("select",{className:"h-10 w-full rounded-md border px-3 text-sm",disabled:r||o||!!c,value:t,onChange:e=>l(e.target.value),children:[(0,a.jsx)("option",{value:"",children:o?"Cargando jugadores...":c?"Error al cargar":0===d.length?"Sin jugadores":"Seleccionar jugador"}),d.map(e=>(0,a.jsx)("option",{value:e.id,children:e.label},e.id))]}),c&&(0,a.jsx)("button",{type:"button",onClick:u,className:"h-10 rounded-md border px-3 text-sm",children:"Reintentar"})]}),!o&&!c&&0===d.length&&(0,a.jsxs)("p",{className:"mt-1 text-xs text-amber-600",children:["No hay usuarios con rol ",(0,a.jsx)("b",{children:"JUGADOR"}),"."]})]})}var r=l(97),i=l(5960);function d(e,t){let[l,a,s]=e.split("-").map(e=>Number(e)),n=new Date(l,(a||1)-1,s||1);n.setDate(n.getDate()+t);let r=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),d=String(n.getDate()).padStart(2,"0");return"".concat(r,"-").concat(i,"-").concat(d)}function o(e){var t,l,o,c,u,m,x,h,p,v,b,g,j,N,f,S,E,y,C,A,R,w,D,O,I,T;let{initial:k,defaultDate:M,onCancel:L,onSaved:P}=e,{saveEpisode:F}=(0,i.Z)(M||(0,i.y)()),[G,B]=s.useState(null!==(t=null==k?void 0:k.userId)&&void 0!==t?t:""),[J,Z]=s.useState(null!==(l=null==k?void 0:k.status)&&void 0!==l?l:"LIMITADA"),[_,H]=s.useState(null!==(o=null==k?void 0:k.date)&&void 0!==o?o:M||(0,i.y)()),[V,U]=s.useState(null!==(c=null==k?void 0:k.leaveStage)&&void 0!==c?c:""),[W,Y]=s.useState(null!==(u=null==k?void 0:k.leaveKind)&&void 0!==u?u:""),[q,X]=s.useState(null!==(m=null==k?void 0:k.diagnosis)&&void 0!==m?m:""),[z,K]=s.useState(null!==(x=null==k?void 0:k.bodyPart)&&void 0!==x?x:""),[Q,$]=s.useState(null!==(h=null==k?void 0:k.laterality)&&void 0!==h?h:""),[ee,et]=s.useState(null!==(p=null==k?void 0:k.mechanism)&&void 0!==p?p:""),[el,ea]=s.useState(null!==(v=null==k?void 0:k.severity)&&void 0!==v?v:""),[es,en]=s.useState(null!==(b=null==k?void 0:k.illSystem)&&void 0!==b?b:""),[er,ei]=s.useState(null!==(g=null==k?void 0:k.illSymptoms)&&void 0!==g?g:""),[ed,eo]=s.useState(!!(null==k?void 0:k.illContagious)),[ec,eu]=s.useState(null!==(j=null==k?void 0:k.illIsolationDays)&&void 0!==j?j:""),[em,ex]=s.useState(null!==(N=null==k?void 0:k.illAptitude)&&void 0!==N?N:""),[eh,ep]=s.useState(null!==(f=null==k?void 0:k.feverMax)&&void 0!==f?f:""),[ev,eb]=s.useState(null!==(S=null==k?void 0:k.startDate)&&void 0!==S?S:_),eg=(null==k?void 0:k.expectedReturn)&&(null!==(E=null==k?void 0:k.startDate)&&void 0!==E?E:ev)?function(e,t){let[l,a,s]=e.split("-").map(Number),[n,r,i]=t.split("-").map(Number),d=new Date(l,(a||1)-1,s||1),o=new Date(n,(r||1)-1,i||1);return d.setHours(0,0,0,0),o.setHours(0,0,0,0),Math.max(0,Math.round((d.getTime()-o.getTime())/864e5))}(k.expectedReturn,null!==(y=k.startDate)&&void 0!==y?y:ev):"",[ej,eN]=s.useState(eg),[ef,eS]=s.useState(null!==(C=null==k?void 0:k.expectedReturn)&&void 0!==C?C:ev&&Number(ej)?d(ev,Number(ej)):""),[eE,ey]=s.useState(!!(null==k?void 0:k.expectedReturnManual)),[eC,eA]=s.useState(null!==(A=null==k?void 0:k.capMinutes)&&void 0!==A?A:""),[eR,ew]=s.useState(!!(null==k?void 0:k.noSprint)),[eD,eO]=s.useState(!!(null==k?void 0:k.noChangeOfDirection)),[eI,eT]=s.useState(!!(null==k?void 0:k.gymOnly)),[ek,eM]=s.useState(!!(null==k?void 0:k.noContact)),[eL,eP]=s.useState(null!==(R=null==k?void 0:k.notes)&&void 0!==R?R:""),[eF,eG]=s.useState(null!==(w=null==k?void 0:k.medSignature)&&void 0!==w?w:""),[eB,eJ]=s.useState(null!==(D=null==k?void 0:k.protocolObjectives)&&void 0!==D?D:""),[eZ,e_]=s.useState(null!==(O=null==k?void 0:k.protocolTasks)&&void 0!==O?O:""),[eH,eV]=s.useState(null!==(I=null==k?void 0:k.protocolControls)&&void 0!==I?I:""),[eU,eW]=s.useState(null!==(T=null==k?void 0:k.protocolCriteria)&&void 0!==T?T:""),[eY,eq]=s.useState(!1),[eX,ez]=s.useState(null),[eK,eQ]=s.useState(null),e$="BAJA"===J,e0="LIMITADA"===J||"REINTEGRO"===J;async function e1(e){if(e.preventDefault(),eQ(null),ez(null),!G)return eQ("Seleccion\xe1 un jugador.");if(!J)return eQ("Seleccion\xe1 el estado.");if(!eF.trim())return eQ("La firma del m\xe9dico es obligatoria.");if(e$){if(!W)return eQ("Indic\xe1 si es LESI\xd3N o ENFERMEDAD.");if("LESION"===W&&!q.trim())return eQ("Para lesi\xf3n, el diagn\xf3stico es obligatorio.");if("ENFERMEDAD"===W&&!er.trim()&&!q.trim())return eQ("Para enfermedad, indic\xe1 s\xedntomas o diagn\xf3stico breve.")}eq(!0);try{let e={userId:G,date:_,status:J,leaveStage:e$&&V?V:null,leaveKind:e$&&W?W:null,diagnosis:e$&&"LESION"===W&&q||null,bodyPart:e$&&"LESION"===W&&z||null,laterality:e$&&"LESION"===W&&Q||null,mechanism:e$&&"LESION"===W&&ee||null,severity:e$&&"LESION"===W&&el||null,illSystem:e$&&"ENFERMEDAD"===W&&es||null,illSymptoms:e$&&"ENFERMEDAD"===W&&er||null,illContagious:e$&&"ENFERMEDAD"===W?!!ed:null,illIsolationDays:e$&&"ENFERMEDAD"===W&&""!==ec?Number(ec):null,illAptitude:e$&&"ENFERMEDAD"===W&&em||null,feverMax:e$&&"ENFERMEDAD"===W&&""!==eh?Number(eh):null,startDate:ev||null,expectedReturn:ef||null,expectedReturnManual:eE||!1,capMinutes:e0&&""!==eC?Number(eC):null,noSprint:!!e0&&eR,noChangeOfDirection:!!e0&&eD,gymOnly:!!e0&&eI,noContact:!!e0&&ek,notes:eL||null,medSignature:eF||null,protocolObjectives:eB||null,protocolTasks:eZ||null,protocolControls:eH||null,protocolCriteria:eU||null};await F(e),ez({kind:"ok",text:"Parte cl\xednico guardado correctamente."}),null==P||P()}catch(e){eQ((null==e?void 0:e.message)||"No se pudo guardar.")}finally{eq(!1)}}return s.useEffect(()=>{eE||(ev&&Number(ej)?eS(d(ev,Number(ej))):eS(""))},[ev,ej,eE]),(0,a.jsxs)("form",{onSubmit:e1,className:"space-y-5",children:[(0,a.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Jugador"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(n,{value:G,onChange:B,disabled:!!(null==k?void 0:k.id)||eY})}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"El CT lo ver\xe1 en lectura."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Fecha del parte"}),(0,a.jsx)("input",{type:"date",className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:_,onChange:e=>H(e.target.value),disabled:eY})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Estado"}),(0,a.jsxs)("select",{className:"h-10 w-full rounded-md border px-3 text-sm",value:J,onChange:e=>Z(e.target.value),disabled:eY,children:[(0,a.jsx)("option",{value:"BAJA",children:"BAJA"}),(0,a.jsx)("option",{value:"REINTEGRO",children:"REINTEGRO (RTP)"}),(0,a.jsx)("option",{value:"LIMITADA",children:"LIMITADA"}),(0,a.jsx)("option",{value:"ALTA",children:"ALTA"})]})]}),"BAJA"===J&&(0,a.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Estadio de la baja"}),(0,a.jsxs)("select",{className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:V,onChange:e=>U(e.target.value),disabled:eY,children:[(0,a.jsx)("option",{value:"",children:"—"}),(0,a.jsx)("option",{value:"PARTIDO",children:"Partido (competencia)"}),(0,a.jsx)("option",{value:"ENTRENAMIENTO",children:"Entrenamiento"}),(0,a.jsx)("option",{value:"EXTRADEPORTIVO",children:"Extra deportivo"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Condici\xf3n"}),(0,a.jsxs)("select",{className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:W,onChange:e=>Y(e.target.value),disabled:eY,children:[(0,a.jsx)("option",{value:"",children:"—"}),(0,a.jsx)("option",{value:"LESION",children:"Lesi\xf3n"}),(0,a.jsx)("option",{value:"ENFERMEDAD",children:"Enfermedad"})]})]})]}),"BAJA"===J&&"LESION"===W&&(0,a.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Diagn\xf3stico breve"}),(0,a.jsx)("input",{className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:q,onChange:e=>X(e.target.value),placeholder:'Ej: "Distensi\xf3n isquiotibial grado I"',disabled:eY})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Zona / Parte del cuerpo"}),(0,a.jsx)("input",{className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:z,onChange:e=>K(e.target.value),placeholder:"Ej: Isquiotibiales, tobillo...",disabled:eY})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Lateralidad"}),(0,a.jsxs)("select",{className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:Q,onChange:e=>$(e.target.value),disabled:eY,children:[(0,a.jsx)("option",{value:"",children:"—"}),(0,a.jsx)("option",{value:"IZQ",children:"Izq"}),(0,a.jsx)("option",{value:"DER",children:"Der"}),(0,a.jsx)("option",{value:"BILATERAL",children:"Bilateral"}),(0,a.jsx)("option",{value:"NA",children:"N/A"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Mecanismo"}),(0,a.jsxs)("select",{className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:ee,onChange:e=>et(e.target.value),disabled:eY,children:[(0,a.jsx)("option",{value:"",children:"—"}),(0,a.jsx)("option",{value:"SOBRECARGA",children:"Sobrecarga"}),(0,a.jsx)("option",{value:"IMPACTO",children:"Impacto"}),(0,a.jsx)("option",{value:"TORSION",children:"Torsi\xf3n"}),(0,a.jsx)("option",{value:"ESTIRAMIENTO",children:"Estiramiento brusco"}),(0,a.jsx)("option",{value:"RECIDIVA",children:"Recidiva"}),(0,a.jsx)("option",{value:"OTRO",children:"Otro"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Gravedad"}),(0,a.jsxs)("select",{className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:el,onChange:e=>ea(e.target.value),disabled:eY,children:[(0,a.jsx)("option",{value:"",children:"—"}),(0,a.jsx)("option",{value:"LEVE",children:"Leve"}),(0,a.jsx)("option",{value:"MODERADA",children:"Moderada"}),(0,a.jsx)("option",{value:"SEVERA",children:"Severa"})]})]})]}),"BAJA"===J&&"ENFERMEDAD"===W&&(0,a.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Sistema afectado"}),(0,a.jsxs)("select",{className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:es,onChange:e=>en(e.target.value),disabled:eY,children:[(0,a.jsx)("option",{value:"",children:"—"}),(0,a.jsx)("option",{value:"RESPIRATORIO",children:"Respiratorio"}),(0,a.jsx)("option",{value:"GASTROINTESTINAL",children:"Gastrointestinal"}),(0,a.jsx)("option",{value:"OTORRINO",children:"Otorrino"}),(0,a.jsx)("option",{value:"DERMATOLOGICO",children:"Dermatol\xf3gico"}),(0,a.jsx)("option",{value:"GENERAL",children:"General"}),(0,a.jsx)("option",{value:"OTRO",children:"Otro"})]})]}),(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"S\xedntomas / Dx breve"}),(0,a.jsx)("input",{className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:er,onChange:e=>ei(e.target.value),placeholder:"Ej: fiebre, tos, malestar...",disabled:eY})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"\xbfContagioso?"}),(0,a.jsx)("input",{type:"checkbox",checked:ed,onChange:e=>eo(e.target.checked),disabled:eY}),ed&&(0,a.jsx)("input",{type:"number",min:0,className:"h-10 w-36 rounded-md border px-3 text-sm",placeholder:"D\xedas aislamiento",value:ec,onChange:e=>eu(""===e.target.value?"":Number(e.target.value)),disabled:eY})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Apto para"}),(0,a.jsxs)("select",{className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:em,onChange:e=>ex(e.target.value),disabled:eY,children:[(0,a.jsx)("option",{value:"",children:"—"}),(0,a.jsx)("option",{value:"SOLO_GIMNASIO",children:"Solo gimnasio"}),(0,a.jsx)("option",{value:"AEROBICO_SUAVE",children:"Aer\xf3bico suave"}),(0,a.jsx)("option",{value:"CHARLAS_TACTICO",children:"Charlas–t\xe1ctico"}),(0,a.jsx)("option",{value:"NINGUNO",children:"Ninguno"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Fiebre m\xe1xima (\xb0C)"}),(0,a.jsx)("input",{type:"number",step:"0.1",className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:eh,onChange:e=>ep(""===e.target.value?"":Number(e.target.value)),disabled:eY})]})]}),(0,a.jsxs)("div",{className:"grid gap-3 sm:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Fecha de inicio"}),(0,a.jsx)("input",{type:"date",className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:ev,onChange:e=>eb(e.target.value),disabled:eY})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"D\xedas estimados"}),(0,a.jsx)("input",{type:"number",min:0,className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",placeholder:"p.ej. 7",value:ej,onChange:e=>eN(""===e.target.value?"":Math.max(0,Number(e.target.value))),disabled:eY}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Se usa para calcular el ETR. (min/max ya no se guardan)."})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"ETR (fecha de retorno)"}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)("input",{type:"checkbox",checked:eE,onChange:e=>ey(e.target.checked),disabled:eY}),"Editar manual"]})]}),(0,a.jsx)("input",{type:"date",className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:ef||"",onChange:e=>eS(e.target.value),disabled:!eE||eY})]})]}),e0&&(0,a.jsxs)("div",{className:"grid gap-3 sm:grid-cols-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Tope de minutos"}),(0,a.jsx)("input",{type:"number",min:0,className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:eC,onChange:e=>eA(""===e.target.value?"":Math.max(0,Number(e.target.value))),disabled:eY})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:eR,onChange:e=>ew(e.target.checked),disabled:eY}),(0,a.jsx)("span",{className:"text-sm",children:"Sin sprint"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:eD,onChange:e=>eO(e.target.checked),disabled:eY}),(0,a.jsx)("span",{className:"text-sm",children:"Sin cambios de direcci\xf3n"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:eI,onChange:e=>eT(e.target.checked),disabled:eY}),(0,a.jsx)("span",{className:"text-sm",children:"Solo gimnasio"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:ek,onChange:e=>eM(e.target.checked),disabled:eY}),(0,a.jsx)("span",{className:"text-sm",children:"Sin contacto"})]})]}),(0,a.jsxs)("div",{className:"grid gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Informe m\xe9dico"}),(0,a.jsx)("textarea",{className:"mt-1 w-full rounded-md border p-3 text-sm",rows:4,value:eL,onChange:e=>eP(e.target.value),placeholder:"Evoluci\xf3n, tratamientos, observaciones…",disabled:eY})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Firma m\xe9dica (iniciales)"}),(0,a.jsx)("input",{className:"mt-1 h-10 w-full rounded-md border px-3 text-sm",value:eF,onChange:e=>eG(e.target.value),placeholder:"Ej: Dr. XX",disabled:eY})]})]}),(0,a.jsxs)("div",{className:"grid gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Plan / Protocolo semanal"}),(0,a.jsx)(r.Z,{text:"Texto estructurado: Objetivos, Tareas clave, Controles d3/d7 y Criterios de progresi\xf3n. Solo editable por M\xe9dico."})]}),(0,a.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Objetivos"}),(0,a.jsx)("textarea",{className:"mt-1 w-full rounded-md border p-2 text-sm",rows:3,value:eB,onChange:e=>eJ(e.target.value),disabled:eY})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Tareas clave"}),(0,a.jsx)("textarea",{className:"mt-1 w-full rounded-md border p-2 text-sm",rows:3,value:eZ,onChange:e=>e_(e.target.value),disabled:eY})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Controles (d3/d7)"}),(0,a.jsx)("textarea",{className:"mt-1 w-full rounded-md border p-2 text-sm",rows:3,value:eH,onChange:e=>eV(e.target.value),disabled:eY})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Criterios de progresi\xf3n"}),(0,a.jsx)("textarea",{className:"mt-1 w-full rounded-md border p-2 text-sm",rows:3,value:eU,onChange:e=>eW(e.target.value),disabled:eY})]})]})]}),eK&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:eK}),eX&&(0,a.jsx)("div",{className:"rounded-md p-3 text-sm ".concat("ok"===eX.kind?"bg-emerald-50 text-emerald-700":"bg-red-50 text-red-700"),children:eX.text}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-2",children:[(0,a.jsx)("button",{type:"button",onClick:L,className:"h-10 rounded-md border px-4 text-sm hover:bg-gray-50",disabled:eY,children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",disabled:eY,className:"h-10 rounded-md bg-black px-4 text-sm text-white disabled:opacity-50",children:eY?"Guardando…":"Guardar"})]})]})}},5960:function(e,t,l){l.d(t,{Z:function(){return n},y:function(){return s}});var a=l(2265);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(l,"-").concat(a)}function n(e){let[t,l]=a.useState(e||s()),[n,r]=a.useState([]),[i,d]=a.useState(!1),[o,c]=a.useState(null),u=a.useCallback(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t;d(!0),c(null);try{let t=new URLSearchParams;e&&t.set("date",e);let l=await fetch("/api/medico/clinical?".concat(t.toString()),{cache:"no-store"});if(!l.ok)throw Error("HTTP ".concat(l.status));let a=await l.json();r(Array.isArray(a)?a:[]),a&&0!==a.length||c("EMPTY")}catch(e){r([]),c("ERR")}finally{d(!1)}},[t]);async function m(e){let l={...e};l.date||(l.date=t);let a=await fetch("/api/medico/clinical",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(l)});if(!a.ok){let e=await a.text().catch(()=>"");throw Error("Error guardando episodio (".concat(a.status,") ").concat(e))}return await u(l.date),a.json()}return a.useEffect(()=>{u(t)},[t,u]),{date:t,setDate:l,items:n,loading:i,error:o,reload:u,saveEpisode:m}}}}]);