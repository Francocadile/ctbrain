(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8586],{4285:function(e,a,s){Promise.resolve().then(s.bind(s,2963))},6463:function(e,a,s){"use strict";var t=s(1169);s.o(t,"useParams")&&s.d(a,{useParams:function(){return t.useParams}}),s.o(t,"usePathname")&&s.d(a,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(a,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(a,{useSearchParams:function(){return t.useSearchParams}})},2963:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return o}});var t=s(7437),r=s(2265),n=s(6463),l=s(998);function o(){var e,a,s;let r=(0,n.useRouter)(),{data:o,status:d}=(0,l.useSession)({required:!0,onUnauthenticated(){r.replace("/login")}}),u=null!==(s=null==o?void 0:null===(e=o.user)||void 0===e?void 0:e.id)&&void 0!==s?s:"",c=(null==o?void 0:null===(a=o.user)||void 0===a?void 0:a.role)==="JUGADOR"&&!!u;return"loading"===d?(0,t.jsx)("div",{className:"p-6 text-sm text-gray-500",children:"Cargando…"}):c?(0,t.jsxs)("div",{className:"mx-auto flex max-w-2xl flex-col gap-6",children:[(0,t.jsxs)("header",{className:"space-y-1",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Enviar feedback al CT"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Tu mensaje ser\xe1 visible para el cuerpo t\xe9cnico y el staff m\xe9dico del equipo. Usalo para compartir sensaciones, molestias o sugerencias."})]}),(0,t.jsx)(i,{playerId:u,onSubmitted:()=>r.refresh()})]}):(0,t.jsx)("div",{className:"mx-auto max-w-xl rounded-lg border bg-white p-6 text-sm text-gray-600",children:"No ten\xe9s acceso a este m\xf3dulo."})}function i(e){let{playerId:a,onSubmitted:s}=e,[n,l]=(0,r.useState)(""),[o,i]=(0,r.useState)(""),[d,u]=(0,r.useState)(""),[c,m]=(0,r.useState)("idle"),[x,h]=(0,r.useState)(null),p=(0,r.useMemo)(()=>2e3-o.length,[o]);async function b(e){if(e.preventDefault(),a){if(!o.trim()){h("Escrib\xed un mensaje");return}m("loading"),h(null);try{let e=await fetch("/api/feedback",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({playerId:a,subject:n.trim()||void 0,text:o.trim(),rating:d?Number(d):void 0})});if(!e.ok){let a=await e.json().catch(()=>({}));throw Error((null==a?void 0:a.error)||"No se pudo enviar el feedback")}l(""),i(""),u(""),m("success"),s()}catch(e){console.error("[feedback] submit failed",e),m("error"),h((null==e?void 0:e.message)||"No se pudo enviar el feedback")}}}return(0,t.jsxs)("form",{onSubmit:b,className:"space-y-4 rounded-lg border bg-white p-6 shadow-sm",children:[(0,t.jsxs)("div",{className:"grid gap-1",children:[(0,t.jsx)("label",{htmlFor:"subject",className:"text-sm font-medium text-gray-700",children:"Tema (opcional)"}),(0,t.jsx)("input",{id:"subject",type:"text",maxLength:120,value:n,onChange:e=>l(e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-gray-500 focus:outline-none",placeholder:"Ej. Molestias post entrenamiento"})]}),(0,t.jsxs)("div",{className:"grid gap-1",children:[(0,t.jsx)("label",{htmlFor:"text",className:"text-sm font-medium text-gray-700",children:"Mensaje"}),(0,t.jsx)("textarea",{id:"text",required:!0,maxLength:2e3,value:o,onChange:e=>i(e.target.value),rows:8,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm leading-5 focus:border-gray-500 focus:outline-none",placeholder:"Contanos c\xf3mo te sent\xeds, si hay molestias o comentarios que quieras compartir."}),(0,t.jsxs)("div",{className:"text-end text-xs text-gray-500",children:[p," caracteres disponibles"]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Estado general (1-5, opcional)"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[["1","2","3","4","5"].map(e=>(0,t.jsxs)("label",{className:"flex cursor-pointer items-center gap-1 text-sm text-gray-700",children:[(0,t.jsx)("input",{type:"radio",name:"rating",value:e,checked:d===e,onChange:()=>u(e)}),e]},e)),(0,t.jsx)("button",{type:"button",onClick:()=>u(""),className:"text-xs text-blue-600 hover:underline",children:"Limpiar"})]})]}),x?(0,t.jsx)("p",{className:"text-sm text-red-600",children:x}):null,"success"===c?(0,t.jsx)("p",{className:"text-sm text-green-600",children:"\xa1Gracias! El mensaje fue enviado."}):null,(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{type:"submit",disabled:"loading"===c,className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-blue-500 disabled:cursor-not-allowed disabled:bg-blue-300",children:"loading"===c?"Enviando…":"Enviar feedback"}),(0,t.jsx)("button",{type:"button",disabled:"loading"===c||!n&&!o&&!d,onClick:()=>{l(""),i(""),u(""),h(null),m("idle")},className:"rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-700 transition hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-60",children:"Limpiar formulario"})]})]})}}},function(e){e.O(0,[998,2971,7023,1744],function(){return e(e.s=4285)}),_N_E=e.O()}]);