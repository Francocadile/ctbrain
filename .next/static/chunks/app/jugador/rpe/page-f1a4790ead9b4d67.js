(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9211],{5912:function(e,l,a){Promise.resolve().then(a.bind(a,2395))},2395:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return i}});var t=a(7437),n=a(2265),r=a(430);let s=[{value:0,label:"REPOSO",tone:"bg-sky-300"},{value:1,label:"MUY MUY SUAVE",tone:"bg-sky-300"},{value:2,label:"MUY SUAVE",tone:"bg-sky-300"},{value:3,label:"SUAVE",tone:"bg-lime-200"},{value:4,label:"ALGO DURO",tone:"bg-lime-300"},{value:5,label:"DURO",tone:"bg-yellow-200"},{value:6,label:"M\xc1S DURO",tone:"bg-yellow-300"},{value:7,label:"MUY DURO",tone:"bg-orange-300"},{value:8,label:"MUY MUY DURO",tone:"bg-orange-400"},{value:9,label:"M\xc1XIMO",tone:"bg-red-500"},{value:10,label:"EXTREMADAMENTE M\xc1XIMO",tone:"bg-red-600"}];function i(){let[e,l]=(0,n.useState)(new Date().toISOString().slice(0,10)),[a,i]=(0,n.useState)(""),[o,c]=(0,n.useState)(""),[u,d]=(0,n.useState)(!0),[b,m]=(0,n.useState)(null),[x,v]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!1);async function p(){if(u){alert("Cargando identidad…");return}if(!a){alert("userId y date requeridos");return}if(null==b){alert("Eleg\xed un valor de la escala (0–10)");return}let l={date:e,userId:a,playerKey:o,rpe:Number(b)},t=await fetch("/api/metrics/rpe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l),cache:"no-store"});if(!t.ok){alert(await t.text()||"Error");return}f(!0),alert("\xa1RPE enviado!")}return(0,n.useEffect)(()=>{let e=!0;return(async()=>{try{var l;let a=await (0,r.jO)();if(!e)return;i((null==a?void 0:a.id)||""),c(null===(l=(null==a?void 0:a.name)||(null==a?void 0:a.email)||"")||void 0===l?void 0:l.trim())}finally{e&&d(!1)}})(),()=>{e=!1}},[]),(0,n.useEffect)(()=>{(async function(){if(!a&&!o){v(!0);return}let l=a?"userId=".concat(encodeURIComponent(a)):"playerKey=".concat(encodeURIComponent(o)),t="/api/metrics/rpe?date=".concat(e,"&").concat(l),n=await fetch(t,{cache:"no-store"}),r=n.ok?await n.json():[];if(Array.isArray(r)&&r.length){var s;m(Number(null!==(s=r[0].rpe)&&void 0!==s?s:0)),f(!0)}else m(null),f(!1);v(!0)})()},[e,a,o]),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("button",{onClick:()=>history.back(),className:"text-sm",children:"← Volver"}),(0,t.jsx)("button",{onClick:function(){(0,r.AL)(),window.location.href="/api/auth/signout?callbackUrl=/jugador"},className:"text-sm underline",children:"Salir"})]}),(0,t.jsx)("h1",{className:"text-xl font-bold",children:"RPE — Escala de Borg"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Seleccion\xe1 un n\xfamero del ",(0,t.jsx)("b",{children:"0"})," al ",(0,t.jsx)("b",{children:"10"})," que represente tu sensaci\xf3n subjetiva del trabajo realizado."]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-[12px] text-gray-500",children:"Fecha"}),(0,t.jsx)("input",{type:"date",className:"w-full rounded-md border px-2 py-1.5",value:e,onChange:e=>l(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-[12px] text-gray-500",children:"Tu nombre"}),(0,t.jsx)("input",{className:"w-full rounded-md border px-2 py-1.5",value:u?"Cargando…":o||"—",disabled:!0})]})]}),(0,t.jsxs)("div",{className:"rounded-2xl border bg-white p-3",children:[(0,t.jsx)("div",{className:"space-y-2",children:s.map(e=>{let l=b===e.value;return(0,t.jsx)("button",{className:"w-full text-left rounded-md border px-3 py-2 font-semibold tracking-wide\n                  ".concat(e.tone," ").concat(l?"ring-2 ring-black/50":""),onClick:()=>m(e.value),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-lg",children:e.value}),(0,t.jsx)("span",{className:"uppercase",children:e.label})]})},e.value)})}),x&&h&&(0,t.jsxs)("div",{className:"mt-3 text-xs text-emerald-700 bg-emerald-50 border border-emerald-200 rounded-md px-2 py-1",children:["Ya enviaste tu RPE hoy. Pod\xe9s corregirlo y volver a ",(0,t.jsx)("b",{children:"Guardar"}),"."]}),(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)("button",{onClick:p,disabled:u||!a||null==b,className:"px-3 py-1.5 rounded-xl text-sm\n              ".concat(u||!a||null==b?"bg-gray-200 text-gray-500":"bg-black text-white hover:opacity-90"),children:h?"Guardar cambios":"Enviar RPE"})})]})]})}},430:function(e,l,a){"use strict";function t(){window.localStorage.removeItem("playerName")}async function n(){try{var e,l;let a=await fetch("/api/auth/session",{cache:"no-store"});if(!a.ok)return null;let t=await a.json(),n=null==t?void 0:t.user;if(!n)return null;let r=n.id||(null==t?void 0:t.sub)||"";if(!r)return null;return{id:r,name:null!==(e=n.name)&&void 0!==e?e:null,email:null!==(l=n.email)&&void 0!==l?l:null}}catch(e){return null}}a.d(l,{AL:function(){return t},jO:function(){return n}})}},function(e){e.O(0,[2971,7023,1744],function(){return e(e.s=5912)}),_N_E=e.O()}]);