(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3746],{6855:function(e,t,a){Promise.resolve().then(a.bind(a,3951))},3951:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var l=a(7437),s=a(2265),r=a(430);let n=[{value:1,emoji:"\uD83D\uDE1E",label:"Muy mal",tone:"bg-red-50  border-red-200  text-red-700"},{value:2,emoji:"\uD83D\uDE41",label:"Mal",tone:"bg-orange-50 border-orange-200 text-orange-700"},{value:3,emoji:"\uD83D\uDE10",label:"Normal",tone:"bg-gray-50 border-gray-200 text-gray-700"},{value:4,emoji:"\uD83D\uDE42",label:"Bien",tone:"bg-lime-50 border-lime-200 text-lime-700"},{value:5,emoji:"\uD83D\uDE04",label:"Excelente",tone:"bg-emerald-50 border-emerald-200 text-emerald-700"}];function i(e){let{value:t,onChange:a}=e;return(0,l.jsx)("div",{className:"flex gap-2",children:n.map(e=>{let s=t===e.value;return(0,l.jsxs)("button",{type:"button",className:"flex-1 rounded-lg border px-2 py-2 text-sm text-center\n              ".concat(s?e.tone+" ring-2 ring-black/30":"bg-white"),onClick:()=>a(e.value),title:"".concat(e.value," — ").concat(e.label),children:[(0,l.jsx)("div",{className:"text-xl",children:e.emoji}),(0,l.jsxs)("div",{className:"mt-1 text-xs font-medium",children:[e.value," \xb7 ",e.label]})]},e.value)})})}function d(){let[e,t]=(0,s.useState)(new Date().toISOString().slice(0,10)),[a,n]=(0,s.useState)(""),[d,o]=(0,s.useState)(""),[u,c]=(0,s.useState)(!0),[m,x]=(0,s.useState)(""),[v,b]=(0,s.useState)(""),[h,g]=(0,s.useState)(""),[j,p]=(0,s.useState)(""),[y,N]=(0,s.useState)(""),[f,w]=(0,s.useState)(""),[S,C]=(0,s.useState)(""),[D,E]=(0,s.useState)(!1),[k,O]=(0,s.useState)(!1);async function I(){if(u){alert("Cargando identidad…");return}if(!a){alert("userId y date requeridos");return}let t={date:e,userId:a,playerKey:d||null,sleepQuality:Number(m||0),sleepHours:v?Number(v):null,fatigue:Number(h||0),soreness:Number(j||0),stress:Number(y||0),mood:Number(f||0),comment:S.trim()||null},l=await fetch("/api/metrics/wellness",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),cache:"no-store"});if(!l.ok){alert(await l.text()||"Error");return}O(!0),alert("\xa1Wellness enviado!")}(0,s.useEffect)(()=>{(async()=>{try{var e;let t=await (0,r.jO)();n((null==t?void 0:t.id)||""),o(null===(e=(null==t?void 0:t.name)||(null==t?void 0:t.email)||"")||void 0===e?void 0:e.trim())}finally{c(!1)}})()},[]),(0,s.useEffect)(()=>{(async function(){if(!a&&!d){E(!0);return}let t=a?"userId=".concat(encodeURIComponent(a)):"playerKey=".concat(encodeURIComponent(d)),l="/api/metrics/wellness?date=".concat(e,"&").concat(t),s=await fetch(l,{cache:"no-store"}),r=s.ok?await s.json():[];if(Array.isArray(r)&&r.length){var n,i,o,u,c,m,v,h;let e=r[0];x(null!==(n=e.sleepQuality)&&void 0!==n?n:""),b(null!=e.sleepHours?String(e.sleepHours):""),g(null!==(i=e.fatigue)&&void 0!==i?i:""),p(null!==(u=null!==(o=e.muscleSoreness)&&void 0!==o?o:e.soreness)&&void 0!==u?u:""),N(null!==(c=e.stress)&&void 0!==c?c:""),w(null!==(m=e.mood)&&void 0!==m?m:""),C(null!==(h=null!==(v=e.comment)&&void 0!==v?v:e.notes)&&void 0!==h?h:""),O(!0)}else x(""),b(""),g(""),p(""),N(""),w(""),C(""),O(!1);E(!0)})()},[e,a,d]);let _=Number(m||0)+Number(h||0)+Number(j||0)+Number(y||0)+Number(f||0)||0,H=u||!a||""===m||""===h||""===j||""===y||""===f;return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("button",{onClick:()=>history.back(),className:"text-sm",children:"← Volver"}),(0,l.jsx)("a",{href:"/api/auth/signout?callbackUrl=/jugador",className:"text-sm underline",children:"Salir"})]}),(0,l.jsx)("h1",{className:"text-xl font-bold",children:"Wellness diario"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Eleg\xed una carita (1–5) para cada \xedtem. 5 = mejor."}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-[12px] text-gray-500",children:"Fecha"}),(0,l.jsx)("input",{type:"date",className:"w-full rounded-md border px-2 py-1.5",value:e,onChange:e=>t(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-[12px] text-gray-500",children:"Tu nombre (login)"}),(0,l.jsx)("input",{className:"w-full rounded-md border px-2 py-1.5",value:d,disabled:!0})]})]}),(0,l.jsxs)("div",{className:"rounded-2xl border bg-white p-4 space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-[12px] text-gray-500 mb-1",children:"Calidad de sue\xf1o"}),(0,l.jsx)(i,{value:m,onChange:e=>x(e)})]}),(0,l.jsx)("div",{className:"grid md:grid-cols-2 gap-3 items-end",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-[12px] text-gray-500 mb-1",children:"Horas de sue\xf1o"}),(0,l.jsx)("input",{className:"w-full rounded-md border px-2 py-1.5",placeholder:"Ej: 7.5",value:v,onChange:e=>b(e.target.value)})]})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-[12px] text-gray-500 mb-1",children:"Fatiga"}),(0,l.jsx)(i,{value:h,onChange:e=>g(e)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-[12px] text-gray-500 mb-1",children:"Dolor muscular"}),(0,l.jsx)(i,{value:j,onChange:e=>p(e)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-[12px] text-gray-500 mb-1",children:"Estr\xe9s"}),(0,l.jsx)(i,{value:y,onChange:e=>N(e)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-[12px] text-gray-500 mb-1",children:"\xc1nimo"}),(0,l.jsx)(i,{value:f,onChange:e=>w(e)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-[12px] text-gray-500 mb-1",children:"Comentario (opcional)"}),(0,l.jsx)("textarea",{className:"w-full rounded-md border px-2 py-1.5",rows:3,value:S,onChange:e=>C(e.target.value)})]}),(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["Puntaje parcial (sin horas): ",(0,l.jsx)("b",{children:_||"—"})]}),D&&k&&(0,l.jsxs)("div",{className:"text-xs text-emerald-700 bg-emerald-50 border border-emerald-200 rounded-md px-2 py-1",children:["Ya enviaste tu Wellness hoy. Pod\xe9s editar y volver a ",(0,l.jsx)("b",{children:"Guardar"}),"."]}),(0,l.jsx)("button",{onClick:I,disabled:H,className:"px-3 py-1.5 rounded-xl text-sm ".concat(H?"bg-gray-200 text-gray-500":"bg-black text-white hover:opacity-90"),children:k?"Guardar cambios":"Enviar Wellness"}),!d&&(0,l.jsx)("div",{className:"text-xs text-red-600 mt-2",children:"No pudimos leer tu nombre/email de la sesi\xf3n. Cerr\xe1 sesi\xf3n y volv\xe9 a iniciar."})]})]})}},430:function(e,t,a){"use strict";function l(){window.localStorage.removeItem("playerName")}async function s(){try{var e,t;let a=await fetch("/api/auth/session",{cache:"no-store"});if(!a.ok)return null;let l=await a.json(),s=null==l?void 0:l.user;if(!s)return null;let r=s.id||(null==l?void 0:l.sub)||"";if(!r)return null;return{id:r,name:null!==(e=s.name)&&void 0!==e?e:null,email:null!==(t=s.email)&&void 0!==t?t:null}}catch(e){return null}}a.d(t,{AL:function(){return l},jO:function(){return s}})}},function(e){e.O(0,[2971,7023,1744],function(){return e(e.s=6855)}),_N_E=e.O()}]);