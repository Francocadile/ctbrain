(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9938],{4419:function(e,t,n){Promise.resolve().then(n.bind(n,6781))},6463:function(e,t,n){"use strict";var a=n(1169);n.o(a,"useParams")&&n.d(t,{useParams:function(){return a.useParams}}),n.o(a,"usePathname")&&n.d(t,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}}),n.o(a,"useSearchParams")&&n.d(t,{useSearchParams:function(){return a.useSearchParams}})},6781:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b},dynamic:function(){return f}});var a=n(7437),s=n(2265),r=n(6463),i=n(97),l=n(5960);let o={BAJA:"Baja",REINTEGRO:"Reintegro",LIMITADA:"Limitada",ALTA:"Alta"},c={BAJA:"Fuera de toda actividad (OUT).",REINTEGRO:"RTP: retorno progresivo con restricciones.",LIMITADA:"LIM: entrena con limitaciones.",ALTA:"Alta m\xe9dica: sin restricciones (FULL)."};function d(e){let{status:t,className:n="",size:s="sm"}=e;return(0,a.jsxs)("span",{className:"".concat("inline-flex items-center rounded-full font-medium select-none whitespace-nowrap"," ").concat("sm"===s?"px-2 py-0.5 text-xs":"px-3 py-1 text-sm"," ").concat("ALTA"===t?"bg-green-100 text-green-800 ring-1 ring-green-200":"BAJA"===t?"bg-red-100 text-red-800 ring-1 ring-red-200":"bg-yellow-100 text-yellow-800 ring-1 ring-yellow-200"," ").concat(n),title:c[t],children:[(0,a.jsx)("span",{className:"mr-1 inline-block h-2 w-2 rounded-full ".concat("ALTA"===t?"bg-green-500":"BAJA"===t?"bg-red-500":"bg-yellow-500")}),o[t],"REINTEGRO"===t?(0,a.jsx)("span",{className:"ml-1 opacity-70",children:"(RTP)"}):null,"LIMITADA"===t?(0,a.jsx)("span",{className:"ml-1 opacity-70",children:"(LIM)"}):null]})}function u(e){let{children:t,className:n="",size:s="sm"}=e;return(0,a.jsx)("span",{className:"".concat("inline-flex items-center rounded-full bg-slate-100 text-slate-800 ring-1 ring-slate-200"," ").concat("sm"===s?"px-2 py-0.5 text-xs":"px-3 py-1 text-sm"," ").concat(n),children:t})}function m(e){let{noSprint:t,noChangeOfDirection:n,noContact:s,gymOnly:r,capMinutes:i,className:l="",size:o="sm"}=e,c=[];return(t&&c.push((0,a.jsx)(u,{size:o,children:"Sin sprint"},"ns")),n&&c.push((0,a.jsx)(u,{size:o,children:"Sin cambios de direcci\xf3n"},"ncd")),s&&c.push((0,a.jsx)(u,{size:o,children:"Sin contacto"},"nc")),r&&c.push((0,a.jsx)(u,{size:o,children:"Solo gimnasio"},"gym")),"number"==typeof i&&i>=0&&c.push((0,a.jsxs)(u,{size:o,children:["Tope: ",i,"′"]},"cap")),0===c.length)?(0,a.jsx)("span",{className:"text-xs text-slate-400 ".concat(l),children:"Sin restricciones"}):(0,a.jsx)("div",{className:"flex flex-wrap gap-2 ".concat(l),children:c.map(e=>e)})}var x=n(1940);let p={BAJA:0,REINTEGRO:1,LIMITADA:2,ALTA:3};function h(e){if(!e)return null;let[t,n,a]=e.split("-").map(Number),s=new Date(t,(n||1)-1,a||1);return s.setHours(0,0,0,0),isNaN(s.getTime())?null:s}function g(e){var t;let{onNew:n,onEdit:r,initialDate:i,className:o=""}=e,{date:c,setDate:u,items:g,loading:f,error:b,reload:j}=(0,l.Z)(i||(0,l.y)());s.useEffect(()=>{let e=new URL(window.location.href);e.searchParams.set("date",c),window.history.replaceState({},"",e.toString())},[c]);let[y,N]=s.useState(""),v=s.useMemo(()=>{let e={BAJA:0,REINTEGRO:0,LIMITADA:0,ALTA:0};for(let t of g)t.status in e&&(e[t.status]+=1);return e},[g]),w=s.useMemo(()=>{let e=y.trim().toLowerCase(),t=e?g.filter(t=>[t.userName,t.diagnosis,t.bodyPart,t.notes,t.protocolObjectives,t.protocolTasks].filter(Boolean).join(" ").toLowerCase().includes(e)):g.slice();return t.sort((e,t)=>{var n,a;let s=null!==(n=p[e.status])&&void 0!==n?n:99,r=null!==(a=p[t.status])&&void 0!==a?a:99;if(s!==r)return s-r;let i=h(e.expectedReturn),l=h(t.expectedReturn);if(i&&l){let e=i.getTime()-l.getTime();if(0!==e)return e}else if(i&&!l)return -1;else if(!i&&l)return 1;return(e.userName||"").localeCompare(t.userName||"")}),t},[g,y]),A=!f&&0===w.length;return(0,a.jsxs)("section",{className:"rounded-xl border bg-white p-5 shadow-sm ".concat(o),children:[(0,a.jsxs)("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-end gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Fecha"}),(0,a.jsx)("input",{type:"date",className:"mt-1 h-10 rounded-md border px-3 text-sm",value:c,onChange:e=>u(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Buscar"}),(0,a.jsx)("input",{className:"mt-1 h-10 rounded-md border px-3 text-sm",placeholder:"Jugador, diagn\xf3stico, zona…",value:y,onChange:e=>N(e.target.value)})]}),(0,a.jsx)("button",{type:"button",className:"h-10 rounded-md border px-3 text-sm",onClick:()=>j(c),disabled:f,children:f?"Actualizando…":"Actualizar"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",className:"h-10 rounded-md border px-3 text-sm",onClick:function(){let e=w.map(e=>{var t;let n=e.leaveKind||"",a="LESION"===e.leaveKind?e.diagnosis||"":"ENFERMEDAD"===e.leaveKind&&(e.illSymptoms||e.diagnosis)||"",s=[e.noSprint?"Sin sprint":"",e.noChangeOfDirection?"Sin COD":"",e.noContact?"Sin contacto":"",e.gymOnly?"Gimnasio":"","number"==typeof e.capMinutes?"Tope ".concat(e.capMinutes,"′"):""].filter(Boolean).join(" | ");return{Fecha:e.date||"",Jugador:e.userName||"",Estado:e.status||"",Tipo:n,"Diagn\xf3stico/S\xedntomas":a,Zona:e.bodyPart||"",Lateralidad:e.laterality||"",Mecanismo:e.mechanism||"",Gravedad:e.severity||"",ETR:e.expectedReturn||"",Restricciones:s,TopeMin:null!==(t=e.capMinutes)&&void 0!==t?t:"",Firma:e.medSignature||""}}),t=new Blob([(0,x.C)(e,["Fecha","Jugador","Estado","Tipo","Diagn\xf3stico/S\xedntomas","Zona","Lateralidad","Mecanismo","Gravedad","ETR","Restricciones","TopeMin","Firma"])],{type:"text/csv;charset=utf-8"}),n=URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download="episodios_".concat(c,".csv"),a.click(),URL.revokeObjectURL(n)},disabled:f||(null!==(t=null==w?void 0:w.length)&&void 0!==t?t:0)===0,children:"Exportar CSV"}),(0,a.jsx)("button",{type:"button",className:"h-10 rounded-md bg-black px-4 text-sm text-white disabled:opacity-50",onClick:()=>null==n?void 0:n(c),disabled:f,children:"Nuevo episodio"})]})]}),(0,a.jsxs)("div",{className:"mb-3 flex flex-wrap gap-2 text-xs",children:[(0,a.jsxs)("span",{className:"rounded-full bg-red-50 text-red-700 ring-1 ring-red-200 px-2 py-1",title:"Fuera de actividad (OUT).",children:["BAJA: ",v.BAJA]}),(0,a.jsxs)("span",{className:"rounded-full bg-amber-50 text-amber-700 ring-1 ring-amber-200 px-2 py-1",title:"RTP: retorno progresivo con restricciones.",children:["REINTEGRO: ",v.REINTEGRO]}),(0,a.jsxs)("span",{className:"rounded-full bg-amber-50 text-amber-700 ring-1 ring-amber-200 px-2 py-1",title:"LIM: entrena con limitaciones.",children:["LIMITADA: ",v.LIMITADA]}),(0,a.jsxs)("span",{className:"rounded-full bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200 px-2 py-1",title:"Alta m\xe9dica del d\xeda (FULL).",children:["ALTA: ",v.ALTA]})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-[900px] w-full border-separate border-spacing-y-2",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"text-left text-xs text-slate-500",children:[(0,a.jsx)("th",{className:"px-3 py-2",children:"Jugador"}),(0,a.jsx)("th",{className:"px-3 py-2",children:"Estado"}),(0,a.jsx)("th",{className:"px-3 py-2",children:"Dx / S\xedntomas"}),(0,a.jsx)("th",{className:"px-3 py-2",children:"Zona"}),(0,a.jsx)("th",{className:"px-3 py-2",children:"ETR"}),(0,a.jsx)("th",{className:"px-3 py-2",children:"Restricciones"}),(0,a.jsx)("th",{className:"px-3 py-2",children:"Firma"}),(0,a.jsx)("th",{className:"px-3 py-2 text-right",children:"Acciones"})]})}),(0,a.jsxs)("tbody",{children:[f&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"px-3 py-3 text-sm text-slate-500",colSpan:8,children:"Cargando…"})}),A&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"px-3 py-3 text-sm text-slate-500",colSpan:8,children:"ERR"===b?(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"No se pudo cargar."}),(0,a.jsx)("button",{className:"rounded-md border px-3 py-1 text-sm",onClick:()=>j(c),children:"Reintentar"})]}):y?(0,a.jsxs)(a.Fragment,{children:["Sin resultados para “",y,"”."]}):(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"No hay activos ni altas del d\xeda."}),(0,a.jsx)("button",{className:"rounded-md border px-3 py-1 text-sm",onClick:()=>null==n?void 0:n(c),children:"Nuevo episodio"})]})})}),!f&&w.map(e=>{var t;let n="LESION"===e.leaveKind?e.diagnosis||"—":"ENFERMEDAD"===e.leaveKind&&(e.illSymptoms||e.diagnosis)||"—";return(0,a.jsxs)("tr",{className:"bg-white",children:[(0,a.jsxs)("td",{className:"px-3 py-2 align-top",children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:e.userName}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:e.date})]}),(0,a.jsxs)("td",{className:"px-3 py-2 align-top",children:[(0,a.jsx)(d,{status:e.status}),e.leaveStage&&(0,a.jsx)("div",{className:"mt-1 text-[11px] text-slate-500",children:e.leaveStage.toLowerCase()})]}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:(0,a.jsx)("div",{className:"text-sm",children:n})}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:(0,a.jsx)("div",{className:"text-sm",children:e.bodyPart||"—"})}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:(0,a.jsx)("div",{className:"text-sm",children:e.expectedReturn||"—"})}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:(0,a.jsx)(m,{noSprint:e.noSprint,noChangeOfDirection:e.noChangeOfDirection,noContact:e.noContact,gymOnly:e.gymOnly,capMinutes:null!==(t=e.capMinutes)&&void 0!==t?t:null})}),(0,a.jsx)("td",{className:"px-3 py-2 align-top text-sm",children:e.medSignature||"—"}),(0,a.jsx)("td",{className:"px-3 py-2 align-top text-right",children:(0,a.jsx)("button",{type:"button",className:"rounded-md border px-3 py-1 text-sm hover:bg-gray-50",onClick:()=>null==r?void 0:r(e),children:"Editar"})})]},e.id)})]})]})})]})}let f="force-dynamic";function b(){let e=(0,r.useRouter)();return(0,a.jsxs)("main",{className:"min-h-[70vh] px-6 py-10",children:[(0,a.jsxs)("header",{className:"mb-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Parte cl\xednico — M\xe9dico"}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-600",children:["Vos edit\xe1s; el CT lo ve en lectura con sem\xe1foro y ETR."," ",(0,a.jsx)(i.Z,{text:"Incluye lesi\xf3n/enfermedad, cronolog\xeda con ETR autom\xe1tico (editable), restricciones y plan semanal."})]}),(0,a.jsxs)("p",{className:"mt-2 text-xs text-gray-500",children:["Atajo:"," ",(0,a.jsx)("a",{href:"/api/med/users/players",className:"underline",target:"_blank",rel:"noreferrer",children:"ver jugadores (JSON)"})]})]}),(0,a.jsx)("section",{className:"rounded-xl border bg-white p-5 shadow-sm",children:(0,a.jsx)(g,{onNew:t=>{let n=t?"?date=".concat(encodeURIComponent(t)):"";e.push("/med/injuries/new".concat(n))},onEdit:t=>e.push("/med/injuries/".concat(t.id))})})]})}},97:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(7437),s=n(2265);function r(e){let{text:t,side:n="top",className:r="",sizePx:i=16}=e,l=s.useId(),o=(()=>{switch(n){case"bottom":return"left-1/2 -translate-x-1/2 top-full mt-1";case"left":return"right-full mr-2 top-1/2 -translate-y-1/2";case"right":return"left-full ml-2 top-1/2 -translate-y-1/2";default:return"left-1/2 -translate-x-1/2 bottom-full mb-1"}})(),c="absolute w-0 h-0 border-transparent",d=Math.max(12,Math.min(22,i)),u=(()=>{switch(n){case"bottom":return(0,a.jsx)("span",{"aria-hidden":!0,className:"".concat(c," left-1/2 -translate-x-1/2 -top-[6px] border-b-white border-[6px]"),style:{borderTopWidth:0,borderLeftColor:"transparent",borderRightColor:"transparent"}});case"left":return(0,a.jsx)("span",{"aria-hidden":!0,className:"".concat(c," -right-[6px] top-1/2 -translate-y-1/2 border-l-white border-[6px]"),style:{borderTopColor:"transparent",borderBottomColor:"transparent",borderRightWidth:0}});case"right":return(0,a.jsx)("span",{"aria-hidden":!0,className:"".concat(c," -left-[6px] top-1/2 -translate-y-1/2 border-r-white border-[6px]"),style:{borderTopColor:"transparent",borderBottomColor:"transparent",borderLeftWidth:0}});default:return(0,a.jsx)("span",{"aria-hidden":!0,className:"".concat(c," left-1/2 -translate-x-1/2 -bottom-[6px] border-t-white border-[6px]"),style:{borderLeftColor:"transparent",borderRightColor:"transparent",borderBottomWidth:0}})}})();return(0,a.jsx)("span",{className:"relative inline-flex items-center align-middle ".concat(r),children:(0,a.jsxs)("span",{className:"group relative inline-flex",children:[(0,a.jsx)("button",{type:"button","aria-describedby":l,className:"inline-flex items-center justify-center rounded-full border text-[10px] leading-none select-none cursor-help text-gray-700 border-gray-300 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-black",style:{width:d,height:d},children:"?"}),(0,a.jsxs)("span",{id:l,role:"tooltip",className:"".concat("pointer-events-none absolute z-50 hidden max-w-xs rounded-md border bg-white px-2 py-1 text-xs text-gray-700 shadow-lg"," ").concat(o," group-hover:block group-focus-within:block"),children:[t,u]})]})})}},5960:function(e,t,n){"use strict";n.d(t,{Z:function(){return r},y:function(){return s}});var a=n(2265);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(a)}function r(e){let[t,n]=a.useState(e||s()),[r,i]=a.useState([]),[l,o]=a.useState(!1),[c,d]=a.useState(null),u=a.useCallback(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t;o(!0),d(null);try{let t=new URLSearchParams;e&&t.set("date",e);let n=await fetch("/api/medico/clinical?".concat(t.toString()),{cache:"no-store"});if(!n.ok)throw Error("HTTP ".concat(n.status));let a=await n.json();i(Array.isArray(a)?a:[]),a&&0!==a.length||d("EMPTY")}catch(e){i([]),d("ERR")}finally{o(!1)}},[t]);async function m(e){let n={...e};n.date||(n.date=t);let a=await fetch("/api/medico/clinical",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(n)});if(!a.ok){let e=await a.text().catch(()=>"");throw Error("Error guardando episodio (".concat(a.status,") ").concat(e))}return await u(n.date),a.json()}return a.useEffect(()=>{u(t)},[t,u]),{date:t,setDate:n,items:r,loading:l,error:c,reload:u,saveEpisode:m}}},1940:function(e,t,n){"use strict";function a(e,t){if(!e||0===e.length)return"";let n=t&&t.length?t:Object.keys(e[0]),a=e=>{if(null==e)return"";let t=String(e);return/[",\n]/.test(t)?'"'.concat(t.replace(/"/g,'""'),'"'):t};return"\uFEFF"+n.map(a).join(",")+"\n"+e.map(e=>n.map(t=>a(e[t])).join(",")).join("\n")}n.d(t,{C:function(){return a}})}},function(e){e.O(0,[2971,7023,1744],function(){return e(e.s=4419)}),_N_E=e.O()}]);