(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7132],{342:function(e,t,a){Promise.resolve().then(a.bind(a,2624))},7138:function(e,t,a){"use strict";a.d(t,{default:function(){return l.a}});var r=a(231),l=a.n(r)},2624:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var r=a(7437),l=a(2265),n=a(6344),i=a(7138);function o(){let[e,t]=(0,l.useState)(!0),[a,o]=(0,l.useState)([]),[s,c]=(0,l.useState)(""),[d,u]=(0,l.useState)(!1),[m,x]=(0,l.useState)(()=>({id:void 0,name:"",logoUrl:""}));async function h(){t(!0);try{let e=await (0,n.oD)();o(e)}catch(e){console.error(e),alert("No se pudo cargar rivales.")}finally{t(!1)}}(0,l.useEffect)(()=>{h()},[]);let p=(0,l.useMemo)(()=>{let e=s.trim().toLowerCase();return e?a.filter(t=>t.name.toLowerCase().includes(e)||(t.logoUrl||"").toLowerCase().includes(e)):a},[s,a]);async function g(e){e.preventDefault();let t=m.name.trim(),a=(m.logoUrl||"").trim()||null;if(!t){alert("Ingres\xe1 un nombre");return}u(!0);try{if(!await (0,n.AA)({id:m.id,name:t,logoUrl:a}))throw Error("No se pudo guardar");await h(),x({id:void 0,name:"",logoUrl:""})}catch(e){console.error(e),alert((null==e?void 0:e.message)||"Error al guardar")}finally{u(!1)}}async function y(e){if(confirm('\xbfEliminar rival "'.concat(e.name,'"?')))try{await (0,n.Om)(e.id),await h()}catch(e){console.error(e),alert((null==e?void 0:e.message)||"Error al eliminar")}}return(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)("header",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-lg md:text-xl font-bold",children:"Rivales — Gesti\xf3n"}),(0,r.jsx)("p",{className:"text-xs md:text-sm text-gray-500",children:"Alta / edici\xf3n / borrado (se usa en el “D\xeda Partido” del plan semanal)"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(i.default,{href:"/ct/rivales",className:"px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"← Volver a Rivales"}),(0,r.jsx)("a",{href:"/ct/dashboard",className:"px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"Dashboard"})]})]}),(0,r.jsxs)("section",{className:"rounded-2xl border bg-white shadow-sm overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-gray-50 px-3 py-2 border-b flex items-center justify-between",children:[(0,r.jsx)("div",{className:"text-[12px] font-semibold uppercase tracking-wide",children:m.id?"Editar rival":"Nuevo rival"}),m.id&&(0,r.jsx)("button",{type:"button",onClick:function(){x({id:void 0,name:"",logoUrl:""})},className:"text-[11px] rounded-lg border px-2 py-0.5 hover:bg-gray-50",children:"Limpiar"})]}),(0,r.jsxs)("form",{onSubmit:g,className:"p-3 grid md:grid-cols-3 gap-3",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-[11px] text-gray-500",children:"Nombre"}),(0,r.jsx)("input",{className:"w-full rounded-md border px-2 py-1.5 text-sm",placeholder:"Club Atl\xe9tico Ejemplo",value:m.name,onChange:e=>x(t=>({...t,name:e.target.value}))})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-[11px] text-gray-500",children:"Logo (URL)"}),(0,r.jsx)("input",{className:"w-full rounded-md border px-2 py-1.5 text-sm",placeholder:"https://…",value:m.logoUrl,onChange:e=>x(t=>({...t,logoUrl:e.target.value}))})]}),(0,r.jsx)("div",{className:"space-y-1 flex items-end",children:(0,r.jsx)("button",{type:"submit",disabled:d,className:"px-3 py-1.5 rounded-xl text-xs ".concat(d?"bg-gray-200 text-gray-500":"bg-black text-white hover:opacity-90"),children:d?"Guardando…":m.id?"Guardar cambios":"Agregar"})}),m.logoUrl?(0,r.jsx)("div",{className:"md:col-span-3",children:(0,r.jsx)("img",{src:m.logoUrl,alt:"Logo preview",className:"max-h-28 rounded border object-contain"})}):null]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{className:"w-full md:w-80 rounded-md border px-2 py-1.5 text-sm",placeholder:"Buscar rival…",value:s,onChange:e=>c(e.target.value)}),(0,r.jsxs)("span",{className:"text-[12px] text-gray-500",children:[p.length," resultado(s)"]})]}),(0,r.jsxs)("section",{className:"rounded-2xl border bg-white shadow-sm overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-gray-50 px-3 py-2 border-b text-[12px] font-semibold uppercase tracking-wide",children:"Lista"}),e?(0,r.jsx)("div",{className:"p-4 text-gray-500",children:"Cargando…"}):0===p.length?(0,r.jsx)("div",{className:"p-4 text-gray-500 italic",children:"Sin resultados"}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b bg-gray-50",children:[(0,r.jsx)("th",{className:"text-left px-3 py-2",children:"Logo"}),(0,r.jsx)("th",{className:"text-left px-3 py-2",children:"Nombre"}),(0,r.jsx)("th",{className:"text-left px-3 py-2",children:"URL"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"Acciones"})]})}),(0,r.jsx)("tbody",{children:p.map(e=>(0,r.jsxs)("tr",{className:"border-b last:border-0",children:[(0,r.jsx)("td",{className:"px-3 py-2",children:e.logoUrl?(0,r.jsx)("img",{src:e.logoUrl,alt:e.name,className:"h-10 w-10 object-contain rounded border bg-white"}):(0,r.jsx)("div",{className:"h-10 w-10 rounded border bg-gray-50"})}),(0,r.jsx)("td",{className:"px-3 py-2 font-medium",children:e.name}),(0,r.jsx)("td",{className:"px-3 py-2",children:e.logoUrl?(0,r.jsx)("a",{href:e.logoUrl,target:"_blank",rel:"noreferrer",className:"underline text-emerald-700 break-all",children:e.logoUrl}):(0,r.jsx)("span",{className:"text-gray-400",children:"—"})}),(0,r.jsx)("td",{className:"px-3 py-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)("button",{type:"button",className:"h-7 px-2 rounded border text-[11px] hover:bg-gray-50",onClick:()=>{x({id:e.id,name:e.name,logoUrl:e.logoUrl||""}),window.scrollTo({top:0,behavior:"smooth"})},children:"Editar"}),(0,r.jsx)("button",{type:"button",className:"h-7 px-2 rounded border text-[11px] hover:bg-gray-50",onClick:()=>y(e),children:"Borrar"})]})})]},e.id))})]})})]})]})}},6344:function(e,t,a){"use strict";a.d(t,{AA:function(){return u},H$:function(){return o},Om:function(){return m},TL:function(){return c},hV:function(){return s},oD:function(){return d}});let r="ct_exercise_kinds",l="ct_rivals",n=["Rueda de pases","Circuito t\xe9cnico","SSG","MSG","LSG"];async function i(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6e3;try{let r=window.location.origin,l=e.startsWith("http")?e:"".concat(r).concat(e),n=new AbortController,i=setTimeout(()=>n.abort(),a),o=await fetch(l,{...t,signal:n.signal,cache:"no-store"});if(clearTimeout(i),!o.ok)return null;return await o.json()}catch(e){return null}}async function o(){var e;let t=await i("/api/exercise-kinds");if(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.length){try{localStorage.setItem(r,JSON.stringify(t.data))}catch(e){}return t.data}try{let e=localStorage.getItem(r);if(e)return JSON.parse(e)}catch(e){}return n}async function s(e){var t;let a=(e||"").trim();if(!a)return o();let l=await i("/api/exercise-kinds",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a})});if(null==l?void 0:null===(t=l.data)||void 0===t?void 0:t.length){try{localStorage.setItem(r,JSON.stringify(l.data))}catch(e){}return l.data}let n=await o();n.includes(a)||n.push(a);try{localStorage.setItem(r,JSON.stringify(n))}catch(e){}return n}async function c(e){var t;let a=Array.from(new Set((e||[]).map(e=>e.trim()).filter(Boolean))),l=await i("/api/exercise-kinds",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({names:a})}),n=(null==l?void 0:null===(t=l.data)||void 0===t?void 0:t.length)?l.data:a;try{localStorage.setItem(r,JSON.stringify(n))}catch(e){}return n}async function d(){let e=await i("/api/ct/rivales");if(null==e?void 0:e.data){try{localStorage.setItem(l,JSON.stringify(e.data))}catch(e){}return e.data}try{let e=localStorage.getItem(l);if(e)return JSON.parse(e)}catch(e){}return[]}async function u(e){var t,a,r,n,o,s,c,u,m,x,h;let p={id:null!==(t=e.id)&&void 0!==t?t:null,name:e.name.trim(),logoUrl:null!==(a=e.logoUrl)&&void 0!==a?a:null,coach:null!==(r=e.coach)&&void 0!==r?r:null,baseSystem:null!==(n=e.baseSystem)&&void 0!==n?n:null,nextMatchDate:null!==(o=e.nextMatchDate)&&void 0!==o?o:null,nextMatchCompetition:null!==(s=e.nextMatchCompetition)&&void 0!==s?s:null},g=e.id?"/api/ct/rivales/".concat(encodeURIComponent(e.id)):"/api/ct/rivales",y=e.id?"PUT":"POST",f=await i(g,{method:y,headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(null==f?void 0:f.data){let e=await d(),t=e.findIndex(e=>e.id===f.data.id);t>=0?e[t]=f.data:e.push(f.data);try{localStorage.setItem(l,JSON.stringify(e))}catch(e){}return f.data}let v=await d(),b=null!==(c=e.id)&&void 0!==c?c:"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():"id_".concat(Date.now(),"_").concat(Math.random().toString(16).slice(2)),N={id:b,name:p.name,logoUrl:p.logoUrl,coach:null!==(u=p.coach)&&void 0!==u?u:null,baseSystem:null!==(m=p.baseSystem)&&void 0!==m?m:null,nextMatchDate:null!==(x=p.nextMatchDate)&&void 0!==x?x:null,nextMatchCompetition:null!==(h=p.nextMatchCompetition)&&void 0!==h?h:null},j=v.findIndex(e=>e.id===b);j>=0?v[j]=N:v.push(N);try{localStorage.setItem(l,JSON.stringify(v))}catch(e){}return N}async function m(e){let t=await i("/api/ct/rivales/".concat(encodeURIComponent(e)),{method:"DELETE"});if(null==t?void 0:t.ok){let t=(await d()).filter(t=>t.id!==e);try{localStorage.setItem(l,JSON.stringify(t))}catch(e){}return{ok:!0}}let a=(await d()).filter(t=>t.id!==e);try{localStorage.setItem(l,JSON.stringify(a))}catch(e){}return{ok:!0}}}},function(e){e.O(0,[231,2971,7023,1744],function(){return e(e.s=342)}),_N_E=e.O()}]);