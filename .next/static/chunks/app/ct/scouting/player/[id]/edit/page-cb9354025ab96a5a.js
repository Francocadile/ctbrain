(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1343],{5403:function(e,a,l){Promise.resolve().then(l.bind(l,3701))},7138:function(e,a,l){"use strict";l.d(a,{default:function(){return s.a}});var t=l(231),s=l.n(t)},6463:function(e,a,l){"use strict";var t=l(1169);l.o(t,"useParams")&&l.d(a,{useParams:function(){return t.useParams}}),l.o(t,"usePathname")&&l.d(a,{usePathname:function(){return t.usePathname}}),l.o(t,"useRouter")&&l.d(a,{useRouter:function(){return t.useRouter}}),l.o(t,"useSearchParams")&&l.d(a,{useSearchParams:function(){return t.useSearchParams}})},3701:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return o}});var t=l(7437),s=l(2265),n=l(6463),r=l(7138);function o(){var e,a,l,o,u,x,m,p,g,h;let v=(0,n.useRouter)(),b=(0,n.useParams)(),y=null==b?void 0:b.id,[f,j]=(0,s.useState)(!0),[N,w]=(0,s.useState)(!1),[E,C]=(0,s.useState)(!1),[P,k]=(0,s.useState)([]),[S,A]=(0,s.useState)(null),[I,T]=(0,s.useState)(()=>({id:"",fullName:"",positions:[],club:null,estado:"ACTIVO",categoriaId:null,agentName:null,agentPhone:null,agentEmail:null,playerPhone:null,playerEmail:null,instagram:null,videos:[],notes:null,rating:null})),D=(0,s.useMemo)(()=>JSON.stringify(I)!==JSON.stringify(S),[I,S]);async function O(){j(!0);try{var e,a,l,t,s,n,r,o,i,d;let c=await fetch("/api/ct/scouting/players/".concat(y),{cache:"no-store"});if(!c.ok)throw Error("No se pudo cargar el jugador");let u=(await c.json()).data,x=await fetch("/api/ct/scouting/categories",{cache:"no-store"});if(!x.ok)throw Error("No se pudieron cargar categor\xedas");let m=(await x.json()).data;k(m),A(u),T({...u,club:null!==(e=u.club)&&void 0!==e?e:null,notes:null!==(a=u.notes)&&void 0!==a?a:null,rating:null!==(l=u.rating)&&void 0!==l?l:null,categoriaId:null!==(t=u.categoriaId)&&void 0!==t?t:null,positions:Array.isArray(u.positions)?u.positions:[],videos:Array.isArray(u.videos)?u.videos:[],agentName:null!==(s=u.agentName)&&void 0!==s?s:null,agentPhone:null!==(n=u.agentPhone)&&void 0!==n?n:null,agentEmail:null!==(r=u.agentEmail)&&void 0!==r?r:null,playerPhone:null!==(o=u.playerPhone)&&void 0!==o?o:null,playerEmail:null!==(i=u.playerEmail)&&void 0!==i?i:null,instagram:null!==(d=u.instagram)&&void 0!==d?d:null})}catch(e){console.error(e),alert("No se pudo cargar la ficha."),v.push("/ct/scouting")}finally{j(!1)}}async function R(e){if(e.preventDefault(),!I.fullName.trim()){alert("Ingres\xe1 el nombre completo del jugador");return}w(!0);try{let e={fullName:I.fullName.trim(),positions:I.positions.filter(Boolean),club:I.club||null,estado:I.estado,categoriaId:I.categoriaId||null,agentName:I.agentName||null,agentPhone:I.agentPhone||null,agentEmail:I.agentEmail||null,playerPhone:I.playerPhone||null,playerEmail:I.playerEmail||null,instagram:I.instagram||null,videos:(I.videos||[]).filter(Boolean),notes:I.notes||null,rating:"number"==typeof I.rating?I.rating:null,tags:[]},a=await fetch("/api/ct/scouting/players/".concat(y),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"No se pudo guardar")}let l=(await a.json()).data;A(l),T(l),alert("Guardado"),v.push("/ct/scouting/player/".concat(y))}catch(e){console.error(e),alert((null==e?void 0:e.message)||"Error al guardar")}finally{w(!1)}}async function _(){if(confirm("\xbfEliminar jugador? Esta acci\xf3n no se puede deshacer.")){C(!0);try{let e=await fetch("/api/ct/scouting/players/".concat(y),{method:"DELETE"});if(!e.ok){let a=await e.json().catch(()=>({}));throw Error((null==a?void 0:a.error)||"No se pudo borrar")}alert("Jugador eliminado"),v.push("/ct/scouting")}catch(e){console.error(e),alert((null==e?void 0:e.message)||"Error al borrar")}finally{C(!1)}}}return((0,s.useEffect)(()=>{y&&O()},[y]),f)?(0,t.jsx)("div",{className:"p-4 text-gray-500",children:"Cargando…"}):(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[(0,t.jsxs)("header",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-lg md:text-xl font-bold",children:"Editar jugador"}),(0,t.jsx)("p",{className:"text-xs md:text-sm text-gray-500",children:"Actualiz\xe1 datos, contacto, rating y videos."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r.default,{href:"/ct/scouting/player/".concat(y),className:"px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"← Volver a ficha"}),(0,t.jsx)(r.default,{href:"/ct/scouting",className:"px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"Scouting"})]})]}),(0,t.jsxs)("form",{onSubmit:R,className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)("section",{className:"lg:col-span-2 rounded-2xl border bg-white shadow-sm overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gray-50 px-3 py-2 border-b text-[12px] font-semibold uppercase tracking-wide",children:"Datos"}),(0,t.jsxs)("div",{className:"p-3 grid md:grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"space-y-1 md:col-span-2",children:[(0,t.jsx)("label",{className:"text-[11px] text-gray-500",children:"Nombre completo"}),(0,t.jsx)("input",{className:"w-full rounded-md border px-2 py-1.5 text-sm",value:I.fullName,onChange:e=>T(a=>({...a,fullName:e.target.value})),placeholder:"Ej. Juan P\xe9rez"})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-[11px] text-gray-500",children:"Club"}),(0,t.jsx)("input",{className:"w-full rounded-md border px-2 py-1.5 text-sm",value:null!==(e=I.club)&&void 0!==e?e:"",onChange:e=>T(a=>({...a,club:e.target.value||null})),placeholder:"Ej. Gimnasia de Mendoza"})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-[11px] text-gray-500",children:"Estado"}),(0,t.jsxs)("select",{className:"w-full rounded-md border px-2 py-1.5 text-sm",value:I.estado,onChange:e=>T(a=>({...a,estado:e.target.value})),children:[(0,t.jsx)("option",{value:"ACTIVO",children:"ACTIVO"}),(0,t.jsx)("option",{value:"WATCHLIST",children:"WATCHLIST"}),(0,t.jsx)("option",{value:"DESCARTADO",children:"DESCARTADO"})]})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-[11px] text-gray-500",children:"Categor\xeda"}),(0,t.jsxs)("select",{className:"w-full rounded-md border px-2 py-1.5 text-sm",value:null!==(a=I.categoriaId)&&void 0!==a?a:"",onChange:e=>T(a=>({...a,categoriaId:e.target.value?e.target.value:null})),children:[(0,t.jsx)("option",{value:"",children:"— Sin categor\xeda —"}),P.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.nombre," ",e.activa?"":"(archivada)"]},e.id))]})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-[11px] text-gray-500",children:"Rating (0–10)"}),(0,t.jsx)("input",{type:"number",min:0,max:10,className:"w-full rounded-md border px-2 py-1.5 text-sm",value:null!==(l=I.rating)&&void 0!==l?l:"",onChange:e=>T(a=>({...a,rating:""===e.target.value?null:Math.max(0,Math.min(10,parseInt(e.target.value)))})),placeholder:"—"})]}),(0,t.jsxs)("div",{className:"space-y-1 md:col-span-2",children:[(0,t.jsx)("label",{className:"text-[11px] text-gray-500",children:"Posiciones"}),(0,t.jsx)(d,{values:I.positions,onAdd:function(e){let a=(e||"").trim();a&&!I.positions.includes(a)&&T(e=>({...e,positions:[...e.positions,a]}))},onRemove:function(e){T(a=>({...a,positions:a.positions.filter(a=>a!==e)}))}})]})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border bg-white shadow-sm overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gray-50 px-3 py-2 border-b text-[12px] font-semibold uppercase tracking-wide",children:"Contacto"}),(0,t.jsxs)("div",{className:"p-3 space-y-3",children:[(0,t.jsx)(i,{label:"Agente",value:null!==(o=I.agentName)&&void 0!==o?o:"",onChange:e=>T(a=>({...a,agentName:e||null}))}),(0,t.jsx)(i,{label:"Tel. agente",value:null!==(u=I.agentPhone)&&void 0!==u?u:"",onChange:e=>T(a=>({...a,agentPhone:e||null}))}),(0,t.jsx)(i,{label:"Email agente",value:null!==(x=I.agentEmail)&&void 0!==x?x:"",onChange:e=>T(a=>({...a,agentEmail:e||null}))}),(0,t.jsx)(i,{label:"Tel. jugador",value:null!==(m=I.playerPhone)&&void 0!==m?m:"",onChange:e=>T(a=>({...a,playerPhone:e||null}))}),(0,t.jsx)(i,{label:"Email jugador",value:null!==(p=I.playerEmail)&&void 0!==p?p:"",onChange:e=>T(a=>({...a,playerEmail:e||null}))}),(0,t.jsx)(i,{label:"Instagram",value:null!==(g=I.instagram)&&void 0!==g?g:"",onChange:e=>T(a=>({...a,instagram:e||null}))})]})]}),(0,t.jsxs)("section",{className:"lg:col-span-3 rounded-2xl border bg-white shadow-sm overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gray-50 px-3 py-2 border-b text-[12px] font-semibold uppercase tracking-wide",children:"Videos"}),(0,t.jsx)("div",{className:"p-3",children:(0,t.jsx)(c,{items:I.videos||[],onAdd:function(e){let a=(e||"").trim();a&&T(e=>({...e,videos:[...e.videos||[],a]}))},onRemove:function(e){T(a=>({...a,videos:a.videos.filter((a,l)=>l!==e)}))}})})]}),(0,t.jsxs)("section",{className:"lg:col-span-3 rounded-2xl border bg-white shadow-sm overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gray-50 px-3 py-2 border-b text-[12px] font-semibold uppercase tracking-wide",children:"Notas"}),(0,t.jsx)("div",{className:"p-3",children:(0,t.jsx)("textarea",{className:"w-full min-h-[120px] rounded-md border px-2 py-1.5 text-sm",value:null!==(h=I.notes)&&void 0!==h?h:"",onChange:e=>T(a=>({...a,notes:e.target.value||null})),placeholder:"Observaciones t\xe9cnicas, m\xe9tricas, etc."})})]}),(0,t.jsxs)("div",{className:"lg:col-span-3 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:D?"Cambios sin guardar":"Sin cambios"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>v.push("/ct/scouting/player/".concat(y)),className:"px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"Cancelar"}),(0,t.jsx)("button",{type:"submit",disabled:N,className:"px-3 py-1.5 rounded-xl text-xs ".concat(N?"bg-gray-200 text-gray-500":"bg-black text-white hover:opacity-90"),children:N?"Guardando…":"Guardar"}),(0,t.jsx)("button",{type:"button",onClick:_,disabled:E,className:"px-3 py-1.5 rounded-xl border text-xs hover:bg-red-50 text-red-700 border-red-200",children:E?"Borrando…":"Borrar"})]})]})]})]})}function i(e){let{label:a,value:l,onChange:s,placeholder:n}=e;return(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-[11px] text-gray-500",children:a}),(0,t.jsx)("input",{className:"w-full rounded-md border px-2 py-1.5 text-sm",value:l,onChange:e=>s(e.target.value),placeholder:n})]})}function d(e){let{values:a,onAdd:l,onRemove:n}=e,[r,o]=(0,s.useState)("");return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,t.jsx)("input",{className:"w-64 rounded-md border px-2 py-1.5 text-sm",value:r,onChange:e=>o(e.target.value),placeholder:"Ej. Delantero, Extremo, Volante…",onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),r.trim()&&(l(r.trim()),o("")))}}),(0,t.jsx)("button",{type:"button",className:"px-3 py-1.5 rounded-xl border text-xs hover:bg-gray-50",onClick:()=>{r.trim()&&(l(r.trim()),o(""))},children:"Agregar"})]}),0===a.length?(0,t.jsx)("div",{className:"text-sm text-gray-500 italic",children:"Sin posiciones cargadas"}):(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:a.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-xs",children:[e,(0,t.jsx)("button",{type:"button",className:"text-gray-500 hover:text-black",onClick:()=>n(e),"aria-label":"Quitar ".concat(e),children:"\xd7"})]},e))})]})}function c(e){let{items:a,onAdd:l,onRemove:n}=e,[r,o]=(0,s.useState)("");return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{className:"w-full md:w-[520px] rounded-md border px-2 py-1.5 text-sm",placeholder:"Pega un enlace (YouTube, Drive, etc.)",value:r,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),r.trim()&&(l(r.trim()),o("")))}}),(0,t.jsx)("button",{type:"button",className:"px-3 py-1.5 rounded-xl border text-xs hover:bg-gray-50",onClick:()=>{r.trim()&&(l(r.trim()),o(""))},children:"Agregar"})]}),0===a.length?(0,t.jsx)("div",{className:"text-sm text-gray-500 italic",children:"Sin videos cargados"}):(0,t.jsx)("ul",{className:"list-disc list-inside space-y-1",children:a.map((e,a)=>(0,t.jsxs)("li",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("a",{href:e,target:"_blank",rel:"noreferrer",className:"underline break-all",children:e}),(0,t.jsx)("button",{type:"button",className:"text-xs rounded-md border px-2 py-0.5 hover:bg-gray-50",onClick:()=>n(a),children:"Quitar"})]},"".concat(e,"-").concat(a)))})]})}}},function(e){e.O(0,[231,2971,7023,1744],function(){return e(e.s=5403)}),_N_E=e.O()}]);