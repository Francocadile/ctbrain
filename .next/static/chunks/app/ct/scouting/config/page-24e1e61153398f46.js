(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4992],{364:function(t,e,a){Promise.resolve().then(a.bind(a,7838))},7138:function(t,e,a){"use strict";a.d(e,{default:function(){return n.a}});var r=a(231),n=a.n(r)},7838:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return c}});var r=a(7437),n=a(2265),i=a(4665),l=a(7138),o=a(6827);function c(){let[t,e]=(0,n.useState)(!0),[a,c]=(0,n.useState)([]),[s,d]=(0,n.useState)(""),[u,g]=(0,n.useState)("");async function h(){e(!0);try{let t=await (0,i.kb)();c(t.sort((t,e)=>t.orden-e.orden))}finally{e(!1)}}(0,n.useEffect)(()=>{h()},[]);let x=(0,n.useMemo)(()=>{let t=s.trim().toLowerCase();return t?a.filter(e=>e.nombre.toLowerCase().includes(t)):a},[s,a]);async function f(){let t=u.trim();t&&(await (0,i.k4)(t),g(""),await h())}async function m(t){await (0,i.yr)(t.id,{activa:!t.activa}),await h()}async function p(t){if(!confirm('\xbfBorrar la categor\xeda "'.concat(t.nombre,'"? (Solo si no tiene jugadores)')))return;let e=await (0,i.uu)(t.id);if("error"in e){alert(e.error);return}await h()}return(0,r.jsxs)(o.Z,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-lg md:text-xl font-bold",children:"Scouting — Categor\xedas"}),(0,r.jsx)("p",{className:"text-xs md:text-sm text-gray-500",children:"Crear, renombrar, activar/archivar."})]}),(0,r.jsx)(l.default,{href:"/ct/scouting",className:"px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"← Volver"})]}),(0,r.jsxs)("div",{className:"rounded-2xl border bg-white p-3 mb-4",children:[(0,r.jsx)("div",{className:"text-[12px] font-semibold uppercase tracking-wide mb-2",children:"Nueva categor\xeda"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{className:"w-full md:w-80 rounded-md border px-2 py-1.5 text-sm",placeholder:"Ej: Jugadores locales",value:u,onChange:t=>g(t.target.value)}),(0,r.jsx)("button",{onClick:f,className:"px-3 py-1.5 rounded-xl text-xs bg-black text-white hover:opacity-90",children:"Agregar"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("input",{className:"w-full md:w-80 rounded-md border px-2 py-1.5 text-sm",placeholder:"Buscar categor\xeda…",value:s,onChange:t=>d(t.target.value)}),(0,r.jsxs)("span",{className:"text-[12px] text-gray-500",children:[x.length," resultado(s)"]})]}),(0,r.jsx)("div",{className:"rounded-2xl border bg-white overflow-hidden",children:t?(0,r.jsx)("div",{className:"p-4 text-gray-500",children:"Cargando…"}):0===x.length?(0,r.jsx)("div",{className:"p-4 text-gray-500 italic",children:"Sin resultados"}):(0,r.jsxs)("table",{className:"min-w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b bg-gray-50",children:[(0,r.jsx)("th",{className:"text-left px-3 py-2",children:"Nombre"}),(0,r.jsx)("th",{className:"text-left px-3 py-2",children:"Slug"}),(0,r.jsx)("th",{className:"text-left px-3 py-2",children:"Estado"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"Acciones"})]})}),(0,r.jsx)("tbody",{children:x.map(t=>(0,r.jsxs)("tr",{className:"border-b last:border-0",children:[(0,r.jsx)("td",{className:"px-3 py-2 font-medium",children:t.nombre}),(0,r.jsx)("td",{className:"px-3 py-2",children:t.slug}),(0,r.jsx)("td",{className:"px-3 py-2",children:t.activa?"Activa":"Archivada"}),(0,r.jsx)("td",{className:"px-3 py-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)("button",{className:"h-7 px-2 rounded border text-[11px] hover:bg-gray-50",onClick:()=>m(t),children:t.activa?"Archivar":"Activar"}),(0,r.jsx)("button",{className:"h-7 px-2 rounded border text-[11px] hover:bg-gray-50",onClick:()=>p(t),children:"Borrar"}),(0,r.jsx)(l.default,{href:"/ct/scouting/".concat(t.slug),className:"h-7 px-2 rounded border text-[11px] hover:bg-gray-50",children:"Abrir"})]})})]},t.id))})]})})]})}},6827:function(t,e,a){"use strict";a.d(e,{Z:function(){return n}});var r=a(7437);function n(t){let{children:e}=t;return(0,r.jsx)("div",{className:"mx-auto w-full max-w-6xl px-4 sm:px-6 lg:px-8",children:e})}},4665:function(t,e,a){"use strict";a.d(e,{Jp:function(){return g},M_:function(){return d},RC:function(){return u},WQ:function(){return h},k4:function(){return o},kb:function(){return l},uu:function(){return s},yr:function(){return c}});let r="ct_scout_categories",n="ct_scout_players_";async function i(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6e3;try{let r=window.location.origin,n=t.startsWith("http")?t:"".concat(r).concat(t),i=new AbortController,l=setTimeout(()=>i.abort(),a),o=await fetch(n,{...e,signal:i.signal,cache:"no-store"});if(clearTimeout(l),!o.ok)return null;return await o.json()}catch(t){return null}}async function l(){let t=await i("/api/ct/scouting/categories");if(null==t?void 0:t.data){try{localStorage.setItem(r,JSON.stringify(t.data))}catch(t){}return t.data}try{let t=localStorage.getItem(r);if(t)return JSON.parse(t)}catch(t){}return[]}async function o(t){let e=await i("/api/ct/scouting/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:t})});if(null==e?void 0:e.data){let t=await l();t.push(e.data);try{localStorage.setItem(r,JSON.stringify(t))}catch(t){}return e.data}let a=t.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9\-]/g,""),n={id:"local_".concat(Date.now()),nombre:t,slug:a,orden:Date.now(),activa:!0,color:void 0},o=await l();o.push(n);try{localStorage.setItem(r,JSON.stringify(o))}catch(t){}return n}async function c(t,e){let a=await i("/api/ct/scouting/categories/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(null==a?void 0:a.data){let e=await l(),n=e.findIndex(e=>e.id===t);n>=0&&(e[n]=a.data);try{localStorage.setItem(r,JSON.stringify(e))}catch(t){}return a.data}let n=await l(),o=n.findIndex(e=>e.id===t);o>=0&&(n[o]={...n[o],...e});try{localStorage.setItem(r,JSON.stringify(n))}catch(t){}return n[o]}async function s(t){try{let e=await fetch("/api/ct/scouting/categories/".concat(t),{method:"DELETE",cache:"no-store"}),a=null;try{a=await e.json()}catch(t){a=null}if(!e.ok)return{error:(null==a?void 0:a.error)||"HTTP ".concat(e.status)};let n=(await l()).filter(e=>e.id!==t);try{localStorage.setItem(r,JSON.stringify(n))}catch(t){}return{ok:!0}}catch(t){return{error:(null==t?void 0:t.message)||"Error de red al borrar categor\xeda"}}}async function d(t){let e=new URLSearchParams;(null==t?void 0:t.categoriaId)&&e.set("categoriaId",t.categoriaId),(null==t?void 0:t.q)&&e.set("q",t.q),(null==t?void 0:t.estado)&&e.set("estado",t.estado);let a=await i("/api/ct/scouting/players?".concat(e.toString()));if(null==a?void 0:a.data){if(null==t?void 0:t.categoriaId)try{localStorage.setItem(n+t.categoriaId,JSON.stringify(a.data))}catch(t){}return a.data}if(null==t?void 0:t.categoriaId)try{let e=localStorage.getItem(n+t.categoriaId);if(e)return JSON.parse(e)}catch(t){}return[]}async function u(t){var e;let a=await i("/api/ct/scouting/players/".concat(t));return null!==(e=null==a?void 0:a.data)&&void 0!==e?e:null}async function g(t){var e,a,r,l,o,c,s,u,g,h,x,f,m,p,y;let v={...t},N=t.id?"/api/ct/scouting/players/".concat(t.id):"/api/ct/scouting/players",b=t.id?"PUT":"POST",w=await i(N,{method:b,headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(null==w?void 0:w.data){if(w.data.categoriaId){let t=await d({categoriaId:w.data.categoriaId}),e=t.findIndex(t=>t.id===w.data.id);e>=0?t[e]=w.data:t.push(w.data);try{localStorage.setItem(n+w.data.categoriaId,JSON.stringify(t))}catch(t){}}return w.data}let j={id:null!==(e=t.id)&&void 0!==e?e:"local_".concat(Date.now()),fullName:t.fullName,positions:null!==(a=t.positions)&&void 0!==a?a:[],club:null!==(r=t.club)&&void 0!==r?r:null,estado:null!==(l=t.estado)&&void 0!==l?l:"ACTIVO",categoriaId:null!==(o=t.categoriaId)&&void 0!==o?o:null,agentName:null!==(c=t.agentName)&&void 0!==c?c:null,agentPhone:null!==(s=t.agentPhone)&&void 0!==s?s:null,agentEmail:null!==(u=t.agentEmail)&&void 0!==u?u:null,playerPhone:null!==(g=t.playerPhone)&&void 0!==g?g:null,playerEmail:null!==(h=t.playerEmail)&&void 0!==h?h:null,instagram:null!==(x=t.instagram)&&void 0!==x?x:null,videos:null!==(f=t.videos)&&void 0!==f?f:[],notes:null!==(m=t.notes)&&void 0!==m?m:null,rating:null!==(p=t.rating)&&void 0!==p?p:null,tags:null!==(y=t.tags)&&void 0!==y?y:[]};if(j.categoriaId){let t=await d({categoriaId:j.categoriaId}),e=t.findIndex(t=>t.id===j.id);e>=0?t[e]=j:t.push(j);try{localStorage.setItem(n+j.categoriaId,JSON.stringify(t))}catch(t){}}return j}async function h(t){return await i("/api/ct/scouting/players/".concat(t),{method:"DELETE"}),{ok:!0}}}},function(t){t.O(0,[231,2971,7023,1744],function(){return t(t.s=364)}),_N_E=t.O()}]);