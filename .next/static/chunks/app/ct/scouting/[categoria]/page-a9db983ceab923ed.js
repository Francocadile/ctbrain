(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8136],{8611:function(e,t,a){Promise.resolve().then(a.bind(a,427))},7138:function(e,t,a){"use strict";a.d(t,{default:function(){return n.a}});var l=a(231),n=a.n(l)},427:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return s}});var l=a(7437),n=a(2265),r=a(7138),i=a(4665),o=a(6827);function s(e){let{params:t}=e,a=t.categoria,[s,c]=(0,n.useState)([]),[d,u]=(0,n.useState)(null),[p,g]=(0,n.useState)([]),[m,h]=(0,n.useState)(!0),[x,f]=(0,n.useState)(""),[y,v]=(0,n.useState)({fullName:"",positions:"",club:"",agentPhone:"",playerPhone:"",video:""});async function N(){h(!0);try{var e;let t=await (0,i.kb)();c(t);let l=null!==(e=t.find(e=>e.slug===a))&&void 0!==e?e:null;if(u(l),l){let e=await (0,i.M_)({categoriaId:l.id});g(e)}else g([])}finally{h(!1)}}(0,n.useEffect)(()=>{N()},[a]);let b=(0,n.useMemo)(()=>{let e=x.trim().toLowerCase();return e?p.filter(t=>t.fullName.toLowerCase().includes(e)||(t.club||"").toLowerCase().includes(e)):p},[x,p]);async function j(e){if(e.preventDefault(),!d)return;if(!y.fullName.trim())return alert("Nombre requerido");if(!y.agentPhone&&!y.playerPhone)return alert("Cargar contacto (agente o jugador)");let t=y.positions.split(/[,\s/]+/).filter(Boolean),a=y.video.trim();await (0,i.Jp)({fullName:y.fullName.trim(),club:y.club.trim()||null,positions:t,categoriaId:d.id,agentPhone:y.agentPhone.trim()||null,playerPhone:y.playerPhone.trim()||null,videos:a?[a]:[],estado:"ACTIVO"}),v({fullName:"",positions:"",club:"",agentPhone:"",playerPhone:"",video:""}),await N()}async function w(e){confirm('\xbfEliminar a "'.concat(e.fullName,'"?'))&&(await (0,i.WQ)(e.id),await N())}return(0,l.jsxs)(o.Z,{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-lg md:text-xl font-bold",children:d?"Scouting — ".concat(d.nombre):"Scouting"}),(0,l.jsx)("p",{className:"text-xs md:text-sm text-gray-500",children:"Lista simple: nombre, posici\xf3n, club, contacto, video, estado."})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(r.default,{href:"/ct/scouting",className:"px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"← Volver"}),(0,l.jsx)("button",{onClick:function(){let e=new Blob([["Nombre,Posici\xf3n,Club,Contacto,Video,Estado,Actualizado",...b.map(e=>{let t=(e.positions||[]).join("/"),a=e.agentPhone||e.playerPhone||e.agentEmail||e.playerEmail||"",l=(e.videos||[])[0]||"",n=e.updatedAt?new Date(e.updatedAt).toLocaleDateString():"";return[e.fullName,t,e.club||"",a,l,e.estado,n].map(e=>'"'.concat((null!=e?e:"").toString().replace(/"/g,'""'),'"')).join(",")})].join("\n")],{type:"text/csv;charset=utf-8"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="scouting_".concat((null==d?void 0:d.slug)||"lista",".csv"),a.click(),URL.revokeObjectURL(t)},className:"px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"Exportar CSV"})]})]}),d&&(0,l.jsxs)("form",{onSubmit:j,className:"grid md:grid-cols-6 gap-2 rounded-2xl border bg-white p-3 mb-4",children:[(0,l.jsx)("input",{className:"rounded-md border px-2 py-1.5 text-sm",placeholder:"Nombre y apellido",value:y.fullName,onChange:e=>v(t=>({...t,fullName:e.target.value}))}),(0,l.jsx)("input",{className:"rounded-md border px-2 py-1.5 text-sm",placeholder:"Posici\xf3n (ej: DEF/VOL)",value:y.positions,onChange:e=>v(t=>({...t,positions:e.target.value}))}),(0,l.jsx)("input",{className:"rounded-md border px-2 py-1.5 text-sm",placeholder:"Club",value:y.club,onChange:e=>v(t=>({...t,club:e.target.value}))}),(0,l.jsx)("input",{className:"rounded-md border px-2 py-1.5 text-sm",placeholder:"Tel. agente",value:y.agentPhone,onChange:e=>v(t=>({...t,agentPhone:e.target.value}))}),(0,l.jsx)("input",{className:"rounded-md border px-2 py-1.5 text-sm",placeholder:"Tel. jugador",value:y.playerPhone,onChange:e=>v(t=>({...t,playerPhone:e.target.value}))}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{className:"flex-1 rounded-md border px-2 py-1.5 text-sm",placeholder:"Video (URL)",value:y.video,onChange:e=>v(t=>({...t,video:e.target.value}))}),(0,l.jsx)("button",{className:"px-3 py-1.5 rounded-xl text-xs bg-black text-white hover:opacity-90",children:"Agregar"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)("input",{className:"w-full md:w-80 rounded-md border px-2 py-1.5 text-sm",placeholder:"Buscar…",value:x,onChange:e=>f(e.target.value)}),(0,l.jsxs)("span",{className:"text-[12px] text-gray-500",children:[b.length," resultado(s)"]})]}),(0,l.jsx)("div",{className:"rounded-2xl border bg-white overflow-hidden",children:m?(0,l.jsx)("div",{className:"p-4 text-gray-500",children:"Cargando…"}):0===b.length?(0,l.jsx)("div",{className:"p-4 text-gray-500 italic",children:"Sin resultados"}):(0,l.jsxs)("table",{className:"min-w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b bg-gray-50",children:[(0,l.jsx)("th",{className:"text-left px-3 py-2",children:"Nombre"}),(0,l.jsx)("th",{className:"text-left px-3 py-2",children:"Posici\xf3n"}),(0,l.jsx)("th",{className:"text-left px-3 py-2",children:"Club"}),(0,l.jsx)("th",{className:"text-left px-3 py-2",children:"Contacto"}),(0,l.jsx)("th",{className:"text-left px-3 py-2",children:"Video"}),(0,l.jsx)("th",{className:"text-left px-3 py-2",children:"Estado"}),(0,l.jsx)("th",{className:"text-right px-3 py-2",children:"Acciones"})]})}),(0,l.jsx)("tbody",{children:b.map(e=>{var t;return(0,l.jsxs)("tr",{className:"border-b last:border-0",children:[(0,l.jsx)("td",{className:"px-3 py-2 font-medium",children:e.fullName}),(0,l.jsx)("td",{className:"px-3 py-2",children:(e.positions||[]).join("/")}),(0,l.jsx)("td",{className:"px-3 py-2",children:e.club||"—"}),(0,l.jsx)("td",{className:"px-3 py-2",children:e.agentPhone||e.playerPhone||e.agentEmail||e.playerEmail||"—"}),(0,l.jsx)("td",{className:"px-3 py-2",children:(null===(t=e.videos)||void 0===t?void 0:t[0])?(0,l.jsx)("a",{className:"underline text-emerald-700 break-all",href:e.videos[0],target:"_blank",children:"Ver"}):"—"}),(0,l.jsx)("td",{className:"px-3 py-2",children:e.estado}),(0,l.jsx)("td",{className:"px-3 py-2",children:(0,l.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,l.jsx)(r.default,{href:"/ct/scouting/player/".concat(e.id),className:"h-7 px-2 rounded border text-[11px] hover:bg-gray-50",children:"Ficha"}),(0,l.jsx)("button",{className:"h-7 px-2 rounded border text-[11px] hover:bg-gray-50",onClick:()=>w(e),children:"Borrar"})]})})]},e.id)})})]})})]})}},6827:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var l=a(7437);function n(e){let{children:t}=e;return(0,l.jsx)("div",{className:"mx-auto w-full max-w-6xl px-4 sm:px-6 lg:px-8",children:t})}},4665:function(e,t,a){"use strict";a.d(t,{Jp:function(){return p},M_:function(){return d},RC:function(){return u},WQ:function(){return g},k4:function(){return o},kb:function(){return i},uu:function(){return c},yr:function(){return s}});let l="ct_scout_categories",n="ct_scout_players_";async function r(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6e3;try{let l=window.location.origin,n=e.startsWith("http")?e:"".concat(l).concat(e),r=new AbortController,i=setTimeout(()=>r.abort(),a),o=await fetch(n,{...t,signal:r.signal,cache:"no-store"});if(clearTimeout(i),!o.ok)return null;return await o.json()}catch(e){return null}}async function i(){let e=await r("/api/ct/scouting/categories");if(null==e?void 0:e.data){try{localStorage.setItem(l,JSON.stringify(e.data))}catch(e){}return e.data}try{let e=localStorage.getItem(l);if(e)return JSON.parse(e)}catch(e){}return[]}async function o(e){let t=await r("/api/ct/scouting/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:e})});if(null==t?void 0:t.data){let e=await i();e.push(t.data);try{localStorage.setItem(l,JSON.stringify(e))}catch(e){}return t.data}let a=e.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9\-]/g,""),n={id:"local_".concat(Date.now()),nombre:e,slug:a,orden:Date.now(),activa:!0,color:void 0},o=await i();o.push(n);try{localStorage.setItem(l,JSON.stringify(o))}catch(e){}return n}async function s(e,t){let a=await r("/api/ct/scouting/categories/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(null==a?void 0:a.data){let t=await i(),n=t.findIndex(t=>t.id===e);n>=0&&(t[n]=a.data);try{localStorage.setItem(l,JSON.stringify(t))}catch(e){}return a.data}let n=await i(),o=n.findIndex(t=>t.id===e);o>=0&&(n[o]={...n[o],...t});try{localStorage.setItem(l,JSON.stringify(n))}catch(e){}return n[o]}async function c(e){try{let t=await fetch("/api/ct/scouting/categories/".concat(e),{method:"DELETE",cache:"no-store"}),a=null;try{a=await t.json()}catch(e){a=null}if(!t.ok)return{error:(null==a?void 0:a.error)||"HTTP ".concat(t.status)};let n=(await i()).filter(t=>t.id!==e);try{localStorage.setItem(l,JSON.stringify(n))}catch(e){}return{ok:!0}}catch(e){return{error:(null==e?void 0:e.message)||"Error de red al borrar categor\xeda"}}}async function d(e){let t=new URLSearchParams;(null==e?void 0:e.categoriaId)&&t.set("categoriaId",e.categoriaId),(null==e?void 0:e.q)&&t.set("q",e.q),(null==e?void 0:e.estado)&&t.set("estado",e.estado);let a=await r("/api/ct/scouting/players?".concat(t.toString()));if(null==a?void 0:a.data){if(null==e?void 0:e.categoriaId)try{localStorage.setItem(n+e.categoriaId,JSON.stringify(a.data))}catch(e){}return a.data}if(null==e?void 0:e.categoriaId)try{let t=localStorage.getItem(n+e.categoriaId);if(t)return JSON.parse(t)}catch(e){}return[]}async function u(e){var t;let a=await r("/api/ct/scouting/players/".concat(e));return null!==(t=null==a?void 0:a.data)&&void 0!==t?t:null}async function p(e){var t,a,l,i,o,s,c,u,p,g,m,h,x,f,y;let v={...e},N=e.id?"/api/ct/scouting/players/".concat(e.id):"/api/ct/scouting/players",b=e.id?"PUT":"POST",j=await r(N,{method:b,headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(null==j?void 0:j.data){if(j.data.categoriaId){let e=await d({categoriaId:j.data.categoriaId}),t=e.findIndex(e=>e.id===j.data.id);t>=0?e[t]=j.data:e.push(j.data);try{localStorage.setItem(n+j.data.categoriaId,JSON.stringify(e))}catch(e){}}return j.data}let w={id:null!==(t=e.id)&&void 0!==t?t:"local_".concat(Date.now()),fullName:e.fullName,positions:null!==(a=e.positions)&&void 0!==a?a:[],club:null!==(l=e.club)&&void 0!==l?l:null,estado:null!==(i=e.estado)&&void 0!==i?i:"ACTIVO",categoriaId:null!==(o=e.categoriaId)&&void 0!==o?o:null,agentName:null!==(s=e.agentName)&&void 0!==s?s:null,agentPhone:null!==(c=e.agentPhone)&&void 0!==c?c:null,agentEmail:null!==(u=e.agentEmail)&&void 0!==u?u:null,playerPhone:null!==(p=e.playerPhone)&&void 0!==p?p:null,playerEmail:null!==(g=e.playerEmail)&&void 0!==g?g:null,instagram:null!==(m=e.instagram)&&void 0!==m?m:null,videos:null!==(h=e.videos)&&void 0!==h?h:[],notes:null!==(x=e.notes)&&void 0!==x?x:null,rating:null!==(f=e.rating)&&void 0!==f?f:null,tags:null!==(y=e.tags)&&void 0!==y?y:[]};if(w.categoriaId){let e=await d({categoriaId:w.categoriaId}),t=e.findIndex(e=>e.id===w.id);t>=0?e[t]=w:e.push(w);try{localStorage.setItem(n+w.categoriaId,JSON.stringify(e))}catch(e){}}return w}async function g(e){return await r("/api/ct/scouting/players/".concat(e),{method:"DELETE"}),{ok:!0}}}},function(e){e.O(0,[231,2971,7023,1744],function(){return e(e.s=8611)}),_N_E=e.O()}]);