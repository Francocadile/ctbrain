(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8548],{4260:function(e,s,t){Promise.resolve().then(t.bind(t,6390))},6390:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var a=t(7437),i=t(2265);let r=["[EXERCISES]","[EXERCISE]","[EX]"];async function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,t=new URL("/api/sessions",window.location.origin);t.searchParams.set("order","date"),t.searchParams.set("dir","desc"),t.searchParams.set("page",String(e)),t.searchParams.set("pageSize",String(s));let a=await fetch(t.toString(),{cache:"no-store"});if(!a.ok)throw Error("No se pudieron listar sesiones");return await a.json()}async function l(e){let s=await fetch("/api/sessions/".concat(e),{cache:"no-store"});if(!s.ok)throw Error("No se pudo obtener la sesi\xf3n");return(await s.json()).data}function c(){let[e,s]=(0,i.useState)(!0),[t,c]=(0,i.useState)([]),[o,d]=(0,i.useState)(""),[u,x]=(0,i.useState)(1);(0,i.useEffect)(()=>{(async()=>{s(!0);try{let{data:e}=await n(1,200),s=await Promise.all(e.map(async e=>{if(e.description&&""!==e.description.trim())return e;try{var s;let t=await l(e.id);return{...e,description:null!==(s=t.description)&&void 0!==s?s:null}}catch(s){return e}})),t=[];for(let e of s){let s=function(e){let s=(e||"").trim();if(!s)return[];let t=-1;for(let e of r){let a=s.lastIndexOf(e);a>t&&(t=a)}if(-1===t)return[];let a=s.slice(t).replace(/^\[[^\]]+\]\s*/i,"").trim().split(/\s+/)[0]||"";try{let e=atob(a),s=JSON.parse(e);if(Array.isArray(s))return s.map(e=>{var s,t,a,i,r,n,l;return{title:null!==(s=e.title)&&void 0!==s?s:"",kind:null!==(t=e.kind)&&void 0!==t?t:"",space:null!==(a=e.space)&&void 0!==a?a:"",players:null!==(i=e.players)&&void 0!==i?i:"",duration:null!==(r=e.duration)&&void 0!==r?r:"",description:null!==(n=e.description)&&void 0!==n?n:"",imageUrl:null!==(l=e.imageUrl)&&void 0!==l?l:""}})}catch(e){}return[]}(e.description);0!==s.length&&s.forEach((s,a)=>{t.push({id:"".concat(e.id,"__").concat(a),sessionId:e.id,sessionTitle:e.title||"Sesi\xf3n",createdAt:e.date,exIndex:a,title:s.title||e.title||"Ejercicio ".concat(a+1),kind:s.kind||"",space:s.space||void 0,players:s.players||void 0,duration:s.duration||void 0})})}t.sort((e,s)=>new Date(s.createdAt).getTime()-new Date(e.createdAt).getTime()),c(t)}catch(e){console.error(e),c([])}finally{s(!1)}})()},[]);let h=(0,i.useMemo)(()=>{let e=o.trim().toLowerCase();return e?t.filter(s=>s.title.toLowerCase().includes(e)||(s.kind||"").toLowerCase().includes(e)||(s.space||"").toLowerCase().includes(e)||(s.players||"").toLowerCase().includes(e)):t},[t,o]),p=Math.max(1,Math.ceil(h.length/20)),m=h.slice((u-1)*20,20*u);return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[(0,a.jsxs)("header",{className:"flex items-center justify-between gap-3 flex-wrap",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Ejercicios"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Se listan solo los ejercicios guardados desde las sesiones (bot\xf3n “Guardar y bloquear”)."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{value:o,onChange:e=>{x(1),d(e.target.value)},className:"rounded-xl border px-3 py-1.5 text-sm",placeholder:"Buscar (t\xedtulo, tipo, espacio, jugadores)"}),(0,a.jsxs)("div",{className:"inline-flex rounded-xl border overflow-hidden text-xs",children:[(0,a.jsx)("button",{onClick:()=>x(Math.max(1,u-1)),className:"px-3 py-1.5 hover:bg-gray-50",disabled:u<=1,children:"◀ Anterior"}),(0,a.jsx)("div",{className:"w-px bg-gray-200"}),(0,a.jsx)("button",{onClick:()=>x(Math.min(p,u+1)),className:"px-3 py-1.5 hover:bg-gray-50",disabled:u>=p,children:"Siguiente ▶"})]})]})]}),e?(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Cargando…"}):0===m.length?(0,a.jsxs)("div",{className:"rounded-lg border p-6 text-sm text-gray-600 space-y-2",children:[(0,a.jsx)("div",{children:"No hay ejercicios."}),(0,a.jsxs)("div",{className:"text-gray-500",children:["Tip: entr\xe1 a una sesi\xf3n, carg\xe1 los bloques y toc\xe1"," ",(0,a.jsx)("strong",{children:"“Guardar y bloquear”"}),". Luego volv\xe9 ac\xe1 o actualiz\xe1."]})]}):(0,a.jsx)("ul",{className:"space-y-3",children:m.map(e=>{let s="/ct/sessions/".concat(e.sessionId,"#ex-").concat(e.exIndex);return(0,a.jsxs)("li",{className:"rounded-xl border p-3 shadow-sm bg-white flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-[15px]",children:e.title||e.sessionTitle}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1 space-x-3",children:[(0,a.jsxs)("span",{children:["\uD83D\uDCC5 ",new Date(e.createdAt).toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})]}),e.kind&&(0,a.jsxs)("span",{children:["\uD83C\uDFF7 ",e.kind]}),e.space&&(0,a.jsxs)("span",{children:["\uD83D\uDCCD ",e.space]}),e.players&&(0,a.jsxs)("span",{children:["\uD83D\uDC65 ",e.players]}),e.duration&&(0,a.jsxs)("span",{children:["⏱ ",e.duration]})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("a",{href:s,className:"text-xs px-3 py-1.5 rounded-lg border hover:bg-gray-50",children:"Ver ejercicio"})})]},e.id)})}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[h.length," ejercicios \xb7 p\xe1gina ",u," / ",p]})})]})}}},function(e){e.O(0,[2971,7023,1744],function(){return e(e.s=4260)}),_N_E=e.O()}]);