(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2483],{4576:function(e,t,r){Promise.resolve().then(r.bind(r,9117))},9117:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var n=r(7437),a=r(8059),s=r.n(a),i=r(2265),o=r(6463),l=r(1673);let c=["PRE ENTREN0","F\xcdSICO","T\xc9CNICO–T\xc1CTICO","COMPENSATORIO"],d=e=>"[".concat("DAYFLAG",":").concat(e,"]"),u=e=>"[".concat("MICRO",":").concat(e,"]");function x(e,t,r){return"string"==typeof e.description&&e.description.startsWith("[GRID:".concat(t,":").concat(r,"]"))}function m(){let{ymd:e,turn:t}=(0,o.useParams)(),r=(0,o.useSearchParams)().get("focus")||"",[a,m]=(0,i.useState)(!1),[h,p]=(0,i.useState)([]),[g,f]=(0,i.useState)(""),b='\n    @page { size: A4 portrait; margin: 10mm; }\n    @media print {\n      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }\n      body * { visibility: hidden !important; }\n      .print-root, .print-root * { visibility: visible !important; }\n      .print-root { position: absolute; inset: 0; margin: 0; }\n      .no-print { display: none !important; }\n      a[href]:after { content: ""; }\n    }\n  ',y={"PRE ENTREN0":(0,i.useRef)(null),FÍSICO:(0,i.useRef)(null),"T\xc9CNICO–T\xc1CTICO":(0,i.useRef)(null),COMPENSATORIO:(0,i.useRef)(null)};(0,i.useEffect)(()=>{(async function(){if(e){m(!0);try{var t;let r=new Date("".concat(e,"T00:00:00.000Z")),n=(0,l.$9)(r),a=await (0,l.tO)({start:(0,l.VA)(n)});f(a.weekStart),p((null===(t=a.days)||void 0===t?void 0:t[e])||[])}catch(e){console.error(e),alert("No se pudo cargar la sesi\xf3n.")}finally{m(!1)}}})()},[e]),(0,i.useEffect)(()=>{var e;let t=r||"",n=t&&(null===(e=y[t])||void 0===e?void 0:e.current);n&&n.scrollIntoView({behavior:"smooth",block:"start"})},[r]);let N=(0,i.useMemo)(()=>{let e=e=>{var r;return((null===(r=h.find(r=>x(r,t,e)))||void 0===r?void 0:r.title)||"").trim()},r=e("LUGAR"),n=e("HORA"),a=e("VIDEO"),s=e("NOMBRE SESI\xd3N");return{lugar:r,hora:n,video:function(e){let t=(e||"").trim();if(!t)return{label:"",url:""};let[r,n]=t.split("|").map(e=>e.trim());return!n&&(null==r?void 0:r.startsWith("http"))?{label:"Video",url:r}:{label:r||"",url:n||""}}(a),name:s}},[h,t]),v=(0,i.useMemo)(()=>{let e=h.find(e=>"string"==typeof e.description&&e.description.startsWith(d(t)));return function(e){let t=(e||"").trim();if(!t)return{kind:"NONE"};let[r,n,a]=t.split("|").map(e=>(e||"").trim());return"PARTIDO"===r?{kind:"PARTIDO",rival:n,logoUrl:a}:"LIBRE"===r?{kind:"LIBRE"}:{kind:"NONE"}}(null==e?void 0:e.title)},[h,t]),j=(0,i.useMemo)(()=>{let e=h.find(e=>"string"==typeof e.description&&e.description.startsWith(u(t)));return function(e){let t=(e||"").trim();return new Set(["","MD+1","MD+2","MD-4","MD-3","MD-2","MD-1","MD","DESCANSO"]).has(t)?t:""}(null==e?void 0:e.title)},[h,t]),w=(0,i.useMemo)(()=>c.map(e=>{let r=h.find(r=>x(r,t,e));return{row:e,text:((null==r?void 0:r.title)||"").trim(),id:(null==r?void 0:r.id)||""}}),[h,t]);return(0,n.jsxs)("div",{className:"p-4 space-y-4 print-root",children:[(0,n.jsx)(s(),{id:b.__hash,children:b}),(0,n.jsxs)("header",{className:"flex flex-col gap-1 md:flex-row md:items-center md:justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,n.jsxs)("div",{className:"text-sm text-gray-500",children:[new Date("".concat(e,"T00:00:00.000Z")).toLocaleDateString(void 0,{weekday:"short",day:"2-digit",month:"2-digit",timeZone:"UTC"}),", ","morning"===t?"Ma\xf1ana":"Tarde"]}),(0,n.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded border ".concat(function(e){switch(e){case"MD+1":return"bg-blue-100 text-blue-900 border-blue-200";case"MD+2":return"bg-yellow-100 text-yellow-900 border-yellow-200";case"MD-4":return"bg-red-100 text-red-900 border-red-200";case"MD-3":return"bg-orange-100 text-orange-900 border-orange-200";case"MD-2":return"bg-green-100 text-green-900 border-green-200";case"MD-1":return"bg-gray-100 text-gray-800 border-gray-200";case"MD":return"bg-amber-100 text-amber-900 border-amber-200";case"DESCANSO":return"bg-gray-200 text-gray-800 border-gray-300";default:return"bg-gray-50 text-gray-600 border-gray-200"}}(j)),children:j||"—"}),N.name?(0,n.jsxs)("span",{className:"text-sm text-gray-700",children:["\xb7 ",(0,n.jsx)("b",{children:N.name})]}):null]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 no-print",children:[(0,n.jsx)("a",{href:"/ct/dashboard",className:"px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"← Dashboard"}),(0,n.jsx)("a",{href:"/ct/plan-semanal",className:"px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"✏️ Editor"}),(0,n.jsx)("button",{onClick:()=>window.print(),className:"px-3 py-1.5 rounded-xl border text-xs hover:bg-gray-50",children:"\uD83D\uDDA8 Imprimir"})]})]}),(0,n.jsxs)("section",{className:"rounded-2xl border bg-white shadow-sm overflow-hidden",children:[(0,n.jsx)("div",{className:"bg-emerald-50 text-emerald-900 font-semibold px-3 py-2 border-b uppercase tracking-wide text-[12px]",children:"Detalles"}),(0,n.jsxs)("div",{className:"grid md:grid-cols-4 gap-2 p-3 text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-[11px] text-gray-500",children:"Nombre de sesi\xf3n"}),(0,n.jsx)("div",{className:"font-medium",children:N.name||(0,n.jsx)("span",{className:"text-gray-400",children:"—"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-[11px] text-gray-500",children:"Lugar"}),(0,n.jsx)("div",{className:"font-medium",children:N.lugar||(0,n.jsx)("span",{className:"text-gray-400",children:"—"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-[11px] text-gray-500",children:"Hora"}),(0,n.jsx)("div",{className:"font-medium",children:N.hora||(0,n.jsx)("span",{className:"text-gray-400",children:"—"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-[11px] text-gray-500",children:"Video"}),N.video.url?(0,n.jsx)("a",{href:N.video.url,target:"_blank",rel:"noreferrer",title:N.video.label||"Video",className:"underline text-emerald-700",children:N.video.label||"Video"}):(0,n.jsx)("span",{className:"text-gray-400",children:"—"})]}),"PARTIDO"===v.kind&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"md:col-span-2",children:[(0,n.jsx)("div",{className:"text-[11px] text-gray-500",children:"Rival"}),(0,n.jsx)("div",{className:"font-medium",children:v.rival||(0,n.jsx)("span",{className:"text-gray-400",children:"—"})})]}),(0,n.jsxs)("div",{className:"md:col-span-2",children:[(0,n.jsx)("div",{className:"text-[11px] text-gray-500",children:"Logo"}),v.logoUrl?(0,n.jsx)("img",{src:v.logoUrl,alt:"Logo rival",className:"h-10 w-auto object-contain rounded border bg-white"}):(0,n.jsx)("span",{className:"text-gray-400",children:"—"})]})]})]})]}),"LIBRE"===v.kind?(0,n.jsx)("div",{className:"rounded-2xl border bg-white shadow-sm p-10 text-center text-gray-700 font-semibold",children:"DESCANSO"}):(0,n.jsx)("section",{className:"space-y-3",children:w.map(e=>{let{row:t,text:r,id:a}=e;return(0,n.jsxs)("div",{ref:y[t],className:"rounded-2xl border bg-white shadow-sm p-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsx)("h2",{className:"text-sm font-semibold uppercase tracking-wide text-gray-700",children:t}),a?(0,n.jsx)("a",{href:"/ct/sessions/".concat(a),title:"Ver ejercicios de este bloque",className:"text-[11px] rounded-lg border px-2 py-0.5 hover:bg-gray-50 no-print",children:"Ver ejercicios"}):null]}),(0,n.jsx)("div",{className:"min-h-[120px] whitespace-pre-wrap leading-6 text-[13px]",children:r||(0,n.jsx)("span",{className:"text-gray-400 italic",children:"—"})})]},t)})})]})}},1673:function(e,t,r){"use strict";function n(e){let t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),n=String(e.getUTCDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(n)}function a(e){let t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())),r=t.getUTCDay()||7;return 1!==r&&t.setUTCDate(t.getUTCDate()-(r-1)),t.setUTCHours(0,0,0,0),t}async function s(e){let{start:t}=e,r=await fetch("/api/sessions?start=".concat(encodeURIComponent(t)),{cache:"no-store"}),n=await r.json();if(!r.ok)throw Error((null==n?void 0:n.error)||"No se pudo cargar la semana");return n}async function i(e){let t=await fetch("/api/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw Error((null==r?void 0:r.error)||"Error al crear la sesi\xf3n");return r}async function o(e,t){let r=await fetch("/api/sessions/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw Error((null==n?void 0:n.error)||"Error al actualizar la sesi\xf3n");return n}async function l(e){let t=await fetch("/api/sessions/".concat(e),{method:"DELETE"}),r=await t.json();if(!t.ok)throw Error((null==r?void 0:r.error)||"Error al borrar la sesi\xf3n");return r}async function c(e){let t=await fetch("/api/sessions/".concat(e),{cache:"no-store"}),r=await t.json();if(!t.ok)throw Error((null==r?void 0:r.error)||"Sesi\xf3n no encontrada");return r}r.d(t,{$9:function(){return a},CT:function(){return o},SO:function(){return l},VA:function(){return n},ed:function(){return i},tO:function(){return s},y4:function(){return c}})}},function(e){e.O(0,[8931,2971,7023,1744],function(){return e(e.s=4576)}),_N_E=e.O()}]);