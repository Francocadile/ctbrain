(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2795],{9052:function(e,t,a){Promise.resolve().then(a.bind(a,3361))},3361:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y},dynamic:function(){return c}});var r=a(7437),s=a(2265),l=a(6463),n=a(97),i=a(939),d=a(5058),o=a(6163);let c="force-dynamic";function u(e){return e.toISOString().slice(0,10)}function x(e,t){let a=new Date(e);return a.setDate(a.getDate()+t),a}function m(e){let t=new Date(e),a=t.getDay();return x(t,0===a?-6:1-a)}function p(e){let{children:t,tone:a}=e;return(0,r.jsx)("span",{className:"inline-flex rounded-md border px-2 py-0.5 text-xs font-semibold ".concat({green:"bg-emerald-50 text-emerald-700 border-emerald-200",yellow:"bg-amber-50 text-amber-700 border-amber-200",red:"bg-red-50 text-red-700 border-red-200",gray:"bg-gray-100 text-gray-700 border-gray-200"}[a]),children:t})}function h(e){return null!=e&&isFinite(e)?e<.8||e>1.5?"red":e<=1.3?"green":"yellow":"gray"}function g(){let e=(0,l.useSearchParams)().get("tab")||"dia",[t,a]=(0,s.useState)(e),[c,g]=(0,s.useState)(u(new Date)),[y,j]=(0,s.useState)([]),[b,N]=(0,s.useState)(!0),[f,v]=(0,s.useState)(""),[w,A]=(0,s.useState)("90"),[S,C]=(0,s.useState)(!1),[E,R]=(0,s.useState)({}),[U,P]=(0,s.useState)(7),[k,M]=(0,s.useState)(!1),[L,_]=(0,s.useState)([]),[J,D]=(0,s.useState)([0,0,0,0,0]),[O,F]=(0,s.useState)(!1),[Z,I]=(0,s.useState)(null),[T,V]=(0,s.useState)(!1),[K,B]=(0,s.useState)([]),[W,q]=(0,s.useState)([]),z=i.Z;async function X(){N(!0);try{let a=await fetch("/api/metrics/rpe?date=".concat(c),{cache:"no-store"}),r=a.ok?await a.json():[],s=(Array.isArray(r)?r:[]).map(e=>{var t,a;return{...e,userName:e.userName||e.playerKey||(null===(t=e.user)||void 0===t?void 0:t.name)||(null===(a=e.user)||void 0===a?void 0:a.email)||"Jugador"}});j(s);let l=await fetch("/api/injuries?date=".concat(c),{cache:"no-store"});if(l.ok){let a=await l.json(),r={};for(let s of Array.isArray(a)?a:[]){var e,t;let a=s.userName||(null===(e=s.user)||void 0===e?void 0:e.name)||(null===(t=s.user)||void 0===t?void 0:t.email)||"—";r[a]={userId:s.userId,userName:a,status:s.status}}R(r)}else R({})}finally{N(!1)}}(0,s.useEffect)(()=>{X()},[c]);let H=(0,s.useMemo)(()=>{let e=f.trim().toLowerCase();return e?y.filter(t=>(t.userName||"").toLowerCase().includes(e)||(t.playerKey||"").toLowerCase().includes(e)):y},[y,f]),G=(0,s.useMemo)(()=>H.slice().sort((e,t)=>(0,d.uC)(t)-(0,d.uC)(e)),[H]);async function Q(){let e=Math.max(0,Number(w||0));if(!e)return alert("Ingres\xe1 minutos > 0");C(!0);try{let t=await fetch("/api/metrics/rpe/default-duration",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:c,duration:e})});if(!t.ok)throw Error(await t.text());await X()}catch(e){alert((null==e?void 0:e.message)||"Error aplicando duraci\xf3n")}finally{C(!1)}}async function Y(){if(confirm("\xbfPoner en blanco la duraci\xf3n del ".concat(c,"?"))){C(!0);try{let e=await fetch("/api/metrics/rpe/clear-duration",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:c})});if(!e.ok)throw Error(await e.text());await X()}catch(e){alert((null==e?void 0:e.message)||"Error limpiando duraciones")}finally{C(!1)}}}async function $(e,t){let a=""===t?null:Math.max(0,Number(t));C(!0);try{let t=await fetch("/api/metrics/rpe/".concat(e.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({duration:a})});if(!t.ok)throw Error(await t.text());await X()}catch(e){alert((null==e?void 0:e.message)||"Error guardando fila")}finally{C(!1)}}let ee=(0,s.useMemo)(()=>{let e=y.length,t=y.filter(e=>null!=e.rpe&&Number(e.rpe)>=0).length,a=y.filter(e=>null!=e.duration&&Number(e.duration)>0).length,r=e?(0,d.J6)(y.map(e=>Number(e.rpe||0))):0,s=y.map(e=>(0,d.uC)(e)).filter(e=>!Number.isNaN(e)).reduce((e,t)=>e+t,0),l=0,n=0,i=0;for(let e of y){let t=Number(e.rpe||0);t<=3?l++:t<=6?n++:i++}return{n:e,withRpe:t,withDur:a,withRpePct:e?Math.round(t/e*100):0,withDurPct:e?Math.round(a/e*100):0,rpeAvg:r,totalSRPE:s,distRPE:{low:l,mid:n,high:i}}},[y]);async function et(e){let t=await fetch("/api/metrics/wellness?date=".concat(e),{cache:"no-store"});if(!t.ok)return[];let a=await t.json();return Array.isArray(a)?a:[]}async function ea(e){I(e),F(!0),V(!0);try{let d=Array.from({length:8},(e,t)=>(0,o.Op)((0,o.E4)((0,o.lN)(c),-(0===t?0:t)))),m=await Promise.all(d.map(e=>et(e))),p=[];for(let t=0;t<d.length;t++){let a=(m[t]||[]).find(t=>{var a,r;return(t.userName||(null===(a=t.user)||void 0===a?void 0:a.name)||(null===(r=t.user)||void 0===r?void 0:r.email)||t.playerKey||"—")===e});p.push(a?Number((0,o.bq)(a).toFixed(2)):0)}B(p);let h=Array.from({length:7},(e,t)=>u(x(function(e){let[t,a,r]=e.split("-").map(Number);return new Date(t,a-1,r)}(c),-t))),g=await Promise.all(h.map(e=>fetch("/api/metrics/rpe?date=".concat(e),{cache:"no-store"}))),y=await Promise.all(g.map(e=>e.ok?e.json():[])),j=[];for(let d=0;d<h.length;d++)for(let o of Array.isArray(y[d])?y[d]:[]){var t,a,r,s,l,n,i;if((o.userName||o.playerKey||(null===(t=o.user)||void 0===t?void 0:t.name)||(null===(a=o.user)||void 0===a?void 0:a.email)||"Jugador")===e){let e=null!==(i=null!==(n=null!==(r=o.load)&&void 0!==r?r:o.srpe)&&void 0!==n?n:Number(null!==(s=o.rpe)&&void 0!==s?s:0)*Number(null!==(l=o.duration)&&void 0!==l?l:0))&&void 0!==i?i:0;j.push({date:h[d],au:Number(e)});break}}q(j)}finally{V(!1)}}let[er,es]=(0,s.useState)(()=>m(new Date)),[el,en]=(0,s.useState)(!1),[ei,ed]=(0,s.useState)([]),[eo,ec]=(0,s.useState)([]),[eu,ex]=(0,s.useState)(""),[em,ep]=(0,s.useState)([]);async function eh(e){let t=await fetch("/api/metrics/rpe?date=".concat(e),{cache:"no-store"});if(!t.ok)return[];let a=await t.json();return Array.isArray(a)?a:[]}function eg(e){var t,a;return e.userName||e.playerKey||(null===(t=e.user)||void 0===t?void 0:t.name)||(null===(a=e.user)||void 0===a?void 0:a.email)||"Jugador"}function ey(e){var t,a,r,s,l;return Math.max(0,Math.round(Number(null!==(l=null!==(s=null!==(t=e.load)&&void 0!==t?t:e.srpe)&&void 0!==s?s:Number(null!==(a=e.rpe)&&void 0!==a?a:0)*Number(null!==(r=e.duration)&&void 0!==r?r:0))&&void 0!==l?l:0)))}async function ej(){en(!0);try{let a=await Promise.all(ei.map(e=>eh(e))),r={};a.forEach((e,t)=>{for(let a of e){let e=eg(a);r[e]||(r[e]=Array(7).fill(0)),r[e][t]+=ey(a)}});let s=await Promise.all(eo.map(e=>eh(e))),l={};s.forEach(e=>{let t={};for(let r of e){var a;let e=eg(r);t[e]=(null!==(a=t[e])&&void 0!==a?a:0)+ey(r)}for(let[e,a]of Object.entries(t))l[e]||(l[e]=[]),l[e].push(a)});let n=new Set([...Object.keys(r),...Object.keys(l)]),i=[];for(let a of n){var e,t;let s=(null!==(e=r[a])&&void 0!==e?e:Array(7).fill(0)).map(e=>Math.max(0,Math.round(e))),n=s.reduce((e,t)=>e+t,0),o=null!==(t=l[a])&&void 0!==t?t:[],c=o.length?7*(0,d.J6)(o):0,u=c>0?n/c:null,x=(0,d.J6)(s),m=function(e){let t=e.length;if(t<2)return 0;let a=(0,d.J6)(e),r=e.reduce((e,t)=>e+(t-a)*(t-a),0)/(t-1);return Math.sqrt(r)}(s),p=m>0?x/m:null,h=null!=p?n*p:null;i.push({userName:a,daysAU:s,totalAU:n,acute7:n,chronic28:c,acwr:u,mean:x,sd:m,monotony:p,strain:h})}i.sort((e,t)=>{let a=e=>{let t=h(e.acwr);return"red"===t?0:"yellow"===t?1:"green"===t?2:3},r=a(e)-a(t);return 0!==r?r:t.totalAU-e.totalAU}),ep(i)}finally{en(!1)}}function eb(e){es(t=>x(t,7*e))}(0,s.useEffect)(()=>{ed(Array.from({length:7},(e,t)=>u(x(er,t))));let e=x(er,-28);ec(Array.from({length:28},(t,a)=>u(x(e,a))))},[er]),(0,s.useEffect)(()=>{"semana"===t&&7===ei.length&&28===eo.length&&ej()},[t,ei.join(","),eo.join(",")]);let eN=(0,s.useMemo)(()=>{let e=eu.trim().toLowerCase();return e?em.filter(t=>t.userName.toLowerCase().includes(e)):em},[em,eu]),ef=(0,s.useMemo)(()=>{if(!eN.length)return{players:0,totalAU:0,avgAU:0};let e=eN.reduce((e,t)=>e+t.totalAU,0),t=e/eN.length;return{players:eN.length,totalAU:e,avgAU:t}},[eN]);return(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)("header",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-lg font-bold",children:["RPE (CT)"," ",(0,r.jsx)(n.Z,{text:"RPE 0–10 respondido 30' post-sesi\xf3n. El CT define la duraci\xf3n; sRPE = RPE\xd7min. Semana calcula ACWR, Monoton\xeda y Strain."})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Vista unificada D\xeda/Semana/Reportes • sRPE = RPE \xd7 minutos"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["dia"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"date",className:"rounded-md border px-2 py-1.5 text-sm",value:c,onChange:e=>g(e.target.value)}),(0,r.jsx)("button",{onClick:X,className:"rounded-lg border px-2 py-1 text-sm hover:bg-gray-50",children:"Recargar"}),(0,r.jsx)("button",{onClick:function(){let e=["Jugador,Fecha,Sesi\xf3n,RPE,Minutos,sRPE_AU,Falta_RPE,Faltan_Minutos"];for(let l of G){var t,a,r,s;let n=(l.userName||l.playerKey||"Jugador").replace(/"/g,'""'),i=(0,d.uC)(l),o=null!==(a=l.sessionLabel)&&void 0!==a?a:null!=l.sessionIndex?"Sesi\xf3n ".concat(l.sessionIndex):null!==(t=l.sessionId)&&void 0!==t?t:"",c=null==l.rpe||Number.isNaN(Number(l.rpe)),u=null==l.duration||0>=Number(l.duration);e.push(['"'.concat(n,'"'),l.date,'"'.concat((null!=o?o:"").toString().replace(/"/g,'""'),'"'),null!==(r=l.rpe)&&void 0!==r?r:"",null!==(s=l.duration)&&void 0!==s?s:"",i?Math.round(i):"",c?"1":"0",u?"1":"0"].join(","))}let l=new Blob([e.join("\n")],{type:"text/csv;charset=utf-8"}),n=URL.createObjectURL(l),i=document.createElement("a");i.href=n,i.download="rpe_dia_".concat(c,".csv"),i.click(),URL.revokeObjectURL(n)},className:"rounded-lg bg-black text-white px-3 py-1.5 text-sm hover:opacity-90",children:"Exportar CSV"})]}),"semana"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>eb(-1),className:"rounded-lg border px-2 py-1 text-sm hover:bg-gray-50",children:"← Semana anterior"}),(0,r.jsx)("input",{type:"date",className:"rounded-md border px-2 py-1.5 text-sm",value:u(er),onChange:e=>{es(m(new Date(e.target.value)))}}),(0,r.jsx)("button",{onClick:()=>eb(1),className:"rounded-lg border px-2 py-1 text-sm hover:bg-gray-50",children:"Semana siguiente →"}),(0,r.jsx)("button",{onClick:function(){let e=[["Jugador","Lunes_AU","Martes_AU","Miercoles_AU","Jueves_AU","Viernes_AU","Sabado_AU","Domingo_AU","AU_total_semana","Agudo_7d","Cronico_28d","ACWR","Monotonia","Strain","Semana (".concat(u(er)," a ").concat(u(x(er,6)),")")].join(",")];for(let t of eN)e.push(['"'.concat(t.userName.replace(/"/g,'""'),'"'),...t.daysAU.map(e=>String(e)),t.totalAU,t.acute7,t.chronic28.toFixed(1),null==t.acwr?"":t.acwr.toFixed(2),null==t.monotony?"":t.monotony.toFixed(2),null==t.strain?"":Math.round(t.strain),""].join(","));let t=new Blob([e.join("\n")],{type:"text/csv;charset=utf-8"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download="rpe_semana_".concat(u(er),".csv"),r.click(),URL.revokeObjectURL(a)},className:"rounded-lg bg-black text-white px-3 py-1.5 text-sm hover:opacity-90",children:"Exportar CSV"})]})]})]}),(0,r.jsx)("nav",{className:"rounded-xl border bg-white p-1 flex gap-1",children:[{key:"dia",label:"D\xeda"},{key:"semana",label:"Semana"},{key:"reportes",label:"Reportes"}].map(e=>{let s=t===e.key;return(0,r.jsx)("button",{onClick:()=>(function(e){a(e);let t=new URL(window.location.href);t.searchParams.set("tab",e),window.history.replaceState(null,"",t.toString())})(e.key),className:"flex-1 rounded-lg px-3 py-2 text-sm font-medium transition ".concat(s?"bg-black text-white":"hover:bg-gray-50"),children:e.label},e.key)})}),"dia"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("section",{className:"rounded-xl border bg-white p-3 flex flex-wrap items-center gap-2",children:[(0,r.jsxs)("div",{className:"text-sm font-medium mr-2",children:["Acciones:"," ",(0,r.jsx)(n.Z,{text:"“Aplicar a vac\xedos” asigna X minutos a filas sin duraci\xf3n. “Limpiar” borra las duraciones del d\xeda."})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{className:"w-20 rounded-md border px-2 py-1 text-sm",placeholder:"min",value:w,onChange:e=>A(e.target.value),inputMode:"numeric"}),(0,r.jsx)("button",{onClick:Q,disabled:S,className:"rounded-lg px-3 py-1.5 text-xs ".concat(S?"bg-gray-200 text-gray-500":"bg-black text-white hover:opacity-90"),children:"Aplicar a vac\xedos"})]}),(0,r.jsx)("div",{className:"h-5 w-px bg-gray-300 mx-1"}),(0,r.jsx)("button",{onClick:Y,disabled:S,className:"rounded-lg border px-3 py-1.5 text-xs hover:bg-gray-50",children:"Limpiar minutos del d\xeda"}),(0,r.jsxs)("div",{className:"ml-auto text-xs text-gray-500",children:["sRPE = RPE \xd7 minutos"," ",(0,r.jsx)(n.Z,{text:"La AU se recalcula al guardar. Si la duraci\xf3n est\xe1 vac\xeda, no hay AU."})]})]}),(0,r.jsx)("section",{className:"rounded-2xl border bg-white px-4 py-3",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3",children:[(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[(0,r.jsx)("div",{className:"text-[11px] uppercase text-gray-500",children:"Respondieron hoy"}),(0,r.jsx)("div",{className:"mt-1 text-2xl font-bold",children:ee.n})]}),(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[(0,r.jsx)("div",{className:"text-[11px] uppercase text-gray-500",children:"Con RPE"}),(0,r.jsxs)("div",{className:"mt-1 text-2xl font-bold",children:[ee.withRpe," ",(0,r.jsxs)("span",{className:"text-sm font-semibold text-gray-500",children:["(",ee.withRpePct,"%)"]})]})]}),(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[(0,r.jsx)("div",{className:"text-[11px] uppercase text-gray-500",children:"Con minutos"}),(0,r.jsxs)("div",{className:"mt-1 text-2xl font-bold",children:[ee.withDur," ",(0,r.jsxs)("span",{className:"text-sm font-semibold text-gray-500",children:["(",ee.withDurPct,"%)"]})]})]}),(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[(0,r.jsx)("div",{className:"text-[11px] uppercase text-gray-500",children:"RPE promedio"}),(0,r.jsx)("div",{className:"mt-1 text-2xl font-bold",children:ee.rpeAvg?ee.rpeAvg.toFixed(2):"—"})]}),(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[(0,r.jsx)("div",{className:"text-[11px] uppercase text-gray-500",children:"sRPE total (AU)"}),(0,r.jsx)("div",{className:"mt-1 text-2xl font-bold",children:ee.totalSRPE?Math.round(ee.totalSRPE):"—"})]}),(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[(0,r.jsx)("div",{className:"text-[11px] uppercase text-gray-500",children:"Distribuci\xf3n RPE (0–3 / 4–6 / 7–10)"}),(0,r.jsxs)("div",{className:"mt-1 text-sm font-semibold",children:[ee.distRPE.low," / ",ee.distRPE.mid," / ",ee.distRPE.high]})]})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{className:"w-full md:w-80 rounded-md border px-2 py-1.5 text-sm",placeholder:"Buscar jugador…",value:f,onChange:e=>v(e.target.value)}),(0,r.jsxs)("span",{className:"text-[12px] text-gray-500",children:[G.length," resultado(s)"]})]}),(0,r.jsxs)("section",{className:"rounded-2xl border bg-white overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-gray-50 px-3 py-2 text-[12px] font-semibold uppercase",children:"Entradas"}),b?(0,r.jsx)("div",{className:"p-4 text-gray-500",children:"Cargando…"}):0===G.length?(0,r.jsx)("div",{className:"p-4 text-gray-500 italic",children:"Sin datos"}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b bg-gray-50",children:[(0,r.jsx)("th",{className:"text-left px-3 py-2",children:"Jugador"}),(0,r.jsx)("th",{className:"text-left px-3 py-2",children:"Sesi\xf3n"}),(0,r.jsxs)("th",{className:"text-left px-3 py-2",children:["RPE ",(0,r.jsx)(n.Z,{text:"Esfuerzo percibido (0–10). 0=descanso, 10=m\xe1ximo."})]}),(0,r.jsxs)("th",{className:"text-left px-3 py-2",children:["Duraci\xf3n (min) ",(0,r.jsx)(n.Z,{text:"Minutos definidos por el CT. Editables por fila."})]}),(0,r.jsxs)("th",{className:"text-left px-3 py-2",children:["sRPE (AU) ",(0,r.jsx)(n.Z,{text:"RPE \xd7 minutos. Se actualiza al guardar cambios."})]}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"Acciones"})]})}),(0,r.jsx)("tbody",{children:G.map(e=>{var t,a,s,l,n;let i=e.userName||e.playerKey||"Jugador",d=E[i]||null,o=null==e.rpe||Number.isNaN(Number(e.rpe)),c=null==e.duration||0>=Number(e.duration),u=null!==(a=e.sessionLabel)&&void 0!==a?a:null!=e.sessionIndex?"Sesi\xf3n ".concat(e.sessionIndex):null!==(t=e.sessionId)&&void 0!==t?t:"";return(0,r.jsxs)("tr",{className:"border-b last:border-0",children:[(0,r.jsxs)("td",{className:"px-3 py-2 font-medium",children:[i," ",d&&(0,r.jsx)("span",{className:"ml-1 inline-flex rounded-md border px-2 py-0.5 text-[11px] font-semibold bg-gray-100 text-gray-600 border-gray-200",children:"LESIONADO"}),(o||c)&&(0,r.jsxs)("span",{className:"ml-2",children:[o&&(0,r.jsx)(p,{tone:"red",children:"Falta RPE"})," ",c&&(0,r.jsx)(p,{tone:"yellow",children:"Faltan minutos"})]})]}),(0,r.jsx)("td",{className:"px-3 py-2 text-xs text-gray-600",children:u||"—"}),(0,r.jsx)("td",{className:"px-3 py-2",children:null!==(s=e.rpe)&&void 0!==s?s:"—"}),(0,r.jsx)("td",{className:"px-3 py-2",children:(0,r.jsx)("input",{className:"w-24 rounded-md border px-2 py-1 text-sm",defaultValue:null!==(l=e.duration)&&void 0!==l?l:"",onBlur:t=>$(e,t.currentTarget.value),placeholder:"min",inputMode:"numeric"})}),(0,r.jsx)("td",{className:"px-3 py-2",children:(null!==(n=e.load)&&void 0!==n?n:null)!==null?Math.round(Number(e.load)):"—"}),(0,r.jsx)("td",{className:"px-3 py-2",children:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>ea(i),className:"rounded-lg border px-2 py-1 text-[11px] hover:bg-gray-50",children:"Ver"}),(0,r.jsx)("button",{onClick:()=>$(e,""),className:"rounded-lg border px-2 py-1 text-[11px] hover:bg-gray-50",children:"Vaciar"})]})})]},e.id)})})]})})]})]}),"semana"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"rounded-xl border bg-white p-3 text-xs text-gray-600 flex flex-wrap gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("b",{children:"AU total (promedio/jugador)"})," ",(0,r.jsx)(n.Z,{text:"Suma de AU de todos los jugadores en la semana / jugadores listados."}),":"," ",Math.round(ef.totalAU)," AU ",(0,r.jsx)("span",{className:"text-gray-400",children:"/"})," ",Math.round(ef.avgAU)," AU"]}),(0,r.jsxs)("div",{className:"ml-auto text-gray-500",children:["Jugadores: ",(0,r.jsx)("b",{children:ef.players})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{className:"w-full md:w-80 rounded-md border px-2 py-1.5 text-sm",placeholder:"Buscar jugador…",value:eu,onChange:e=>ex(e.target.value)}),(0,r.jsxs)("span",{className:"text-[12px] text-gray-500",children:[eN.length," resultado(s)"]})]}),(0,r.jsxs)("section",{className:"rounded-2xl border bg-white overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-gray-50 px-3 py-2 text-[12px] font-semibold uppercase",children:["AU por d\xeda y m\xe9tricas"," ",(0,r.jsx)(n.Z,{text:"AU diario por jugador (L..D) y m\xe9tricas semanales de carga y riesgo."})]}),el?(0,r.jsx)("div",{className:"p-4 text-gray-500",children:"Cargando…"}):0===eN.length?(0,r.jsx)("div",{className:"p-4 text-gray-500 italic",children:"Sin datos"}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b bg-gray-50",children:[(0,r.jsx)("th",{className:"text-left px-3 py-2",children:"Jugador"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"L"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"M"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"X"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"J"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"V"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"S"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"D"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"AU total"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"Agudo (7d)"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"Cr\xf3nico (28d)"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"ACWR"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"Monoton\xeda"}),(0,r.jsx)("th",{className:"text-right px-3 py-2",children:"Strain"})]})}),(0,r.jsx)("tbody",{children:eN.map(e=>{var t;let a=h(e.acwr),s=(t=e.totalAU)<1500?"yellow":t>4500?"red":"green";return(0,r.jsxs)("tr",{className:"border-b last:border-0",children:[(0,r.jsx)("td",{className:"px-3 py-2 font-medium",children:e.userName}),e.daysAU.map((e,t)=>(0,r.jsx)("td",{className:"px-3 py-2 text-right tabular-nums",children:e||"—"},t)),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:(0,r.jsxs)(p,{tone:s,children:[Math.round(e.totalAU)," AU"]})}),(0,r.jsxs)("td",{className:"px-3 py-2 text-right",children:[Math.round(e.acute7)," AU"]}),(0,r.jsxs)("td",{className:"px-3 py-2 text-right",children:[e.chronic28.toFixed(1)," AU"]}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:(0,r.jsx)(p,{tone:a,children:null==e.acwr?"—":e.acwr.toFixed(2)})}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:null==e.monotony?"—":e.monotony.toFixed(2)}),(0,r.jsx)("td",{className:"px-3 py-2 text-right",children:null==e.strain?"—":Math.round(e.strain)})]},e.userName)})})]})})]}),(0,r.jsxs)("div",{className:"rounded-xl border bg-white p-3 text-xs text-gray-600",children:[(0,r.jsx)("b",{children:"ACWR:"})," objetivo 0.8–1.3 ",(0,r.jsx)(p,{tone:"green",children:"OK"}),", 1.3–1.5 ",(0,r.jsx)(p,{tone:"yellow",children:"Atenci\xf3n"}),", <0.8 o >1.5 ",(0,r.jsx)(p,{tone:"red",children:"Riesgo"}),"."," ",(0,r.jsx)(n.Z,{text:"Us\xe1 ACWR para ajustar carga: valores extremos sugieren subir o bajar volumen/intensidad."}),(0,r.jsx)("br",{}),(0,r.jsx)("b",{children:"AU semanal:"})," <1500 subcarga, >4500 sobrecarga (ajustable)."," ",(0,r.jsx)(n.Z,{text:"Umbrales de referencia para detectar semanas muy livianas o pesadas."})]})]}),"reportes"===t&&(0,r.jsxs)("section",{className:"rounded-2xl border bg-white p-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-[12px] font-semibold uppercase",children:["Reportes individuales",(0,r.jsx)(n.Z,{text:"MVP: listado por jugador con sRPE del d\xeda. Luego link al Perfil de Jugador."})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[y.length," jugador(es)"]})]}),b?(0,r.jsx)("div",{className:"p-3 text-gray-500",children:"Cargando…"}):0===y.length?(0,r.jsx)("div",{className:"p-3 text-gray-500 italic",children:"Sin datos hoy"}):(0,r.jsx)("ul",{className:"mt-2 grid md:grid-cols-2 lg:gridCols-3 gap-2",children:y.slice().sort((e,t)=>(e.userName||"").localeCompare(t.userName||"")||(0,d.uC)(t)-(0,d.uC)(e)).map(e=>{var t,a;let s=(0,d.uC)(e),l=e.userName||e.playerKey||"Jugador";return(0,r.jsxs)("li",{className:"rounded-lg border p-3",children:[(0,r.jsx)("div",{className:"font-medium",children:l}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["RPE: ",(0,r.jsx)("b",{children:null!==(t=e.rpe)&&void 0!==t?t:"—"})," • Min: ",(0,r.jsx)("b",{children:null!==(a=e.duration)&&void 0!==a?a:"—"})," • sRPE: ",(0,r.jsxs)("b",{children:[s?Math.round(s):"—"," AU"]})]}),(0,r.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>ea(l),className:"rounded-lg border px-2 py-1 text-xs hover:bg-gray-50",children:"Ver"}),(0,r.jsx)("button",{disabled:!0,className:"rounded-lg border px-2 py-1 text-xs text-gray-400 cursor-not-allowed",title:"Pr\xf3ximamente",children:"Abrir perfil"})]})]},e.id)})})]}),Z&&(0,r.jsx)(z,{open:O,onClose:()=>F(!1),loading:T,playerName:Z,date:c,sdw7:K,rpeRecent:W})]})}function y(){return(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{className:"p-4 text-gray-500",children:"Cargando…"}),children:(0,r.jsx)(g,{})})}}},function(e){e.O(0,[1337,2971,7023,1744],function(){return e(e.s=9052)}),_N_E=e.O()}]);