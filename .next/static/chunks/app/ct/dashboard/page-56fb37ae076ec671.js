(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6629],{8606:function(e,t,r){Promise.resolve().then(r.bind(r,3044))},3044:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var n=r(7437),a=r(8059),i=r.n(a),s=r(2265),o=r(6463),c=r(1673),l=r(4875);let d=["PRE ENTREN0","F\xcdSICO","T\xc9CNICO–T\xc1CTICO","COMPENSATORIO"],x=["NOMBRE SESI\xd3N","LUGAR","HORA","VIDEO"],u=e=>"[".concat("DAYFLAG",":").concat(e,"]"),m=(e,t)=>"string"==typeof e.description&&e.description.startsWith(u(t)),p=e=>"[".concat("MICRO",":").concat(e,"]"),b=(e,t)=>"string"==typeof e.description&&e.description.startsWith(p(t)),f={"":{bg:"bg-gray-50",text:"text-gray-500",border:"border-gray-200"},"MD+1":{bg:"bg-blue-50",text:"text-blue-900",border:"border-blue-200"},"MD+2":{bg:"bg-yellow-50",text:"text-yellow-900",border:"border-yellow-200"},"MD-4":{bg:"bg-red-50",text:"text-red-900",border:"border-red-200"},"MD-3":{bg:"bg-orange-50",text:"text-orange-900",border:"border-orange-200"},"MD-2":{bg:"bg-green-50",text:"text-green-900",border:"border-green-200"},"MD-1":{bg:"bg-gray-50",text:"text-gray-700",border:"border-gray-200"},MD:{bg:"bg-amber-50",text:"text-amber-900",border:"border-amber-200"},DESCANSO:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-200"}};function g(e,t){let r=new Date(e);return r.setUTCDate(r.getUTCDate()+t),r}function h(){let e=(0,o.useSearchParams)(),t="1"===e.get("hideHeader"),r="afternoon"===e.get("turn")?"afternoon":"morning",[a,u]=(0,s.useState)(r),[p,h]=(0,s.useState)(()=>(0,c.$9)(new Date)),[j,y]=(0,s.useState)(!1),[v,w]=(0,s.useState)({}),[N,D]=(0,s.useState)(""),[C,k]=(0,s.useState)(""),[T,S]=(0,s.useState)({}),E=e=>T[e]||e;async function O(){try{let e=await fetch("/api/planner/labels",{cache:"no-store"}),t=await e.json();S((null==t?void 0:t.rowLabels)||{})}catch(e){S({})}}async function R(e){y(!0);try{let t=(0,c.$9)(e),r=(0,c.VA)(t),n=await (0,c.tO)({start:r});w(n.days),D(n.weekStart),k(n.weekEnd)}finally{y(!1)}}(0,s.useEffect)(()=>{O();let e=()=>O();return window.addEventListener("planner-row-labels-updated",e),()=>window.removeEventListener("planner-row-labels-updated",e)},[]),(0,s.useEffect)(()=>{R(p)},[p]);let I=(0,s.useMemo)(()=>{if(!N)return[];let e=new Date("".concat(N,"T00:00:00.000Z"));return Array.from({length:7},(t,r)=>(0,c.VA)(g(e,r)))},[N]);function A(e,t,r){return(v[e]||[]).find(e=>"string"==typeof e.description&&e.description.startsWith("[GRID:".concat(t,":").concat(r,"]")))}function U(e){let{ymd:t,row:r}=e,i=A(t,a,r),s=((null==i?void 0:i.title)||"").trim();if(!s)return(0,n.jsx)("div",{className:"h-6 text-[11px] text-gray-400 italic px-1 flex items-center",children:"—"});if("VIDEO"===r){let{label:e,url:t}=function(e){let t=(e||"").trim();if(!t)return{label:"",url:""};let[r,n]=t.split("|").map(e=>e.trim());return!n&&(null==r?void 0:r.startsWith("http"))?{label:"Video",url:r}:{label:r||"",url:n||""}}(s);return t?(0,n.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",className:"h-6 text-[11px] underline text-emerald-700 px-1 flex items-center truncate",children:e||"Video"}):(0,n.jsx)("div",{className:"h-6 text-[11px] px-1 flex items-center truncate",children:e})}return(0,n.jsx)("div",{className:"h-6 text-[11px] px-1 flex items-center truncate",children:s})}function M(e){let{ymd:t}=e,r=function(e,t){let r=(v[e]||[]).find(e=>b(e,t)),n=((null==r?void 0:r.title)||"").trim();return["MD+1","MD+2","MD-4","MD-3","MD-2","MD-1","MD","DESCANSO",""].includes(n)?n:""}(t,a);if(!r)return null;let i=f[r];return(0,n.jsx)("span",{className:"inline-flex items-center h-[18px] px-1.5 rounded-md border text-[9px] font-semibold ".concat(i.bg," ").concat(i.text," ").concat(i.border," whitespace-nowrap"),title:"Intensidad (microciclo)",children:r})}function L(e){let{ymd:t}=e,r=function(e,t){let r=(v[e]||[]).find(e=>m(e,t));return function(e){let t=(e||"").trim();if(!t)return{kind:"NONE"};let r=t.split("|").map(e=>(e||"").trim()),n=r[0];if("PARTIDO"===n){if(r.length>=4){let[,e,t,n]=r;return{kind:"PARTIDO",rivalId:e||void 0,rival:t||"",logoUrl:n||""}}if(r.length>=3){let[,e,t]=r;return{kind:"PARTIDO",rival:e||"",logoUrl:t||""}}return{kind:"PARTIDO"}}return"LIBRE"===n?{kind:"LIBRE"}:{kind:"NONE"}}(null==r?void 0:r.title)}(t,a),i="/ct/sessions/by-day/".concat(t,"/").concat(a),s="morning"===a?"Ma\xf1ana libre":"Tarde libre",o=e=>{let{children:t}=e;return(0,n.jsx)("div",{className:"rounded-md border bg-gray-50 flex items-center justify-center",style:{height:266},children:(0,n.jsx)("div",{className:"p-2 text-center",children:t})})};return(0,n.jsxs)("div",{className:"rounded-xl border bg-white shadow-sm overflow-hidden",children:[(0,n.jsxs)("div",{className:"px-2 py-1 border-b bg-gray-50",style:{height:54},children:[(0,n.jsx)("div",{className:"flex items-center justify-between min-w-0",children:(0,n.jsx)("div",{className:"text-[10px] font-semibold uppercase tracking-wide",children:new Date("".concat(t,"T00:00:00.000Z")).toLocaleDateString(void 0,{weekday:"short",day:"2-digit",month:"2-digit",timeZone:"UTC"})})}),(0,n.jsxs)("div",{className:"mt-1 flex items-center ".concat("LIBRE"===r.kind?"justify-start":"justify-between"," gap-2"),children:[(0,n.jsx)(M,{ymd:t}),"LIBRE"===r.kind?null:"PARTIDO"===r.kind?(0,n.jsx)(l.Z,{rivalId:r.rivalId,rivalName:r.rival||"",label:"Plan de partido"}):(0,n.jsx)("a",{href:i,className:"text-[9px] rounded border px-1.5 py-0.5 hover:bg-gray-100 whitespace-nowrap",children:"sesi\xf3n"})]})]}),(0,n.jsxs)("div",{className:"p-2",children:["PARTIDO"===r.kind&&(0,n.jsx)(o,{children:(0,n.jsx)(()=>(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[r.logoUrl?(0,n.jsx)("img",{src:r.logoUrl,alt:"Logo rival",className:"max-h-[110px] object-contain"}):null,(0,n.jsx)("div",{className:"text-[13px] font-semibold tracking-wide",children:"PARTIDO"}),r.rival?(0,n.jsxs)("div",{className:"text-[12px]",children:["vs ",(0,n.jsx)("b",{children:r.rival})]}):null]}),{})}),"LIBRE"===r.kind&&(0,n.jsx)(o,{children:(0,n.jsx)("div",{className:"text-gray-700 font-semibold tracking-wide text-[14px]",children:s})}),"NONE"===r.kind&&(0,n.jsx)(()=>(0,n.jsx)("div",{className:"grid gap-[6px]",style:{gridTemplateRows:"repeat(4, ".concat(62,"px)")},children:d.map(e=>{let r=A(t,a,e),i=((null==r?void 0:r.title)||"").trim();return(0,n.jsx)("div",{className:"rounded-md border bg-gray-50 px-2 py-1.5 text-[12px] leading-[18px] whitespace-pre-wrap overflow-hidden",children:i||(0,n.jsx)("span",{className:"text-gray-400 italic",children:"—"})},e)})}),{})]})]})}return(0,n.jsxs)("div",{id:"print-root",className:"jsx-87a67b85e310c469 p-3 md:p-4 space-y-3",children:[(0,n.jsx)(i(),{id:"87a67b85e310c469",children:'@page{size:A4 landscape;margin:8mm}@media print{body{-webkit-print-color-adjust:exact;color-adjust:exact;print-color-adjust:exact}body *{visibility:hidden!important}#print-root,#print-root *{visibility:visible!important}#print-root{position:absolute;inset:0;margin:0;padding:0;-webkit-transform:scale(.94);-moz-transform:scale(.94);-ms-transform:scale(.94);-o-transform:scale(.94);transform:scale(.94);-webkit-transform-origin:top left;-moz-transform-origin:top left;-ms-transform-origin:top left;-o-transform-origin:top left;transform-origin:top left;width:106%}nav,aside,header[role="banner"],.sidebar,.app-sidebar,.print\\\\:hidden,.no-print{display:none!important}a[href]:after{content:""}}'}),!t&&(0,n.jsxs)("header",{className:"jsx-87a67b85e310c469 flex flex-col gap-2 md:flex-row md:items-center md:justify-between no-print",children:[(0,n.jsxs)("div",{className:"jsx-87a67b85e310c469",children:[(0,n.jsx)("h2",{className:"jsx-87a67b85e310c469 text-lg md:text-xl font-bold",children:"Dashboard — Plan semanal (solo lectura)"}),(0,n.jsxs)("p",{className:"jsx-87a67b85e310c469 text-xs md:text-sm text-gray-500",children:["Semana ",N||"—"," → ",C||"—"," (Lun→Dom)"]})]}),(0,n.jsxs)("div",{className:"jsx-87a67b85e310c469 flex flex-wrap items-center gap-2",children:[(0,n.jsxs)("div",{className:"jsx-87a67b85e310c469 flex items-center gap-1 mr-2",children:[(0,n.jsx)("button",{onClick:()=>{let t=new URLSearchParams(e.toString());t.set("turn","morning"),history.replaceState(null,"","?".concat(t.toString())),u("morning")},className:"jsx-87a67b85e310c469 "+"px-2.5 py-1.5 rounded-xl border text-xs ".concat("morning"===a?"bg-black text-white":"hover:bg-gray-50"),children:"Ma\xf1ana"}),(0,n.jsx)("button",{onClick:()=>{let t=new URLSearchParams(e.toString());t.set("turn","afternoon"),history.replaceState(null,"","?".concat(t.toString())),u("afternoon")},className:"jsx-87a67b85e310c469 "+"px-2.5 py-1.5 rounded-xl border text-xs ".concat("afternoon"===a?"bg-black text-white":"hover:bg-gray-50"),children:"Tarde"})]}),(0,n.jsx)("button",{onClick:()=>h(e=>g(e,-7)),className:"jsx-87a67b85e310c469 px-2.5 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"◀ Semana anterior"}),(0,n.jsx)("button",{onClick:()=>h((0,c.$9)(new Date)),className:"jsx-87a67b85e310c469 px-2.5 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"Hoy"}),(0,n.jsx)("button",{onClick:()=>h(e=>g(e,7)),className:"jsx-87a67b85e310c469 px-2.5 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"Semana siguiente ▶"}),(0,n.jsx)("button",{onClick:()=>window.print(),className:"jsx-87a67b85e310c469 px-2.5 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"\uD83D\uDDA8️ Imprimir"})]})]}),j?(0,n.jsx)("div",{className:"jsx-87a67b85e310c469 text-gray-500",children:"Cargando…"}):(0,n.jsx)("div",{className:"jsx-87a67b85e310c469 rounded-2xl border bg-white shadow-sm",children:(0,n.jsxs)("div",{className:"jsx-87a67b85e310c469 p-3",children:[(0,n.jsxs)("div",{className:"jsx-87a67b85e310c469 mb-2",children:[(0,n.jsx)("div",{className:"jsx-87a67b85e310c469 bg-emerald-50 text-emerald-900 font-semibold px-2 py-0.5 border rounded-md uppercase tracking-wide text-[11px] inline-block",children:"DETALLES"}),(0,n.jsx)("div",{style:{gridTemplateColumns:"".concat(102,"px repeat(7, minmax(").concat(112,"px, 1fr))")},className:"jsx-87a67b85e310c469 mt-2 grid gap-[6px]",children:x.map(e=>(0,n.jsxs)("div",{className:"jsx-87a67b85e310c469 contents",children:[(0,n.jsx)("div",{className:"jsx-87a67b85e310c469 bg-gray-50/60 border rounded-md px-2 py-1 text-[10px] font-medium text-gray-600",children:e}),I.map(t=>(0,n.jsx)("div",{className:"jsx-87a67b85e310c469 rounded-md border px-1 py-0.5",children:(0,n.jsx)(U,{ymd:t,row:e})},"".concat(e,"-").concat(t)))]},"meta-".concat(e)))})]}),(0,n.jsx)("div",{className:"jsx-87a67b85e310c469 bg-emerald-100/70 text-emerald-900 font-semibold px-2 py-0.5 border rounded-md uppercase tracking-wide text-[11px] mb-2",children:"morning"===a?"TURNO MA\xd1ANA":"TURNO TARDE"}),(0,n.jsxs)("div",{style:{gridTemplateColumns:"".concat(102,"px repeat(7, minmax(").concat(112,"px, 1fr))")},className:"jsx-87a67b85e310c469 grid gap-3",children:[(0,n.jsxs)("div",{style:{gridTemplateRows:"".concat(54,"px repeat(4, ").concat(62,"px)")},className:"jsx-87a67b85e310c469 grid gap-[6px]",children:[(0,n.jsx)("div",{className:"jsx-87a67b85e310c469"}),d.map(e=>(0,n.jsx)("div",{className:"jsx-87a67b85e310c469 bg-gray-50/60 border rounded-md px-2 text-[10px] font-medium text-gray-600 flex items-center",children:(0,n.jsx)("span",{className:"jsx-87a67b85e310c469 leading-[14px] whitespace-pre-line",children:E(e)})},e))]}),I.map(e=>(0,n.jsx)(L,{ymd:e},"card-".concat(e)))]})]})})]})}function j(){return(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)("div",{className:"p-3 text-gray-500",children:"Cargando…"}),children:(0,n.jsx)(h,{})})}},4875:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(7437),a=r(2265),i=function(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=function e(t){var r,n,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var i=t.length;for(r=0;r<i;r++)t[r]&&(n=e(t[r]))&&(a&&(a+=" "),a+=n)}else for(n in t)t[n]&&(a&&(a+=" "),a+=n)}return a}(e))&&(n&&(n+=" "),n+=t);return n};function s(e){let{rivalId:t,rivalName:r,label:s="Plan de partido",className:o,fallbackHref:c,tab:l="plan"}=e,[d,x]=(0,a.useState)(null),[u,m]=(0,a.useState)(!1),p=(r||"").trim(),b=(0,a.useMemo)(()=>{if(!t)return"";let e=l?"?tab=".concat(encodeURIComponent(l)):"";return"/ct/rivales/".concat(t).concat(e)},[t,l]);(0,a.useEffect)(()=>{let e=!1;return async function(){if(b||!p){x(null);return}try{m(!0);let t=await fetch("/api/ct/rivales/search?q=".concat(encodeURIComponent(p),"&limit=5"),{cache:"no-store"});if(!t.ok)return;let r=await t.json().catch(()=>({})),n=Array.isArray(null==r?void 0:r.data)?r.data:[],a=n.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())===p.toLowerCase()})||null;e||x(a||n[0]||null)}catch(t){e||x(null)}finally{e||m(!1)}}(),()=>{e=!0}},[b,p]);let f=(0,a.useMemo)(()=>{if(b)return b;if(null==d?void 0:d.id){let e=l?"?tab=".concat(encodeURIComponent(l)):"";return"/ct/rivales/".concat(d.id).concat(e)}return c||(p?"/ct/rivales?search=".concat(encodeURIComponent(p)):"/ct/rivales")},[b,d,c,p,l]);return(0,n.jsx)("a",{href:f,className:i("inline-flex items-center rounded border px-1.5 py-0.5 text-[11px] hover:bg-gray-100 whitespace-nowrap",o),title:(null==d?void 0:d.name)||p||"Plan de partido","aria-busy":u,children:s})}},1673:function(e,t,r){"use strict";function n(e){let t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),n=String(e.getUTCDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(n)}function a(e){let t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())),r=t.getUTCDay()||7;return 1!==r&&t.setUTCDate(t.getUTCDate()-(r-1)),t.setUTCHours(0,0,0,0),t}async function i(e){let{start:t}=e,r=await fetch("/api/sessions?start=".concat(encodeURIComponent(t)),{cache:"no-store"}),n=await r.json();if(!r.ok)throw Error((null==n?void 0:n.error)||"No se pudo cargar la semana");return n}async function s(e){let t=await fetch("/api/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw Error((null==r?void 0:r.error)||"Error al crear la sesi\xf3n");return r}async function o(e,t){let r=await fetch("/api/sessions/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw Error((null==n?void 0:n.error)||"Error al actualizar la sesi\xf3n");return n}async function c(e){let t=await fetch("/api/sessions/".concat(e),{method:"DELETE"}),r=await t.json();if(!t.ok)throw Error((null==r?void 0:r.error)||"Error al borrar la sesi\xf3n");return r}async function l(e){let t=await fetch("/api/sessions/".concat(e),{cache:"no-store"}),r=await t.json();if(!t.ok)throw Error((null==r?void 0:r.error)||"Sesi\xf3n no encontrada");return r}r.d(t,{$9:function(){return a},CT:function(){return o},SO:function(){return c},VA:function(){return n},ed:function(){return s},tO:function(){return i},y4:function(){return l}})}},function(e){e.O(0,[8931,2971,7023,1744],function(){return e(e.s=8606)}),_N_E=e.O()}]);