(()=>{var a={};a.id=3925,a.ids=[3925],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},40470:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>I,patchFetch:()=>H,routeModule:()=>D,serverHooks:()=>G,workAsyncStorage:()=>E,workUnitAsyncStorage:()=>F});var d={};c.r(d),c.d(d,{DELETE:()=>C,GET:()=>A,PATCH:()=>B,dynamic:()=>w,revalidate:()=>x,runtime:()=>v});var e=c(34145),f=c(6782),g=c(35093),h=c(81525),i=c(78335),j=c(261),k=c(73301),l=c(35547),m=c(8061),n=c(38926),o=c(16080),p=c(54282),q=c(73928),r=c(63217),s=c(86439),t=c(2687),u=c(83264);!function(){var a=Error("Cannot find module '@/lib/prisma'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module 'next-auth/jwt'");throw a.code="MODULE_NOT_FOUND",a}();let v="nodejs",w="force-dynamic",x=0;function y(a){let b=new Date(a);return b.setHours(0,0,0,0),b.toISOString().slice(0,10)}function z(a){if(!a)return null;let b=/^(\d{4})-(\d{2})-(\d{2})$/.exec(a);if(!b)return null;let[c,d,e,f]=b,g=new Date(Number(d),Number(e)-1,Number(f));return isNaN(g.getTime())?null:g}async function A(a,b){let c=await Object(function(){var a=Error("Cannot find module 'next-auth/jwt'");throw a.code="MODULE_NOT_FOUND",a}())({req:a,secret:process.env.NEXTAUTH_SECRET}),d=c?.role;if(!c||!["MEDICO","CT","ADMIN"].includes(d??""))return u.NextResponse.json({error:"Unauthorized"},{status:401});let e=b.params.id,f=await Object(function(){var a=Error("Cannot find module '@/lib/prisma'");throw a.code="MODULE_NOT_FOUND",a}()).clinicalEntry.findUnique({where:{id:e},include:{user:{select:{name:!0,email:!0}}}});return f?u.NextResponse.json({id:f.id,userId:f.userId,userName:f.user?.name||f.user?.email||"â€”",date:y(f.date),status:f.status,leaveStage:f.leaveStage,leaveKind:f.leaveKind,diagnosis:f.diagnosis,bodyPart:f.bodyPart,laterality:f.laterality,mechanism:f.mechanism,severity:f.severity,illSystem:f.illSystem,illSymptoms:f.illSymptoms,illContagious:f.illContagious,illIsolationDays:f.illIsolationDays,illAptitude:f.illAptitude,feverMax:f.feverMax,startDate:f.startDate?y(f.startDate):null,daysMin:f.daysMin??null,daysMax:f.daysMax??null,expectedReturn:f.expectedReturn?y(f.expectedReturn):null,expectedReturnManual:f.expectedReturnManual,capMinutes:f.capMinutes,noSprint:f.noSprint,noChangeOfDirection:f.noChangeOfDirection,gymOnly:f.gymOnly,noContact:f.noContact,notes:f.notes,medSignature:f.medSignature,protocolObjectives:f.protocolObjectives,protocolTasks:f.protocolTasks,protocolControls:f.protocolControls,protocolCriteria:f.protocolCriteria,createdAt:f.createdAt,updatedAt:f.updatedAt}):u.NextResponse.json({error:"Not found"},{status:404})}async function B(a,b){let c=await Object(function(){var a=Error("Cannot find module 'next-auth/jwt'");throw a.code="MODULE_NOT_FOUND",a}())({req:a,secret:process.env.NEXTAUTH_SECRET}),d=c?.role;if(!c||!["MEDICO","ADMIN"].includes(d??""))return u.NextResponse.json({error:"Unauthorized"},{status:401});let e=b.params.id,f=await a.json().catch(()=>({})),g=void 0===f.expectedReturn?void 0:z(f.expectedReturn)??(f.expectedReturn?new Date(f.expectedReturn):null),h=f.expectedReturnManual;if(void 0===g){let a=void 0===f.startDate?void 0:z(f.startDate)??(f.startDate?new Date(f.startDate):null),b="number"==typeof f.daysEstimated?f.daysEstimated:"number"==typeof f.daysMax?f.daysMax:null;if(a&&Number.isInteger(b)){let c=new Date(a);c.setDate(c.getDate()+Number(b)),g=c,void 0===h&&(h=!1)}}let i=Object.fromEntries(Object.entries({status:void 0===f.status?void 0:{set:f.status},leaveStage:void 0===f.leaveStage?void 0:{set:f.leaveStage??null},leaveKind:void 0===f.leaveKind?void 0:{set:f.leaveKind??null},diagnosis:void 0===f.diagnosis?void 0:{set:f.diagnosis??null},bodyPart:void 0===f.bodyPart?void 0:{set:f.bodyPart??null},laterality:void 0===f.laterality?void 0:{set:f.laterality??null},mechanism:void 0===f.mechanism?void 0:{set:f.mechanism??null},severity:void 0===f.severity?void 0:{set:f.severity??null},illSystem:void 0===f.illSystem?void 0:{set:f.illSystem??null},illSymptoms:void 0===f.illSymptoms?void 0:{set:f.illSymptoms??null},illContagious:void 0===f.illContagious?void 0:{set:f.illContagious??null},illIsolationDays:void 0===f.illIsolationDays?void 0:{set:f.illIsolationDays??null},illAptitude:void 0===f.illAptitude?void 0:{set:f.illAptitude??null},feverMax:void 0===f.feverMax?void 0:{set:f.feverMax??null},startDate:void 0===f.startDate?void 0:{set:z(f.startDate)??(f.startDate?new Date(f.startDate):null)},expectedReturn:void 0===g?void 0:{set:g},expectedReturnManual:void 0===h?void 0:{set:h},capMinutes:void 0===f.capMinutes?void 0:{set:f.capMinutes??null},noSprint:void 0===f.noSprint?void 0:{set:!!f.noSprint},noChangeOfDirection:void 0===f.noChangeOfDirection?void 0:{set:!!f.noChangeOfDirection},gymOnly:void 0===f.gymOnly?void 0:{set:!!f.gymOnly},noContact:void 0===f.noContact?void 0:{set:!!f.noContact},notes:void 0===f.notes?void 0:{set:f.notes??null},medSignature:void 0===f.medSignature?void 0:{set:f.medSignature??null},protocolObjectives:void 0===f.protocolObjectives?void 0:{set:f.protocolObjectives??null},protocolTasks:void 0===f.protocolTasks?void 0:{set:f.protocolTasks??null},protocolControls:void 0===f.protocolControls?void 0:{set:f.protocolControls??null},protocolCriteria:void 0===f.protocolCriteria?void 0:{set:f.protocolCriteria??null}}).filter(([,a])=>void 0!==a));try{let a=await Object(function(){var a=Error("Cannot find module '@/lib/prisma'");throw a.code="MODULE_NOT_FOUND",a}()).clinicalEntry.update({where:{id:e},data:i,select:{id:!0,date:!0,status:!0}});return u.NextResponse.json({ok:!0,id:a.id,date:y(a.date),status:a.status},{status:200})}catch(a){if(a?.code==="P2025")return u.NextResponse.json({error:"Not found"},{status:404});return console.error("PATCH /api/medico/clinical/[id] error:",a),u.NextResponse.json({error:"Update error"},{status:500})}}async function C(a,b){let c=await Object(function(){var a=Error("Cannot find module 'next-auth/jwt'");throw a.code="MODULE_NOT_FOUND",a}())({req:a,secret:process.env.NEXTAUTH_SECRET}),d=c?.role;if(!c||!["ADMIN"].includes(d??""))return u.NextResponse.json({error:"Forbidden"},{status:403});try{return await Object(function(){var a=Error("Cannot find module '@/lib/prisma'");throw a.code="MODULE_NOT_FOUND",a}()).clinicalEntry.delete({where:{id:b.params.id}}),u.NextResponse.json({ok:!0})}catch(a){if(a?.code==="P2025")return u.NextResponse.json({error:"Not found"},{status:404});return console.error("DELETE /api/medico/clinical/[id] error:",a),u.NextResponse.json({error:"Delete error"},{status:500})}}let D=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/medico/clinical/[id]/route",pathname:"/api/medico/clinical/[id]",filename:"route",bundlePath:"app/api/medico/clinical/[id]/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/Users/Fran/ctbrain-7/app/api/medico/clinical/[id]/route.ts",nextConfigOutput:"",userland:d}),{workAsyncStorage:E,workUnitAsyncStorage:F,serverHooks:G}=D;function H(){return(0,g.patchFetch)({workAsyncStorage:E,workUnitAsyncStorage:F})}async function I(a,b,c){var d;let e="/api/medico/clinical/[id]/route";"/index"===e&&(e="/");let g=await D.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:y,routerServerContext:z,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,resolvedPathname:C}=g,E=(0,j.normalizeAppPath)(e),F=!!(y.dynamicRoutes[E]||y.routes[C]);if(F&&!x){let a=!!y.routes[C],b=y.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let G=null;!F||D.isDev||x||(G="/index"===(G=C)?"/":G);let H=!0===D.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:y,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>D.onRequestError(a,b,d,z)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>D.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&A&&B&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await D.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:A})},z),b}},l=await D.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:y,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",A?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&F||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(b instanceof s.NoFallbackError||await D.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:A})}),F)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55956:()=>{},58164:()=>{},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")}};var b=require("../../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[7983,7789,9333],()=>b(b.s=40470));module.exports=c})();