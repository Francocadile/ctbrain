"use strict";(()=>{var e={};e.id=4381,e.ids=[4381],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7306:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>x,staticGenerationAsyncStorage:()=>g});var s={};t.r(s),t.d(s,{GET:()=>m,dynamic:()=>p});var n=t(49303),a=t(88716),o=t(60670),i=t(87070),l=t(13538),u=t(61566);let p="force-dynamic";async function m(e){let{searchParams:r}=new URL(e.url),t=r.get("start"),s=r.get("end"),n=r.get("player");if(!t||!s)return i.NextResponse.json({error:"Par\xe1metros requeridos: start, end"},{status:400});let a={date:{gte:t,lte:s}};n&&(a.user={is:{OR:[{name:{equals:n,mode:"insensitive"}},{email:{equals:n,mode:"insensitive"}}]}});let o=(await l.Z.wellnessEntry.findMany({where:a,include:{user:{select:{name:!0,email:!0}}},orderBy:[{date:"asc"},{id:"asc"}]})).map(e=>{let r=Number(e.sleepQuality??0),t=Number(e.fatigue??0),s=Number(e.muscleSoreness??e.soreness??0),n=Number(e.stress??0),a=Number(e.mood??0),o=[r,t,s,n,a].reduce((e,r)=>e+r,0);return{Jugador:e.user?.name||e.user?.email||"—",Email:e.user?.email||"",Fecha:e.date,Sueño_calidad:r,Horas_sueño:null!=e.sleepHours?Number(e.sleepHours):"",Fatiga:t,Dolor_muscular:s,Estrés:n,Ánimo:a,Total_diario:o||"",Comentario:e.comment??e.notes??"",Color:e.color_flag??e.color??""}}),p=(0,u.C)(o),m=new Headers({"Content-Type":"text/csv; charset=utf-8","Content-Disposition":`attachment; filename="wellness_${t}_a_${s}.csv"`,"Cache-Control":"no-store"});return new i.NextResponse(p,{status:200,headers:m})}let d=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/export/wellness/route",pathname:"/api/export/wellness",filename:"route",bundlePath:"app/api/export/wellness/route"},resolvedPagePath:"/Users/Fran/ctbrain-14/src/app/api/export/wellness/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:g,serverHooks:x}=d,f="/api/export/wellness/route";function h(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:g})}},61566:(e,r,t)=>{t.d(r,{C:()=>s});function s(e,r){if(!e||0===e.length)return"";let t=r&&r.length?r:Object.keys(e[0]),s=e=>{if(null==e)return"";let r=String(e);return/[",\n]/.test(r)?`"${r.replace(/"/g,'""')}"`:r};return"\uFEFF"+t.map(s).join(",")+"\n"+e.map(e=>t.map(r=>s(e[r])).join(",")).join("\n")}},13538:(e,r,t)=>{t.d(r,{Z:()=>a,_:()=>n});var s=t(53524);let n=globalThis.prisma??new s.PrismaClient({log:["error"]}),a=n}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[8948,5972],()=>t(7306));module.exports=s})();