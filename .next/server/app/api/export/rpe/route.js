"use strict";(()=>{var e={};e.id=9184,e.ids=[9184],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},42124:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>c,routeModule:()=>m,serverHooks:()=>x,staticGenerationAsyncStorage:()=>g});var n={};r.r(n),r.d(n,{GET:()=>d,dynamic:()=>l});var a=r(49303),i=r(88716),o=r(60670),s=r(87070),u=r(13538),p=r(61566);let l="force-dynamic";async function d(e){let{searchParams:t}=new URL(e.url),r=t.get("start"),n=t.get("end"),a=t.get("player");if(!r||!n)return s.NextResponse.json({error:"Par\xe1metros requeridos: start, end"},{status:400});let i={date:{gte:r,lte:n}};a&&(i.user={is:{OR:[{name:{equals:a,mode:"insensitive"}},{email:{equals:a,mode:"insensitive"}}]}});let o=(await u.Z.rPEEntry.findMany({where:i,include:{user:{select:{name:!0,email:!0}}},orderBy:[{date:"asc"},{id:"asc"}]})).map(e=>{let t=Number(e.rpe??0),r=null!=e.duration?Number(e.duration):"",n=e.load??e.srpe??(null!=e.duration?Math.round(t*Number(e.duration)):"");return{Jugador:e.user?.name||e.user?.email||"â€”",Email:e.user?.email||"",Fecha:e.date,RPE:t||"",Minutos:r,sRPE_AU:n??"",Comentario:e.comment??""}}),l=(0,p.C)(o),d=new Headers({"Content-Type":"text/csv; charset=utf-8","Content-Disposition":`attachment; filename="rpe_${r}_a_${n}.csv"`,"Cache-Control":"no-store"});return new s.NextResponse(l,{status:200,headers:d})}let m=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/export/rpe/route",pathname:"/api/export/rpe",filename:"route",bundlePath:"app/api/export/rpe/route"},resolvedPagePath:"/Users/Fran/ctbrain-14/src/app/api/export/rpe/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:c,staticGenerationAsyncStorage:g,serverHooks:x}=m,h="/api/export/rpe/route";function v(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:g})}},61566:(e,t,r)=>{r.d(t,{C:()=>n});function n(e,t){if(!e||0===e.length)return"";let r=t&&t.length?t:Object.keys(e[0]),n=e=>{if(null==e)return"";let t=String(e);return/[",\n]/.test(t)?`"${t.replace(/"/g,'""')}"`:t};return"\uFEFF"+r.map(n).join(",")+"\n"+e.map(e=>r.map(t=>n(e[t])).join(",")).join("\n")}},13538:(e,t,r)=>{r.d(t,{Z:()=>i,_:()=>a});var n=r(53524);let a=globalThis.prisma??new n.PrismaClient({log:["error"]}),i=a}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[8948,5972],()=>r(42124));module.exports=n})();