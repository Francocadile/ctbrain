(()=>{var e={};e.id=5676,e.ids=[5676],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},63477:e=>{"use strict";e.exports=require("querystring")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},73502:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),s(17951),s(73466),s(15495),s(35866);var t=s(23191),a=s(88716),i=s(37922),n=s.n(i),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(r,o);let d=["",{children:["superadmin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,17951)),"/Users/Fran/ctbrain-14/src/app/superadmin/page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,73466)),"/Users/Fran/ctbrain-14/src/app/superadmin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,15495)),"/Users/Fran/ctbrain-14/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/Fran/ctbrain-14/src/app/superadmin/page.tsx"],u="/superadmin/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/superadmin/page",pathname:"/superadmin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},54630:(e,r,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},56270:(e,r,s)=>{Promise.resolve().then(s.t.bind(s,79404,23))},14497:(e,r,s)=>{Promise.resolve().then(s.bind(s,42126))},35303:()=>{},42126:(e,r,s)=>{"use strict";s.d(r,{default:()=>i});var t=s(10326),a=s(77109);function i({children:e}){return t.jsx(a.SessionProvider,{children:e})}},57371:(e,r,s)=>{"use strict";s.d(r,{default:()=>a.a});var t=s(670),a=s.n(t)},670:(e,r,s)=>{"use strict";let{createProxy:t}=s(68570);e.exports=t("/Users/Fran/ctbrain-14/node_modules/next/dist/client/link.js")},15495:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>c,metadata:()=>d});var t=s(19510);s(5023);var a=s(68570);let i=(0,a.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/providers.tsx`),{__esModule:n,$$typeof:l}=i;i.default;let o=(0,a.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/providers.tsx#default`),d={title:"ctbrain",description:"App"};function c({children:e}){return t.jsx("html",{lang:"es",children:t.jsx("body",{children:t.jsx(o,{children:e})})})}},73466:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>l});var t=s(19510),a=s(57371),i=s(75571),n=s(95456);async function l({children:e}){let r=await (0,i.getServerSession)(n.L),s=r?.user?.name??"Superadmin",a=r?.user?.role??"SUPERADMIN";return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("header",{className:"sticky top-0 z-40 border-b bg-white/80 backdrop-blur",children:(0,t.jsxs)("div",{className:"mx-auto flex max-w-7xl items-center justify-between px-4 py-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"h-8 w-8 rounded-lg bg-black text-white grid place-items-center font-extrabold",children:"SA"}),t.jsx("div",{className:"font-semibold",children:"CTBrain \xb7 Superadmin"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"hidden sm:block text-gray-600",children:[t.jsx("span",{className:"font-medium",children:s})," ",t.jsx("span",{className:"text-gray-400",children:"\xb7"})," ",t.jsx("span",{className:"rounded bg-gray-100 px-2 py-0.5",children:a})]}),t.jsx("form",{action:"/api/auth/signout",method:"post",children:t.jsx("button",{type:"submit",className:"rounded-lg border px-3 py-1.5 text-sm font-medium hover:bg-gray-50",children:"Salir"})})]})]})}),(0,t.jsxs)("div",{className:"mx-auto grid max-w-7xl grid-cols-1 gap-6 px-4 py-6 lg:grid-cols-[240px_1fr]",children:[t.jsx("aside",{className:"h-max rounded-2xl border bg-white p-4",children:(0,t.jsxs)("nav",{className:"space-y-1 text-sm",children:[t.jsx(o,{title:"General"}),t.jsx(d,{href:"/superadmin",children:"Resumen"}),t.jsx(d,{href:"/superadmin/teams",children:"Equipos"}),t.jsx(d,{href:"/superadmin/users",children:"Usuarios"}),t.jsx(o,{title:"Sistema"}),t.jsx(d,{href:"/superadmin/config",children:"Configuraci\xf3n"}),t.jsx(o,{title:"Salir"}),t.jsx("form",{action:"/api/auth/signout",method:"post",children:t.jsx("button",{type:"submit",className:"w-full rounded-lg border px-3 py-2 text-left hover:bg-gray-50",children:"Cerrar sesi\xf3n"})})]})}),t.jsx("main",{className:"min-h-[70vh]",children:e})]})]})}function o({title:e}){return t.jsx("div",{className:"mt-3 mb-1 text-[11px] font-semibold uppercase text-gray-400",children:e})}function d({href:e,children:r,disabled:s=!1}){return s?(0,t.jsxs)("div",{className:"cursor-not-allowed rounded-lg px-3 py-2 text-gray-400",children:[r,t.jsx("span",{className:"ml-2 text-[10px] uppercase tracking-wide",children:"Pronto"})]}):t.jsx(a.default,{href:e,className:"block rounded-lg px-3 py-2 hover:bg-gray-50",children:r})}},17951:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>i});var t=s(19510),a=s(35209);async function i(){return t.jsx(a.Z,{allow:["SUPERADMIN"],children:(0,t.jsxs)("main",{className:"min-h-[70vh] px-6 py-10",children:[(0,t.jsxs)("header",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Panel Global \xb7 SUPERADMIN"}),t.jsx("p",{className:"mt-2 text-gray-600 text-sm",children:"Control total sobre equipos, usuarios y configuraci\xf3n global."})]}),(0,t.jsxs)("section",{className:"mt-8 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,t.jsxs)("a",{href:"/superadmin/teams",className:"rounded-xl border bg-white p-5 shadow-sm hover:bg-gray-50 transition cursor-pointer block",children:[t.jsx("h3",{className:"font-semibold",children:"Equipos"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Ver, crear, editar y eliminar equipos."})]}),(0,t.jsxs)("a",{href:"/superadmin/users",className:"rounded-xl border bg-white p-5 shadow-sm hover:bg-gray-50 transition cursor-pointer block",children:[t.jsx("h3",{className:"font-semibold",children:"Usuarios"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Gesti\xf3n global de usuarios y roles."})]}),(0,t.jsxs)("a",{href:"/superadmin/config",className:"rounded-xl border bg-white p-5 shadow-sm hover:bg-gray-50 transition cursor-pointer block",children:[t.jsx("h3",{className:"font-semibold",children:"Configuraci\xf3n"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Toggles de m\xf3dulos, auditor\xeda y soporte."})]})]})]})})}},35209:(e,r,s)=>{"use strict";s.d(r,{Z:()=>l});var t=s(19510),a=s(95456),i=s(75571),n=s(58585);async function l({allow:e,requireTeam:r=!1,children:s}){let l=await (0,i.getServerSession)(a.L);l?.user?.id||(console.info("[RoleGate] deny",{reason:"no-session",allow:e,requireTeam:r}),(0,n.redirect)("/login"));let o=l.user.role;return(o&&e.includes(o)||(console.info("[RoleGate] deny",{reason:"role-mismatch",allow:e,requireTeam:r,role:o,userId:l.user.id}),(0,n.redirect)(function(e){switch(e){case"SUPERADMIN":return"/superadmin";case"ADMIN":return"/admin";case"CT":return"/ct";case"MEDICO":return"/medico";case"JUGADOR":return"/jugador";case"DIRECTIVO":return"/directivo";default:return"/login"}}(o))),!r||("string"==typeof l.user.currentTeamId?l.user.currentTeamId:null))?t.jsx(t.Fragment,{children:s}):(console.info("[RoleGate] deny",{reason:"missing-team",allow:e,role:o,requireTeam:r,userId:l.user.id}),t.jsx("main",{className:"min-h-[60vh] bg-gray-50 px-6 py-10",children:(0,t.jsxs)("div",{className:"mx-auto max-w-lg rounded-2xl border bg-white p-6 text-center shadow-sm space-y-4",children:[t.jsx("h1",{className:"text-xl font-semibold",children:"Seleccion\xe1 un equipo"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Eleg\xed un equipo activo desde el selector del dashboard."}),t.jsx("a",{href:"/ct",className:"inline-flex items-center justify-center rounded-lg border px-4 py-2 text-sm font-medium hover:bg-gray-50",children:"Ir al dashboard"})]})}))}},95456:(e,r,s)=>{"use strict";s.d(r,{L:()=>o});var t=s(53797),a=s(53524),i=s(42023),n=s.n(i);let l=new a.PrismaClient,o={session:{strategy:"jwt"},providers:[(0,t.Z)({name:"credentials",credentials:{email:{label:"Email",type:"text"},password:{label:"Password",type:"password"}},async authorize(e){let r=(e?.email||"").trim().toLowerCase(),s=(e?.password||"").toString();if(!r)return null;let t=await l.user.findUnique({where:{email:r},select:{id:!0,email:!0,name:!0,role:!0,isApproved:!0,passwordHash:!0}});if(!t||!t.passwordHash||!await n().compare(s,t.passwordHash))return null;let a=(await l.userTeam.findMany({where:{userId:t.id},select:{teamId:!0}})).map(e=>e.teamId),i=a.length>0?a[0]:null;return{id:t.id,email:t.email,name:t.name??t.email,role:t.role,isApproved:t.isApproved,teamIds:a,currentTeamId:i}}})],pages:{signIn:"/login"},callbacks:{async jwt({token:e,user:r}){if(r){let{role:s,isApproved:t,teamIds:a=[],currentTeamId:i=null}=r;e.role=s,e.isApproved=t,e.teamIds=a,e.currentTeamId=i??(a.length>0?a[0]:null)}else e.teamIds=e.teamIds??[],e.currentTeamId=e.currentTeamId??null;return e},async session({session:e,token:r}){e.user=e.user||{},e.user.id=r.sub,e.user.role=r.role,e.user.isApproved=r.isApproved??null;let s=Array.isArray(r.teamIds)?r.teamIds:[];return e.user.teamIds=s,e.user.currentTeamId=r.currentTeamId??null,e}}}},5023:()=>{}};var r=require("../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[8948,1159,330,2023,5571,9404,4689],()=>s(73502));module.exports=t})();