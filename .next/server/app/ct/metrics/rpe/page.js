(()=>{var e={};e.id=2795,e.ids=[2795],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},81151:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>o}),a(49012),a(66382),a(15495),a(35866);var r=a(23191),s=a(88716),l=a(37922),n=a.n(l),i=a(95231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);a.d(t,d);let o=["",{children:["ct",{children:["metrics",{children:["rpe",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,49012)),"/Users/Fran/ctbrain-14/src/app/ct/metrics/rpe/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,66382)),"/Users/Fran/ctbrain-14/src/app/ct/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,15495)),"/Users/Fran/ctbrain-14/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/Fran/ctbrain-14/src/app/ct/metrics/rpe/page.tsx"],x="/ct/metrics/rpe/page",u={require:a,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/ct/metrics/rpe/page",pathname:"/ct/metrics/rpe",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},39046:(e,t,a)=>{Promise.resolve().then(a.bind(a,17873))},17873:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y,dynamic:()=>c});var r=a(10326),s=a(17577),l=a(35047),n=a(82882),i=a(96599),d=a(91408),o=a(92420);let c="force-dynamic";function x(e){return e.toISOString().slice(0,10)}function u(e,t){let a=new Date(e);return a.setDate(a.getDate()+t),a}function m(e){let t=new Date(e),a=t.getDay();return u(t,0===a?-6:1-a)}function p({children:e,tone:t}){return r.jsx("span",{className:`inline-flex rounded-md border px-2 py-0.5 text-xs font-semibold ${{green:"bg-emerald-50 text-emerald-700 border-emerald-200",yellow:"bg-amber-50 text-amber-700 border-amber-200",red:"bg-red-50 text-red-700 border-red-200",gray:"bg-gray-100 text-gray-700 border-gray-200"}[t]}`,children:e})}function h(e){return null!=e&&isFinite(e)?e<.8||e>1.5?"red":e<=1.3?"green":"yellow":"gray"}function g(){let e=(0,l.useSearchParams)().get("tab")||"dia",[t,a]=(0,s.useState)(e),[c,g]=(0,s.useState)(x(new Date)),[y,j]=(0,s.useState)([]),[b,N]=(0,s.useState)(!0),[f,v]=(0,s.useState)(""),[w,A]=(0,s.useState)("90"),[S,P]=(0,s.useState)(!1),[C,U]=(0,s.useState)({}),[R,E]=(0,s.useState)(7),[k,M]=(0,s.useState)(!1),[_,F]=(0,s.useState)([]),[L,J]=(0,s.useState)([0,0,0,0,0]),[$,D]=(0,s.useState)(!1),[O,q]=(0,s.useState)(null),[Z,I]=(0,s.useState)(!1),[T,V]=(0,s.useState)([]),[K,B]=(0,s.useState)([]),W=i.Z;async function G(){N(!0);try{let e=await fetch(`/api/metrics/rpe?date=${c}`,{cache:"no-store"}),t=e.ok?await e.json():[],a=(Array.isArray(t)?t:[]).map(e=>({...e,userName:e.userName||e.playerKey||e.user?.name||e.user?.email||"Jugador"}));j(a);let r=await fetch(`/api/injuries?date=${c}`,{cache:"no-store"});if(r.ok){let e=await r.json(),t={};for(let a of Array.isArray(e)?e:[]){let e=a.userName||a.user?.name||a.user?.email||"—";t[e]={userId:a.userId,userName:e,status:a.status}}U(t)}else U({})}finally{N(!1)}}let X=(0,s.useMemo)(()=>{let e=f.trim().toLowerCase();return e?y.filter(t=>(t.userName||"").toLowerCase().includes(e)||(t.playerKey||"").toLowerCase().includes(e)):y},[y,f]),z=(0,s.useMemo)(()=>X.slice().sort((e,t)=>(0,d.uC)(t)-(0,d.uC)(e)),[X]);async function H(){let e=Math.max(0,Number(w||0));if(!e)return alert("Ingres\xe1 minutos > 0");P(!0);try{let t=await fetch("/api/metrics/rpe/default-duration",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:c,duration:e})});if(!t.ok)throw Error(await t.text());await G()}catch(e){alert(e?.message||"Error aplicando duraci\xf3n")}finally{P(!1)}}async function Q(){if(confirm(`\xbfPoner en blanco la duraci\xf3n del ${c}?`)){P(!0);try{let e=await fetch("/api/metrics/rpe/clear-duration",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:c})});if(!e.ok)throw Error(await e.text());await G()}catch(e){alert(e?.message||"Error limpiando duraciones")}finally{P(!1)}}}async function Y(e,t){let a=""===t?null:Math.max(0,Number(t));P(!0);try{let t=await fetch(`/api/metrics/rpe/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({duration:a})});if(!t.ok)throw Error(await t.text());await G()}catch(e){alert(e?.message||"Error guardando fila")}finally{P(!1)}}let ee=(0,s.useMemo)(()=>{let e=y.length,t=y.filter(e=>null!=e.rpe&&Number(e.rpe)>=0).length,a=y.filter(e=>null!=e.duration&&Number(e.duration)>0).length,r=e?(0,d.J6)(y.map(e=>Number(e.rpe||0))):0,s=y.map(e=>(0,d.uC)(e)).filter(e=>!Number.isNaN(e)).reduce((e,t)=>e+t,0),l=0,n=0,i=0;for(let e of y){let t=Number(e.rpe||0);t<=3?l++:t<=6?n++:i++}return{n:e,withRpe:t,withDur:a,withRpePct:e?Math.round(t/e*100):0,withDurPct:e?Math.round(a/e*100):0,rpeAvg:r,totalSRPE:s,distRPE:{low:l,mid:n,high:i}}},[y]);async function et(e){let t=await fetch(`/api/metrics/wellness?date=${e}`,{cache:"no-store"});if(!t.ok)return[];let a=await t.json();return Array.isArray(a)?a:[]}async function ea(e){q(e),D(!0),I(!0);try{let t=Array.from({length:8},(e,t)=>(0,o.Op)((0,o.E4)((0,o.lN)(c),-(0===t?0:t)))),a=await Promise.all(t.map(e=>et(e))),r=[];for(let s=0;s<t.length;s++){let t=(a[s]||[]).find(t=>(t.userName||t.user?.name||t.user?.email||t.playerKey||"—")===e);r.push(t?Number((0,o.bq)(t).toFixed(2)):0)}V(r);let s=Array.from({length:7},(e,t)=>x(u(function(e){let[t,a,r]=e.split("-").map(Number);return new Date(t,a-1,r)}(c),-t))),l=await Promise.all(s.map(e=>fetch(`/api/metrics/rpe?date=${e}`,{cache:"no-store"}))),n=await Promise.all(l.map(e=>e.ok?e.json():[])),i=[];for(let t=0;t<s.length;t++)for(let a of Array.isArray(n[t])?n[t]:[])if((a.userName||a.playerKey||a.user?.name||a.user?.email||"Jugador")===e){let e=a.load??a.srpe??Number(a.rpe??0)*Number(a.duration??0)??0;i.push({date:s[t],au:Number(e)});break}B(i)}finally{I(!1)}}let[er,es]=(0,s.useState)(()=>m(new Date)),[el,en]=(0,s.useState)(!1),[ei,ed]=(0,s.useState)([]),[eo,ec]=(0,s.useState)([]),[ex,eu]=(0,s.useState)(""),[em,ep]=(0,s.useState)([]);async function eh(e){let t=await fetch(`/api/metrics/rpe?date=${e}`,{cache:"no-store"});if(!t.ok)return[];let a=await t.json();return Array.isArray(a)?a:[]}function eg(e){return e.userName||e.playerKey||e.user?.name||e.user?.email||"Jugador"}function ey(e){return Math.max(0,Math.round(Number(e.load??e.srpe??Number(e.rpe??0)*Number(e.duration??0)??0)))}async function ej(){en(!0);try{let e=await Promise.all(ei.map(e=>eh(e))),t={};e.forEach((e,a)=>{for(let r of e){let e=eg(r);t[e]||(t[e]=Array(7).fill(0)),t[e][a]+=ey(r)}});let a=await Promise.all(eo.map(e=>eh(e))),r={};a.forEach(e=>{let t={};for(let a of e){let e=eg(a);t[e]=(t[e]??0)+ey(a)}for(let[e,a]of Object.entries(t))r[e]||(r[e]=[]),r[e].push(a)});let s=new Set([...Object.keys(t),...Object.keys(r)]),l=[];for(let e of s){let a=(t[e]??Array(7).fill(0)).map(e=>Math.max(0,Math.round(e))),s=a.reduce((e,t)=>e+t,0),n=r[e]??[],i=n.length?7*(0,d.J6)(n):0,o=i>0?s/i:null,c=(0,d.J6)(a),x=function(e){let t=e.length;if(t<2)return 0;let a=(0,d.J6)(e),r=e.reduce((e,t)=>e+(t-a)*(t-a),0)/(t-1);return Math.sqrt(r)}(a),u=x>0?c/x:null,m=null!=u?s*u:null;l.push({userName:e,daysAU:a,totalAU:s,acute7:s,chronic28:i,acwr:o,mean:c,sd:x,monotony:u,strain:m})}l.sort((e,t)=>{let a=e=>{let t=h(e.acwr);return"red"===t?0:"yellow"===t?1:"green"===t?2:3},r=a(e)-a(t);return 0!==r?r:t.totalAU-e.totalAU}),ep(l)}finally{en(!1)}}function eb(e){es(t=>u(t,7*e))}(0,s.useEffect)(()=>{"semana"===t&&7===ei.length&&28===eo.length&&ej()},[t,ei.join(","),eo.join(",")]);let eN=(0,s.useMemo)(()=>{let e=ex.trim().toLowerCase();return e?em.filter(t=>t.userName.toLowerCase().includes(e)):em},[em,ex]),ef=(0,s.useMemo)(()=>{if(!eN.length)return{players:0,totalAU:0,avgAU:0};let e=eN.reduce((e,t)=>e+t.totalAU,0),t=e/eN.length;return{players:eN.length,totalAU:e,avgAU:t}},[eN]);return(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)("header",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-lg font-bold",children:["RPE (CT)"," ",r.jsx(n.Z,{text:"RPE 0–10 respondido 30' post-sesi\xf3n. El CT define la duraci\xf3n; sRPE = RPE\xd7min. Semana calcula ACWR, Monoton\xeda y Strain."})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Vista unificada D\xeda/Semana/Reportes • sRPE = RPE \xd7 minutos"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["dia"===t&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("input",{type:"date",className:"rounded-md border px-2 py-1.5 text-sm",value:c,onChange:e=>g(e.target.value)}),r.jsx("button",{onClick:G,className:"rounded-lg border px-2 py-1 text-sm hover:bg-gray-50",children:"Recargar"}),r.jsx("button",{onClick:function(){let e=["Jugador,Fecha,Sesi\xf3n,RPE,Minutos,sRPE_AU,Falta_RPE,Faltan_Minutos"];for(let t of z){let a=(t.userName||t.playerKey||"Jugador").replace(/"/g,'""'),r=(0,d.uC)(t),s=t.sessionLabel??(null!=t.sessionIndex?`Sesi\xf3n ${t.sessionIndex}`:t.sessionId??""),l=null==t.rpe||Number.isNaN(Number(t.rpe)),n=null==t.duration||0>=Number(t.duration);e.push([`"${a}"`,t.date,`"${(s??"").toString().replace(/"/g,'""')}"`,t.rpe??"",t.duration??"",r?Math.round(r):"",l?"1":"0",n?"1":"0"].join(","))}let t=new Blob([e.join("\n")],{type:"text/csv;charset=utf-8"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=`rpe_dia_${c}.csv`,r.click(),URL.revokeObjectURL(a)},className:"rounded-lg bg-black text-white px-3 py-1.5 text-sm hover:opacity-90",children:"Exportar CSV"})]}),"semana"===t&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{onClick:()=>eb(-1),className:"rounded-lg border px-2 py-1 text-sm hover:bg-gray-50",children:"← Semana anterior"}),r.jsx("input",{type:"date",className:"rounded-md border px-2 py-1.5 text-sm",value:x(er),onChange:e=>{es(m(new Date(e.target.value)))}}),r.jsx("button",{onClick:()=>eb(1),className:"rounded-lg border px-2 py-1 text-sm hover:bg-gray-50",children:"Semana siguiente →"}),r.jsx("button",{onClick:function(){let e=[`Jugador,Lunes_AU,Martes_AU,Miercoles_AU,Jueves_AU,Viernes_AU,Sabado_AU,Domingo_AU,AU_total_semana,Agudo_7d,Cronico_28d,ACWR,Monotonia,Strain,Semana (${x(er)} a ${x(u(er,6))})`];for(let t of eN)e.push([`"${t.userName.replace(/"/g,'""')}"`,...t.daysAU.map(e=>String(e)),t.totalAU,t.acute7,t.chronic28.toFixed(1),null==t.acwr?"":t.acwr.toFixed(2),null==t.monotony?"":t.monotony.toFixed(2),null==t.strain?"":Math.round(t.strain),""].join(","));let t=new Blob([e.join("\n")],{type:"text/csv;charset=utf-8"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=`rpe_semana_${x(er)}.csv`,r.click(),URL.revokeObjectURL(a)},className:"rounded-lg bg-black text-white px-3 py-1.5 text-sm hover:opacity-90",children:"Exportar CSV"})]})]})]}),r.jsx("nav",{className:"rounded-xl border bg-white p-1 flex gap-1",children:[{key:"dia",label:"D\xeda"},{key:"semana",label:"Semana"},{key:"reportes",label:"Reportes"}].map(e=>{let s=t===e.key;return r.jsx("button",{onClick:()=>(function(e){a(e);let t=new URL(window.location.href);t.searchParams.set("tab",e),window.history.replaceState(null,"",t.toString())})(e.key),className:`flex-1 rounded-lg px-3 py-2 text-sm font-medium transition ${s?"bg-black text-white":"hover:bg-gray-50"}`,children:e.label},e.key)})}),"dia"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("section",{className:"rounded-xl border bg-white p-3 flex flex-wrap items-center gap-2",children:[(0,r.jsxs)("div",{className:"text-sm font-medium mr-2",children:["Acciones:"," ",r.jsx(n.Z,{text:"“Aplicar a vac\xedos” asigna X minutos a filas sin duraci\xf3n. “Limpiar” borra las duraciones del d\xeda."})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("input",{className:"w-20 rounded-md border px-2 py-1 text-sm",placeholder:"min",value:w,onChange:e=>A(e.target.value),inputMode:"numeric"}),r.jsx("button",{onClick:H,disabled:S,className:`rounded-lg px-3 py-1.5 text-xs ${S?"bg-gray-200 text-gray-500":"bg-black text-white hover:opacity-90"}`,children:"Aplicar a vac\xedos"})]}),r.jsx("div",{className:"h-5 w-px bg-gray-300 mx-1"}),r.jsx("button",{onClick:Q,disabled:S,className:"rounded-lg border px-3 py-1.5 text-xs hover:bg-gray-50",children:"Limpiar minutos del d\xeda"}),(0,r.jsxs)("div",{className:"ml-auto text-xs text-gray-500",children:["sRPE = RPE \xd7 minutos"," ",r.jsx(n.Z,{text:"La AU se recalcula al guardar. Si la duraci\xf3n est\xe1 vac\xeda, no hay AU."})]})]}),r.jsx("section",{className:"rounded-2xl border bg-white px-4 py-3",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3",children:[(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[r.jsx("div",{className:"text-[11px] uppercase text-gray-500",children:"Respondieron hoy"}),r.jsx("div",{className:"mt-1 text-2xl font-bold",children:ee.n})]}),(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[r.jsx("div",{className:"text-[11px] uppercase text-gray-500",children:"Con RPE"}),(0,r.jsxs)("div",{className:"mt-1 text-2xl font-bold",children:[ee.withRpe," ",(0,r.jsxs)("span",{className:"text-sm font-semibold text-gray-500",children:["(",ee.withRpePct,"%)"]})]})]}),(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[r.jsx("div",{className:"text-[11px] uppercase text-gray-500",children:"Con minutos"}),(0,r.jsxs)("div",{className:"mt-1 text-2xl font-bold",children:[ee.withDur," ",(0,r.jsxs)("span",{className:"text-sm font-semibold text-gray-500",children:["(",ee.withDurPct,"%)"]})]})]}),(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[r.jsx("div",{className:"text-[11px] uppercase text-gray-500",children:"RPE promedio"}),r.jsx("div",{className:"mt-1 text-2xl font-bold",children:ee.rpeAvg?ee.rpeAvg.toFixed(2):"—"})]}),(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[r.jsx("div",{className:"text-[11px] uppercase text-gray-500",children:"sRPE total (AU)"}),r.jsx("div",{className:"mt-1 text-2xl font-bold",children:ee.totalSRPE?Math.round(ee.totalSRPE):"—"})]}),(0,r.jsxs)("div",{className:"rounded-xl border p-3",children:[r.jsx("div",{className:"text-[11px] uppercase text-gray-500",children:"Distribuci\xf3n RPE (0–3 / 4–6 / 7–10)"}),(0,r.jsxs)("div",{className:"mt-1 text-sm font-semibold",children:[ee.distRPE.low," / ",ee.distRPE.mid," / ",ee.distRPE.high]})]})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("input",{className:"w-full md:w-80 rounded-md border px-2 py-1.5 text-sm",placeholder:"Buscar jugador…",value:f,onChange:e=>v(e.target.value)}),(0,r.jsxs)("span",{className:"text-[12px] text-gray-500",children:[z.length," resultado(s)"]})]}),(0,r.jsxs)("section",{className:"rounded-2xl border bg-white overflow-hidden",children:[r.jsx("div",{className:"bg-gray-50 px-3 py-2 text-[12px] font-semibold uppercase",children:"Entradas"}),b?r.jsx("div",{className:"p-4 text-gray-500",children:"Cargando…"}):0===z.length?r.jsx("div",{className:"p-4 text-gray-500 italic",children:"Sin datos"}):r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"border-b bg-gray-50",children:[r.jsx("th",{className:"text-left px-3 py-2",children:"Jugador"}),r.jsx("th",{className:"text-left px-3 py-2",children:"Sesi\xf3n"}),(0,r.jsxs)("th",{className:"text-left px-3 py-2",children:["RPE ",r.jsx(n.Z,{text:"Esfuerzo percibido (0–10). 0=descanso, 10=m\xe1ximo."})]}),(0,r.jsxs)("th",{className:"text-left px-3 py-2",children:["Duraci\xf3n (min) ",r.jsx(n.Z,{text:"Minutos definidos por el CT. Editables por fila."})]}),(0,r.jsxs)("th",{className:"text-left px-3 py-2",children:["sRPE (AU) ",r.jsx(n.Z,{text:"RPE \xd7 minutos. Se actualiza al guardar cambios."})]}),r.jsx("th",{className:"text-right px-3 py-2",children:"Acciones"})]})}),r.jsx("tbody",{children:z.map(e=>{let t=e.userName||e.playerKey||"Jugador",a=C[t]||null,s=null==e.rpe||Number.isNaN(Number(e.rpe)),l=null==e.duration||0>=Number(e.duration),n=e.sessionLabel??(null!=e.sessionIndex?`Sesi\xf3n ${e.sessionIndex}`:e.sessionId??"");return(0,r.jsxs)("tr",{className:"border-b last:border-0",children:[(0,r.jsxs)("td",{className:"px-3 py-2 font-medium",children:[t," ",a&&r.jsx("span",{className:"ml-1 inline-flex rounded-md border px-2 py-0.5 text-[11px] font-semibold bg-gray-100 text-gray-600 border-gray-200",children:"LESIONADO"}),(s||l)&&(0,r.jsxs)("span",{className:"ml-2",children:[s&&r.jsx(p,{tone:"red",children:"Falta RPE"})," ",l&&r.jsx(p,{tone:"yellow",children:"Faltan minutos"})]})]}),r.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:n||"—"}),r.jsx("td",{className:"px-3 py-2",children:e.rpe??"—"}),r.jsx("td",{className:"px-3 py-2",children:r.jsx("input",{className:"w-24 rounded-md border px-2 py-1 text-sm",defaultValue:e.duration??"",onBlur:t=>Y(e,t.currentTarget.value),placeholder:"min",inputMode:"numeric"})}),r.jsx("td",{className:"px-3 py-2",children:(e.load??null)!==null?Math.round(Number(e.load)):"—"}),r.jsx("td",{className:"px-3 py-2",children:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{onClick:()=>ea(t),className:"rounded-lg border px-2 py-1 text-[11px] hover:bg-gray-50",children:"Ver"}),r.jsx("button",{onClick:()=>Y(e,""),className:"rounded-lg border px-2 py-1 text-[11px] hover:bg-gray-50",children:"Vaciar"})]})})]},e.id)})})]})})]})]}),"semana"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"rounded-xl border bg-white p-3 text-xs text-gray-600 flex flex-wrap gap-3",children:[(0,r.jsxs)("div",{children:[r.jsx("b",{children:"AU total (promedio/jugador)"})," ",r.jsx(n.Z,{text:"Suma de AU de todos los jugadores en la semana / jugadores listados."}),":"," ",Math.round(ef.totalAU)," AU ",r.jsx("span",{className:"text-gray-400",children:"/"})," ",Math.round(ef.avgAU)," AU"]}),(0,r.jsxs)("div",{className:"ml-auto text-gray-500",children:["Jugadores: ",r.jsx("b",{children:ef.players})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("input",{className:"w-full md:w-80 rounded-md border px-2 py-1.5 text-sm",placeholder:"Buscar jugador…",value:ex,onChange:e=>eu(e.target.value)}),(0,r.jsxs)("span",{className:"text-[12px] text-gray-500",children:[eN.length," resultado(s)"]})]}),(0,r.jsxs)("section",{className:"rounded-2xl border bg-white overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-gray-50 px-3 py-2 text-[12px] font-semibold uppercase",children:["AU por d\xeda y m\xe9tricas"," ",r.jsx(n.Z,{text:"AU diario por jugador (L..D) y m\xe9tricas semanales de carga y riesgo."})]}),el?r.jsx("div",{className:"p-4 text-gray-500",children:"Cargando…"}):0===eN.length?r.jsx("div",{className:"p-4 text-gray-500 italic",children:"Sin datos"}):r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full text-sm",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"border-b bg-gray-50",children:[r.jsx("th",{className:"text-left px-3 py-2",children:"Jugador"}),r.jsx("th",{className:"text-right px-3 py-2",children:"L"}),r.jsx("th",{className:"text-right px-3 py-2",children:"M"}),r.jsx("th",{className:"text-right px-3 py-2",children:"X"}),r.jsx("th",{className:"text-right px-3 py-2",children:"J"}),r.jsx("th",{className:"text-right px-3 py-2",children:"V"}),r.jsx("th",{className:"text-right px-3 py-2",children:"S"}),r.jsx("th",{className:"text-right px-3 py-2",children:"D"}),r.jsx("th",{className:"text-right px-3 py-2",children:"AU total"}),r.jsx("th",{className:"text-right px-3 py-2",children:"Agudo (7d)"}),r.jsx("th",{className:"text-right px-3 py-2",children:"Cr\xf3nico (28d)"}),r.jsx("th",{className:"text-right px-3 py-2",children:"ACWR"}),r.jsx("th",{className:"text-right px-3 py-2",children:"Monoton\xeda"}),r.jsx("th",{className:"text-right px-3 py-2",children:"Strain"})]})}),r.jsx("tbody",{children:eN.map(e=>{var t;let a=h(e.acwr),s=(t=e.totalAU)<1500?"yellow":t>4500?"red":"green";return(0,r.jsxs)("tr",{className:"border-b last:border-0",children:[r.jsx("td",{className:"px-3 py-2 font-medium",children:e.userName}),e.daysAU.map((e,t)=>r.jsx("td",{className:"px-3 py-2 text-right tabular-nums",children:e||"—"},t)),r.jsx("td",{className:"px-3 py-2 text-right",children:(0,r.jsxs)(p,{tone:s,children:[Math.round(e.totalAU)," AU"]})}),(0,r.jsxs)("td",{className:"px-3 py-2 text-right",children:[Math.round(e.acute7)," AU"]}),(0,r.jsxs)("td",{className:"px-3 py-2 text-right",children:[e.chronic28.toFixed(1)," AU"]}),r.jsx("td",{className:"px-3 py-2 text-right",children:r.jsx(p,{tone:a,children:null==e.acwr?"—":e.acwr.toFixed(2)})}),r.jsx("td",{className:"px-3 py-2 text-right",children:null==e.monotony?"—":e.monotony.toFixed(2)}),r.jsx("td",{className:"px-3 py-2 text-right",children:null==e.strain?"—":Math.round(e.strain)})]},e.userName)})})]})})]}),(0,r.jsxs)("div",{className:"rounded-xl border bg-white p-3 text-xs text-gray-600",children:[r.jsx("b",{children:"ACWR:"})," objetivo 0.8–1.3 ",r.jsx(p,{tone:"green",children:"OK"}),", 1.3–1.5 ",r.jsx(p,{tone:"yellow",children:"Atenci\xf3n"}),", <0.8 o >1.5 ",r.jsx(p,{tone:"red",children:"Riesgo"}),"."," ",r.jsx(n.Z,{text:"Us\xe1 ACWR para ajustar carga: valores extremos sugieren subir o bajar volumen/intensidad."}),r.jsx("br",{}),r.jsx("b",{children:"AU semanal:"})," <1500 subcarga, >4500 sobrecarga (ajustable)."," ",r.jsx(n.Z,{text:"Umbrales de referencia para detectar semanas muy livianas o pesadas."})]})]}),"reportes"===t&&(0,r.jsxs)("section",{className:"rounded-2xl border bg-white p-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-[12px] font-semibold uppercase",children:["Reportes individuales",r.jsx(n.Z,{text:"MVP: listado por jugador con sRPE del d\xeda. Luego link al Perfil de Jugador."})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[y.length," jugador(es)"]})]}),b?r.jsx("div",{className:"p-3 text-gray-500",children:"Cargando…"}):0===y.length?r.jsx("div",{className:"p-3 text-gray-500 italic",children:"Sin datos hoy"}):r.jsx("ul",{className:"mt-2 grid md:grid-cols-2 lg:gridCols-3 gap-2",children:y.slice().sort((e,t)=>(e.userName||"").localeCompare(t.userName||"")||(0,d.uC)(t)-(0,d.uC)(e)).map(e=>{let t=(0,d.uC)(e),a=e.userName||e.playerKey||"Jugador";return(0,r.jsxs)("li",{className:"rounded-lg border p-3",children:[r.jsx("div",{className:"font-medium",children:a}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["RPE: ",r.jsx("b",{children:e.rpe??"—"})," • Min: ",r.jsx("b",{children:e.duration??"—"})," • sRPE: ",(0,r.jsxs)("b",{children:[t?Math.round(t):"—"," AU"]})]}),(0,r.jsxs)("div",{className:"mt-2 flex gap-2",children:[r.jsx("button",{onClick:()=>ea(a),className:"rounded-lg border px-2 py-1 text-xs hover:bg-gray-50",children:"Ver"}),r.jsx("button",{disabled:!0,className:"rounded-lg border px-2 py-1 text-xs text-gray-400 cursor-not-allowed",title:"Pr\xf3ximamente",children:"Abrir perfil"})]})]},e.id)})})]}),O&&r.jsx(W,{open:$,onClose:()=>D(!1),loading:Z,playerName:O,date:c,sdw7:T,rpeRecent:K})]})}function y(){return r.jsx(s.Suspense,{fallback:r.jsx("div",{className:"p-4 text-gray-500",children:"Cargando…"}),children:r.jsx(g,{})})}},49012:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>d,dynamic:()=>i});var r=a(68570);let s=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/metrics/rpe/page.tsx`),{__esModule:l,$$typeof:n}=s;s.default;let i=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/metrics/rpe/page.tsx#dynamic`),d=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/metrics/rpe/page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[8948,1159,9404,3404],()=>a(81151));module.exports=r})();