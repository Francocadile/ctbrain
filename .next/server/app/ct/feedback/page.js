(()=>{var e={};e.id=2056,e.ids=[2056],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},67942:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>o,routeModule:()=>m,tree:()=>d}),s(30194),s(66382),s(15495),s(35866);var r=s(23191),a=s(88716),n=s(37922),l=s.n(n),i=s(95231),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);s.d(t,c);let d=["",{children:["ct",{children:["feedback",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,30194)),"/Users/Fran/ctbrain-14/src/app/ct/feedback/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,66382)),"/Users/Fran/ctbrain-14/src/app/ct/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,15495)),"/Users/Fran/ctbrain-14/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/Fran/ctbrain-14/src/app/ct/feedback/page.tsx"],x="/ct/feedback/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/ct/feedback/page",pathname:"/ct/feedback",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},54630:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},34644:(e,t,s)=>{Promise.resolve().then(s.bind(s,92656))},97992:(e,t,s)=>{Promise.resolve().then(s.bind(s,94340))},14497:(e,t,s)=>{Promise.resolve().then(s.bind(s,42126))},90434:(e,t,s)=>{"use strict";s.d(t,{default:()=>a.a});var r=s(79404),a=s.n(r)},35047:(e,t,s)=>{"use strict";var r=s(77389);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},92656:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(10326),a=s(17577),n=s(35047),l=s(77109);let i=new Intl.DateTimeFormat("es-AR",{dateStyle:"medium",timeStyle:"short"});function c(){let e=(0,n.useRouter)(),{data:t,status:s}=(0,l.useSession)({required:!0,onUnauthenticated(){e.replace("/login")}}),i=t?.user?.role,c="CT"===i||"MEDICO"===i||"ADMIN"===i,[x,u]=(0,a.useState)([]),[m,p]=(0,a.useState)("idle"),[h,g]=(0,a.useState)(null),[b,y]=(0,a.useState)("all"),[f,j]=(0,a.useState)(""),[v,N]=(0,a.useState)(""),w=async e=>{if(!c)return;p("loading"),g(null);let t=new URLSearchParams;"all"!==b&&t.set("playerId",b),f&&t.set("from",new Date(`${f}T00:00:00`).toISOString()),v&&t.set("to",new Date(`${v}T23:59:59`).toISOString());try{let s=t.size?`/api/feedback?${t.toString()}`:"/api/feedback",r=await fetch(s,{cache:"no-store",signal:e});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e?.error||"No se pudo cargar el feedback")}let a=await r.json();u(a.data||[]),p("ready")}catch(e){if(e?.name==="AbortError")return;console.error("[feedback] fetch failed",e),p("error"),g(e?.message||"No se pudo cargar el feedback")}};return"loading"===s?r.jsx("div",{className:"p-6 text-sm text-gray-500",children:"Cargando…"}):c?(0,r.jsxs)("div",{className:"mx-auto flex max-w-5xl flex-col gap-6",children:[(0,r.jsxs)("header",{className:"space-y-1",children:[r.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Feedback de jugadores"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Consult\xe1 los mensajes que los jugadores enviaron al cuerpo t\xe9cnico o staff m\xe9dico."})]}),r.jsx(d,{entries:x,playerFilter:b,onPlayerChange:y,from:f,to:v,onFromChange:j,onToChange:N,onClear:()=>{y("all"),j(""),N("")},onRefresh:()=>w(),loading:"loading"===m}),h?r.jsx("div",{className:"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:h}):null,r.jsx(o,{entries:x,loading:"loading"===m&&!x.length})]}):r.jsx("div",{className:"mx-auto max-w-3xl rounded-lg border bg-white p-6 text-sm text-gray-600",children:"No ten\xe9s permiso para ver el feedback de los jugadores."})}function d({entries:e,playerFilter:t,onPlayerChange:s,from:n,to:l,onFromChange:i,onToChange:c,onClear:d,onRefresh:o,loading:x}){let u=(0,a.useMemo)(()=>{let t=new Map;for(let s of e)t.has(s.playerId)||t.set(s.playerId,s.playerName);return Array.from(t.entries())},[e]);return r.jsx("section",{className:"rounded-lg border bg-white p-4 shadow-sm",children:(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsxs)("label",{className:"grid gap-1 text-sm text-gray-700",children:["Jugador",(0,r.jsxs)("select",{value:t,onChange:e=>s(e.target.value),className:"rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-gray-500 focus:outline-none",children:[r.jsx("option",{value:"all",children:"Todos"}),u.map(([e,t])=>r.jsx("option",{value:e,children:t},e))]})]}),(0,r.jsxs)("label",{className:"grid gap-1 text-sm text-gray-700",children:["Desde",r.jsx("input",{type:"date",value:n,max:l||void 0,onChange:e=>i(e.target.value),className:"rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-gray-500 focus:outline-none"})]}),(0,r.jsxs)("label",{className:"grid gap-1 text-sm text-gray-700",children:["Hasta",r.jsx("input",{type:"date",value:l,min:n||void 0,onChange:e=>c(e.target.value),className:"rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-gray-500 focus:outline-none"})]}),(0,r.jsxs)("div",{className:"flex items-end gap-2",children:[r.jsx("button",{type:"button",onClick:o,disabled:x,className:"flex-1 rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-blue-500 disabled:cursor-not-allowed disabled:bg-blue-300",children:x?"Actualizando…":"Actualizar"}),r.jsx("button",{type:"button",onClick:d,disabled:x,className:"rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-700 transition hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-60",children:"Limpiar"})]})]})})}function o({entries:e,loading:t}){return e.length?r.jsx("section",{className:"overflow-hidden rounded-lg border bg-white shadow-sm",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-xs uppercase tracking-wide text-gray-500",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left",children:"Jugador"}),r.jsx("th",{className:"px-4 py-3 text-left",children:"Tema"}),r.jsx("th",{className:"px-4 py-3 text-left",children:"Mensaje"}),r.jsx("th",{className:"px-4 py-3 text-left",children:"Valoraci\xf3n"}),r.jsx("th",{className:"px-4 py-3 text-left",children:"Enviado por"}),r.jsx("th",{className:"px-4 py-3 text-left",children:"Fecha"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100 bg-white",children:e.map(e=>(0,r.jsxs)("tr",{className:"align-top",children:[r.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:e.playerName}),r.jsx("td",{className:"px-4 py-3 text-gray-700",children:e.subject??"—"}),r.jsx("td",{className:"px-4 py-3 text-gray-700",children:r.jsx("p",{className:"whitespace-pre-line text-sm leading-5 text-gray-700",children:e.text})}),r.jsx("td",{className:"px-4 py-3 text-gray-700",children:e.rating?`${e.rating}/5`:r.jsx("span",{className:"text-gray-400",children:"Sin dato"})}),r.jsx("td",{className:"px-4 py-3 text-gray-700",children:e.createdByName}),r.jsx("td",{className:"px-4 py-3 text-gray-600",children:function(e){try{return i.format(new Date(e))}catch(t){return e}}(e.createdAt)})]},e.id))})]})}):r.jsx("div",{className:"rounded-lg border border-dashed bg-white p-6 text-center text-sm text-gray-500",children:t?"Cargando feedback…":"Todav\xeda no hay mensajes registrados."})}},94340:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var r=s(10326);s(17577);var a=s(90434),n=s(35047),l=s(77109),i=s(82152);function c({href:e,children:t,active:s,soon:n}){let l="block rounded-md px-2 py-1.5 text-sm transition";return e?r.jsx(a.default,{href:e,className:`${l} ${s?"bg-black text-white":"hover:bg-gray-100"}`,children:t}):(0,r.jsxs)("span",{className:`${l} text-gray-400 cursor-not-allowed`,children:[t," ",n&&r.jsx("small",{className:"ml-1",children:"PRONTO"})]})}function d({children:e}){let t=(0,n.usePathname)(),s=e=>t===e||t?.startsWith(e+"/");return(0,r.jsxs)("div",{className:"min-h-screen flex bg-gray-50",children:[(0,r.jsxs)("aside",{className:"w-64 shrink-0 border-r bg-white p-3 space-y-3",children:[r.jsx(i.default,{className:"w-full"}),r.jsx("div",{className:"px-2 py-1 text-[10px] font-semibold text-gray-500",children:"INICIO"}),r.jsx("ul",{className:"space-y-0.5 mb-2",children:r.jsx("li",{children:r.jsx(c,{href:"/ct",active:"/ct"===t,children:"Dashboard / Inicio r\xe1pido"})})}),r.jsx("div",{className:"px-2 py-1 text-[10px] font-semibold text-gray-500",children:"MONITOREO"}),(0,r.jsxs)("ul",{className:"space-y-0.5 mb-2",children:[r.jsx("li",{children:r.jsx(c,{href:"/ct/metrics/wellness",active:s("/ct/metrics/wellness"),children:"Wellness"})}),r.jsx("li",{children:r.jsx(c,{href:"/ct/metrics/rpe",active:s("/ct/metrics/rpe"),children:"Rpe"})}),r.jsx("li",{children:r.jsx(c,{href:"/ct/injuries",active:s("/ct/injuries"),children:"Lesionados"})})]}),r.jsx("div",{className:"px-2 py-1 text-[10px] font-semibold text-gray-500",children:"PLANIFICACI\xd3N"}),(0,r.jsxs)("ul",{className:"space-y-0.5 mb-2",children:[r.jsx("li",{children:r.jsx(c,{href:"/ct/plan-semanal",active:s("/ct/plan-semanal"),children:"Plan semanal (Editor)"})}),r.jsx("li",{children:r.jsx(c,{href:"/ct/sessions",active:s("/ct/sessions"),children:"Sesiones"})}),r.jsx("li",{children:r.jsx(c,{href:"/ct/exercises",active:s("/ct/exercises"),children:"Ejercicios"})})]}),r.jsx("div",{className:"px-2 py-1 text-[10px] font-semibold text-gray-500",children:"T\xc9CNICA"}),(0,r.jsxs)("ul",{className:"space-y-0.5 mb-2",children:[r.jsx("li",{children:r.jsx(c,{href:"/ct/rivales",active:s("/ct/rivales"),children:"Rivales / Plan de partido"})}),r.jsx("li",{children:r.jsx(c,{href:"/ct/scouting",active:s("/ct/scouting"),children:"Scouting"})})]}),r.jsx("div",{className:"px-2 py-1 text-[10px] font-semibold text-gray-500",children:"SALIR"}),r.jsx("ul",{className:"space-y-0.5",children:r.jsx("li",{children:r.jsx("button",{"aria-label":"Cerrar sesi\xf3n",onClick:()=>(0,l.signOut)({callbackUrl:"/login"}),className:"block w-full text-left rounded-md px-2 py-1.5 text-sm transition hover:bg-gray-100",children:"Cerrar sesi\xf3n"})})})]}),r.jsx("main",{className:"flex-1 p-3 md:p-4",children:e})]})}},42126:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var r=s(10326),a=s(77109);function n({children:e}){return r.jsx(a.SessionProvider,{children:e})}},82152:(e,t,s)=>{"use strict";s.d(t,{default:()=>i});var r=s(10326),a=s(17577),n=s(77109),l=s(35047);function i({className:e,label:t="Equipo"}){let{data:s,status:i,update:c}=(0,n.useSession)(),d=(0,l.useRouter)(),o=(0,a.useMemo)(()=>s?.user?.teamIds??[],[s?.user?.teamIds]);s?.user?.currentTeamId;let[x,u]=(0,a.useState)([]),[m,p]=(0,a.useState)(""),[h,g]=(0,a.useState)(!1),[b,y]=(0,a.useState)(!1),[f,j]=(0,a.useState)(null),v=o.length>0;if((0,a.useMemo)(()=>v?[...o].sort().join("|"):"",[v,o]),"loading"===i||!v)return null;async function N(e){let t=e.target.value;if(t&&t!==m){p(t),y(!0),j(null);try{document.cookie=`ctb_team=${encodeURIComponent(t)}; path=/; max-age=2592000; SameSite=Lax`;let e=await fetch("/api/session/team",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:t})});if(!e.ok){let t=await e.json().catch(()=>null);throw Error(t?.error||`Error ${e.status}`)}await c?.(),d.refresh()}catch(e){p(m),j(e?.message||"No se pudo cambiar de equipo.")}finally{y(!1)}}}let w=["flex flex-col gap-1 text-xs",e].filter(Boolean).join(" ");return 0===x.length?null:(0,r.jsxs)("div",{className:w,children:[r.jsx("label",{className:"text-[10px] font-semibold uppercase text-gray-500",children:t}),r.jsx("select",{value:m,onChange:N,disabled:h||b,className:"w-full rounded-md border px-2 py-1.5 text-sm disabled:opacity-60",children:x.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))}),f?r.jsx("span",{className:"text-[11px] text-red-600",children:f}):null]})}},30194:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>n,default:()=>i});var r=s(68570);let a=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/feedback/page.tsx`),{__esModule:n,$$typeof:l}=a;a.default;let i=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/feedback/page.tsx#default`)},66382:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>n,default:()=>i});var r=s(68570);let a=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/layout.tsx`),{__esModule:n,$$typeof:l}=a;a.default;let i=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/layout.tsx#default`)},15495:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o,metadata:()=>d});var r=s(19510);s(5023);var a=s(68570);let n=(0,a.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/providers.tsx`),{__esModule:l,$$typeof:i}=n;n.default;let c=(0,a.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/providers.tsx#default`),d={title:"ctbrain",description:"App"};function o({children:e}){return r.jsx("html",{lang:"es",children:r.jsx("body",{children:r.jsx(c,{children:e})})})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8948,1159,9404],()=>s(67942));module.exports=r})();