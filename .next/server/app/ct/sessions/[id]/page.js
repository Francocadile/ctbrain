(()=>{var e={};e.id=383,e.ids=[383],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7381:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>d,routeModule:()=>u,tree:()=>l}),a(6013),a(66382),a(15495),a(35866);var r=a(23191),s=a(88716),n=a(37922),i=a.n(n),c=a(95231),o={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>c[e]);a.d(t,o);let l=["",{children:["ct",{children:["sessions",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,6013)),"/Users/Fran/ctbrain-14/src/app/ct/sessions/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,66382)),"/Users/Fran/ctbrain-14/src/app/ct/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,15495)),"/Users/Fran/ctbrain-14/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/Fran/ctbrain-14/src/app/ct/sessions/[id]/page.tsx"],p="/ct/sessions/[id]/page",x={require:a,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/ct/sessions/[id]/page",pathname:"/ct/sessions/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},29821:(e,t,a)=>{Promise.resolve().then(a.bind(a,26386))},26386:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var r=a(10326),s=a(77626),n=a.n(s),i=a(17577),c=a(35047),o=a(67317),l=a(48217);async function d(e){try{let t=await fetch(`/api/exercises/import?sessionId=${encodeURIComponent(e)}`,{method:"POST"});if(!t.ok)return{ok:!1,created:0,updated:0};return await t.json()}catch{return{ok:!1,created:0,updated:0}}}function p(){let{id:e}=(0,c.useParams)(),[t,a]=(0,i.useState)(!0),[s,p]=(0,i.useState)(!1),[x,u]=(0,i.useState)(!0),[m,h]=(0,i.useState)(null),[g,y]=(0,i.useState)(""),[j,f]=(0,i.useState)([]),[b,v]=(0,i.useState)([]),N=(0,i.useMemo)(()=>(function(e){let t=(e||"").trimStart().match(/^\[GRID:(morning|afternoon):(.+?)\]\s*\|\s*(\d{4}-\d{2}-\d{2})/i);return{turn:t?.[1]||"",row:t?.[2]||"",ymd:t?.[3]||""}})("string"==typeof m?.description?m?.description:""),[m?.description]);function w(e,t){f(a=>{let r=[...a];return r[e]={...r[e],...t},r})}async function S(){if(m){p(!0);try{let e=function(e,t){let a=function(e){let t=JSON.stringify(e);try{return btoa(unescape(encodeURIComponent(t)))}catch{return btoa(t)}}(t),r=(e||"").trimEnd();return`${r}

[EXERCISES] ${a}`}(g||m.description||"",j);await (0,o.CT)(m.id,{title:m.title??"",description:e,date:m.date}),d(m.id).catch(()=>{}),u(!1),alert("Guardado")}catch(e){console.error(e),alert(e?.message||"No se pudo guardar")}finally{p(!1)}}}if(t)return r.jsx("div",{className:"p-6 text-gray-500",children:"Cargando…"});if(!m)return r.jsx("div",{className:"p-6",children:r.jsx("h1",{className:"text-xl font-semibold",children:"Sesi\xf3n no encontrada"})});let C=x?"":"bg-gray-50 text-gray-600 cursor-not-allowed";return(0,r.jsxs)("div",{id:"print-root",className:"jsx-54a3523ecaedcc0 p-4 md:p-6 space-y-4 print:!p-2",children:[(0,r.jsxs)("header",{className:"jsx-54a3523ecaedcc0 flex flex-col gap-2 md:flex-row md:items-center md:justify-between print:hidden",children:[(0,r.jsxs)("div",{className:"jsx-54a3523ecaedcc0",children:[(0,r.jsxs)("h1",{className:"jsx-54a3523ecaedcc0 text-lg md:text-xl font-bold",children:["Editor de ejercicio(s) — ",N.row||"Bloque"," \xb7"," ","morning"===N.turn?"Ma\xf1ana":"afternoon"===N.turn?"Tarde":"—"]}),(0,r.jsxs)("p",{className:"jsx-54a3523ecaedcc0 text-xs md:text-sm text-gray-500",children:["D\xeda: ",N.ymd||"—"," \xb7 Tipo: ",m.type]})]}),(0,r.jsxs)("div",{className:"jsx-54a3523ecaedcc0 flex items-center gap-2",children:[N.ymd&&N.turn&&r.jsx("a",{href:`/ct/sessions/by-day/${N.ymd}/${N.turn}?focus=${encodeURIComponent(N.row||"")}`,className:"jsx-54a3523ecaedcc0 px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"← Volver a sesi\xf3n"}),r.jsx("a",{href:"/ct/dashboard",className:"jsx-54a3523ecaedcc0 px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"Dashboard"}),r.jsx("a",{href:"/ct/plan-semanal",className:"jsx-54a3523ecaedcc0 px-3 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"✏️ Editor semanal"}),x?r.jsx("button",{onClick:S,disabled:s,className:`jsx-54a3523ecaedcc0 px-3 py-1.5 rounded-xl text-xs ${s?"bg-gray-200 text-gray-500":"bg-black text-white hover:opacity-90"}`,children:s?"Guardando…":"Guardar y bloquear"}):r.jsx("button",{onClick:()=>u(!0),className:"jsx-54a3523ecaedcc0 px-3 py-1.5 rounded-xl border text-xs hover:bg-gray-50",children:"✏️ Editar"}),r.jsx("button",{onClick:()=>window.print(),title:"Imprimir",className:"jsx-54a3523ecaedcc0 px-3 py-1.5 rounded-xl border text-xs hover:bg-gray-50",children:"\uD83D\uDDA8️ Imprimir"})]})]}),(0,r.jsxs)("div",{className:"jsx-54a3523ecaedcc0 space-y-4",children:[j.map((e,t)=>(0,r.jsxs)("section",{id:`ex-${t}`,className:"jsx-54a3523ecaedcc0 rounded-2xl border bg-white shadow-sm overflow-hidden print:page",children:[(0,r.jsxs)("div",{className:"jsx-54a3523ecaedcc0 flex items-center justify-between bg-gray-50 px-3 py-2 border-b",children:[r.jsx("input",{placeholder:`EJERCICIO #${t+1} — T\xedtulo`,value:e.title,onChange:e=>w(t,{title:e.target.value}),disabled:!x,className:`jsx-54a3523ecaedcc0 text-[12px] font-semibold uppercase tracking-wide w-full max-w-[360px] ${C}`}),x&&r.jsx("button",{type:"button",onClick:()=>{f(e=>e.filter((e,a)=>a!==t))},className:"jsx-54a3523ecaedcc0 ml-2 text-[11px] rounded-lg border px-2 py-0.5 hover:bg-gray-50",children:"Eliminar"})]}),(0,r.jsxs)("div",{className:"jsx-54a3523ecaedcc0 p-3 grid md:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{className:"jsx-54a3523ecaedcc0 space-y-2",children:[r.jsx("label",{className:"jsx-54a3523ecaedcc0 text-[11px] text-gray-500",children:"Tipo de ejercicio"}),r.jsx("div",{className:"jsx-54a3523ecaedcc0 flex items-center gap-1",children:(0,r.jsxs)("select",{value:e.kind||"",onChange:e=>{let a=e.target.value;if("__add__"===a){let e=function(){let e=prompt("Nuevo tipo de ejercicio:");if(!e)return;let t=e.trim();if(t)return(async()=>{v(await (0,l.hV)(t))})(),t}();e&&w(t,{kind:e});return}if("__manage__"===a){(async()=>{let e=prompt("Gestionar tipos (una l\xednea por opci\xf3n). Borr\xe1 para eliminar, edit\xe1 para renombrar:",b.join("\n"));if(null===e)return;let t=e.split("\n").map(e=>e.trim()).filter(Boolean);v(await (0,l.TL)(t))})();return}w(t,{kind:a})},disabled:!x,className:`jsx-54a3523ecaedcc0 w-full rounded-md border px-2 py-1.5 text-sm ${C}`,children:[r.jsx("option",{value:"",className:"jsx-54a3523ecaedcc0",children:"— Seleccionar —"}),b.map(e=>r.jsx("option",{value:e,className:"jsx-54a3523ecaedcc0",children:e},e)),r.jsx("option",{value:"__add__",className:"jsx-54a3523ecaedcc0",children:"➕ Agregar…"}),r.jsx("option",{value:"__manage__",className:"jsx-54a3523ecaedcc0",children:"⚙️ Gestionar…"})]})})]}),(0,r.jsxs)("div",{className:"jsx-54a3523ecaedcc0 space-y-2",children:[r.jsx("label",{className:"jsx-54a3523ecaedcc0 text-[11px] text-gray-500",children:"Espacio"}),r.jsx("input",{value:e.space,onChange:e=>w(t,{space:e.target.value}),placeholder:"Mitad de cancha",disabled:!x,className:`jsx-54a3523ecaedcc0 w-full rounded-md border px-2 py-1.5 text-sm ${C}`})]}),(0,r.jsxs)("div",{className:"jsx-54a3523ecaedcc0 space-y-2",children:[r.jsx("label",{className:"jsx-54a3523ecaedcc0 text-[11px] text-gray-500",children:"N\xb0 de jugadores"}),r.jsx("input",{value:e.players,onChange:e=>w(t,{players:e.target.value}),placeholder:"22 jugadores",disabled:!x,className:`jsx-54a3523ecaedcc0 w-full rounded-md border px-2 py-1.5 text-sm ${C}`})]}),(0,r.jsxs)("div",{className:"jsx-54a3523ecaedcc0 space-y-2",children:[r.jsx("label",{className:"jsx-54a3523ecaedcc0 text-[11px] text-gray-500",children:"Duraci\xf3n"}),r.jsx("input",{value:e.duration,onChange:e=>w(t,{duration:e.target.value}),placeholder:"10 minutos",disabled:!x,className:`jsx-54a3523ecaedcc0 w-full rounded-md border px-2 py-1.5 text-sm ${C}`})]}),(0,r.jsxs)("div",{className:"jsx-54a3523ecaedcc0 space-y-2 md:col-span-2",children:[r.jsx("label",{className:"jsx-54a3523ecaedcc0 text-[11px] text-gray-500",children:"Descripci\xf3n"}),r.jsx("textarea",{value:e.description,onChange:e=>w(t,{description:e.target.value}),placeholder:"Consignas, series, repeticiones, variantes...",disabled:!x,className:`jsx-54a3523ecaedcc0 w-full rounded-md border px-2 py-1.5 text-sm min-h-[120px] ${C}`})]}),(0,r.jsxs)("div",{className:"jsx-54a3523ecaedcc0 space-y-2 md:col-span-2",children:[(0,r.jsxs)("div",{className:"jsx-54a3523ecaedcc0 flex items-center justify-between",children:[r.jsx("label",{className:"jsx-54a3523ecaedcc0 text-[11px] text-gray-500",children:"Imagen (URL)"}),!x&&r.jsx("span",{className:"jsx-54a3523ecaedcc0 text-[10px] text-gray-400",children:"Bloqueado"})]}),r.jsx("input",{value:e.imageUrl,onChange:e=>w(t,{imageUrl:e.target.value}),placeholder:"https://...",disabled:!x,className:`jsx-54a3523ecaedcc0 w-full rounded-md border px-2 py-1.5 text-sm ${C}`}),e.imageUrl?r.jsx("div",{className:"jsx-54a3523ecaedcc0 mt-2",children:r.jsx("img",{src:e.imageUrl,alt:"Vista previa",className:"jsx-54a3523ecaedcc0 max-h-80 rounded-lg border object-contain"})}):null]})]})]},t)),x&&r.jsx("div",{className:"jsx-54a3523ecaedcc0 print:hidden",children:r.jsx("button",{type:"button",onClick:function(){f(e=>[...e,{title:"",kind:"",space:"",players:"",duration:"",description:"",imageUrl:""}])},className:"jsx-54a3523ecaedcc0 rounded-xl border px-3 py-1.5 text-xs hover:bg-gray-50",children:"+ Agregar ejercicio"})})]}),r.jsx(n(),{id:"54a3523ecaedcc0",children:'@media print{@page{size:A4 portrait;margin:10mm}body{-webkit-print-color-adjust:exact;color-adjust:exact;print-color-adjust:exact}body *{visibility:hidden!important}#print-root,#print-root *{visibility:visible!important}#print-root{position:absolute;inset:0;margin:0!important;padding:0!important}nav,aside,header[role="banner"],.sidebar,.app-sidebar,.print\\\\:hidden{display:none!important}a[href]:after{content:""}.print\\\\:page{page-break-after:always}}'})]})}},67317:(e,t,a)=>{"use strict";function r(e){let t=e.getUTCFullYear(),a=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0");return`${t}-${a}-${r}`}function s(e){let t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())),a=t.getUTCDay()||7;return 1!==a&&t.setUTCDate(t.getUTCDate()-(a-1)),t.setUTCHours(0,0,0,0),t}async function n({start:e}){let t=await fetch(`/api/sessions?start=${encodeURIComponent(e)}`,{cache:"no-store"}),a=await t.json();if(!t.ok)throw Error(a?.error||"No se pudo cargar la semana");return a}async function i(e){let t=await fetch("/api/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();if(!t.ok)throw Error(a?.error||"Error al crear la sesi\xf3n");return a}async function c(e,t){let a=await fetch(`/api/sessions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await a.json();if(!a.ok)throw Error(r?.error||"Error al actualizar la sesi\xf3n");return r}async function o(e){let t=await fetch(`/api/sessions/${e}`,{method:"DELETE"}),a=await t.json();if(!t.ok)throw Error(a?.error||"Error al borrar la sesi\xf3n");return a}a.d(t,{$9:()=>s,CT:()=>c,SO:()=>o,VA:()=>r,ed:()=>i,tO:()=>n})},48217:(e,t,a)=>{"use strict";a.d(t,{AA:()=>p,Om:()=>x,TL:()=>l,hV:()=>o,oD:()=>d});let r="ct_exercise_kinds",s="ct_rivals",n=["Rueda de pases","Circuito t\xe9cnico","SSG","MSG","LSG"];async function i(e,t,a=6e3){try{let r=e.startsWith("http")?e:`${e}`,s=new AbortController,n=setTimeout(()=>s.abort(),a),i=await fetch(r,{...t,signal:s.signal,cache:"no-store"});if(clearTimeout(n),!i.ok)return null;return await i.json()}catch{return null}}async function c(){let e=await i("/api/exercise-kinds");if(e?.data?.length){try{localStorage.setItem(r,JSON.stringify(e.data))}catch{}return e.data}return n}async function o(e){let t=(e||"").trim();if(!t)return c();let a=await i("/api/exercise-kinds",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})});if(a?.data?.length){try{localStorage.setItem(r,JSON.stringify(a.data))}catch{}return a.data}let s=await c();s.includes(t)||s.push(t);try{localStorage.setItem(r,JSON.stringify(s))}catch{}return s}async function l(e){let t=Array.from(new Set((e||[]).map(e=>e.trim()).filter(Boolean))),a=await i("/api/exercise-kinds",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({names:t})}),s=a?.data?.length?a.data:t;try{localStorage.setItem(r,JSON.stringify(s))}catch{}return s}async function d(){let e=await i("/api/ct/rivales");if(e?.data){try{localStorage.setItem(s,JSON.stringify(e.data))}catch{}return e.data}try{let e=localStorage.getItem(s);if(e)return JSON.parse(e)}catch{}return[]}async function p(e){let t={id:e.id??null,name:e.name.trim(),logoUrl:e.logoUrl??null,coach:e.coach??null,baseSystem:e.baseSystem??null,nextMatchDate:e.nextMatchDate??null,nextMatchCompetition:e.nextMatchCompetition??null},a=e.id?`/api/ct/rivales/${encodeURIComponent(e.id)}`:"/api/ct/rivales",r=e.id?"PUT":"POST",n=await i(a,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(n?.data){let e=await d(),t=e.findIndex(e=>e.id===n.data.id);t>=0?e[t]=n.data:e.push(n.data);try{localStorage.setItem(s,JSON.stringify(e))}catch{}return n.data}let c=await d(),o=e.id??("undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():`id_${Date.now()}_${Math.random().toString(16).slice(2)}`),l={id:o,name:t.name,logoUrl:t.logoUrl,coach:t.coach??null,baseSystem:t.baseSystem??null,nextMatchDate:t.nextMatchDate??null,nextMatchCompetition:t.nextMatchCompetition??null},p=c.findIndex(e=>e.id===o);p>=0?c[p]=l:c.push(l);try{localStorage.setItem(s,JSON.stringify(c))}catch{}return l}async function x(e){let t=await i(`/api/ct/rivales/${encodeURIComponent(e)}`,{method:"DELETE"});if(t?.ok){let t=(await d()).filter(t=>t.id!==e);try{localStorage.setItem(s,JSON.stringify(t))}catch{}return{ok:!0}}let a=(await d()).filter(t=>t.id!==e);try{localStorage.setItem(s,JSON.stringify(a))}catch{}return{ok:!0}}},6013:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>c});var r=a(68570);let s=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/sessions/[id]/page.tsx`),{__esModule:n,$$typeof:i}=s;s.default;let c=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/sessions/[id]/page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[8948,1159,9404,2473],()=>a(7381));module.exports=r})();