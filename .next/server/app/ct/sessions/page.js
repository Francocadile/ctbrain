(()=>{var e={};e.id=6128,e.ids=[6128],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},58704:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),s(84560),s(66382),s(15495),s(35866);var r=s(23191),a=s(88716),n=s(37922),i=s.n(n),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["ct",{children:["sessions",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,84560)),"/Users/Fran/ctbrain-14/src/app/ct/sessions/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,66382)),"/Users/Fran/ctbrain-14/src/app/ct/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,15495)),"/Users/Fran/ctbrain-14/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/Fran/ctbrain-14/src/app/ct/sessions/page.tsx"],u="/ct/sessions/page",x={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/ct/sessions/page",pathname:"/ct/sessions",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},54630:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},97992:(e,t,s)=>{Promise.resolve().then(s.bind(s,94340))},48227:(e,t,s)=>{Promise.resolve().then(s.bind(s,77646))},14497:(e,t,s)=>{Promise.resolve().then(s.bind(s,42126))},90434:(e,t,s)=>{"use strict";s.d(t,{default:()=>a.a});var r=s(79404),a=s.n(r)},35047:(e,t,s)=>{"use strict";var r=s(77389);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},94340:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(10326);s(17577);var a=s(90434),n=s(35047),i=s(77109),l=s(82152);function o({href:e,children:t,active:s,soon:n}){let i="block rounded-md px-2 py-1.5 text-sm transition";return e?r.jsx(a.default,{href:e,className:`${i} ${s?"bg-black text-white":"hover:bg-gray-100"}`,children:t}):(0,r.jsxs)("span",{className:`${i} text-gray-400 cursor-not-allowed`,children:[t," ",n&&r.jsx("small",{className:"ml-1",children:"PRONTO"})]})}function c({children:e}){let t=(0,n.usePathname)(),s=e=>t===e||t?.startsWith(e+"/");return(0,r.jsxs)("div",{className:"min-h-screen flex bg-gray-50",children:[(0,r.jsxs)("aside",{className:"w-64 shrink-0 border-r bg-white p-3 space-y-3",children:[r.jsx(l.default,{className:"w-full"}),r.jsx("div",{className:"px-2 py-1 text-[10px] font-semibold text-gray-500",children:"INICIO"}),r.jsx("ul",{className:"space-y-0.5 mb-2",children:r.jsx("li",{children:r.jsx(o,{href:"/ct",active:"/ct"===t,children:"Dashboard / Inicio r\xe1pido"})})}),r.jsx("div",{className:"px-2 py-1 text-[10px] font-semibold text-gray-500",children:"MONITOREO"}),(0,r.jsxs)("ul",{className:"space-y-0.5 mb-2",children:[r.jsx("li",{children:r.jsx(o,{href:"/ct/metrics/wellness",active:s("/ct/metrics/wellness"),children:"Wellness"})}),r.jsx("li",{children:r.jsx(o,{href:"/ct/metrics/rpe",active:s("/ct/metrics/rpe"),children:"Rpe"})}),r.jsx("li",{children:r.jsx(o,{href:"/ct/injuries",active:s("/ct/injuries"),children:"Lesionados"})})]}),r.jsx("div",{className:"px-2 py-1 text-[10px] font-semibold text-gray-500",children:"PLANIFICACI\xd3N"}),(0,r.jsxs)("ul",{className:"space-y-0.5 mb-2",children:[r.jsx("li",{children:r.jsx(o,{href:"/ct/plan-semanal",active:s("/ct/plan-semanal"),children:"Plan semanal (Editor)"})}),r.jsx("li",{children:r.jsx(o,{href:"/ct/sessions",active:s("/ct/sessions"),children:"Sesiones"})}),r.jsx("li",{children:r.jsx(o,{href:"/ct/exercises",active:s("/ct/exercises"),children:"Ejercicios"})})]}),r.jsx("div",{className:"px-2 py-1 text-[10px] font-semibold text-gray-500",children:"T\xc9CNICA"}),(0,r.jsxs)("ul",{className:"space-y-0.5 mb-2",children:[r.jsx("li",{children:r.jsx(o,{href:"/ct/rivales",active:s("/ct/rivales"),children:"Rivales / Plan de partido"})}),r.jsx("li",{children:r.jsx(o,{href:"/ct/scouting",active:s("/ct/scouting"),children:"Scouting"})})]}),r.jsx("div",{className:"px-2 py-1 text-[10px] font-semibold text-gray-500",children:"SALIR"}),r.jsx("ul",{className:"space-y-0.5",children:r.jsx("li",{children:r.jsx("button",{"aria-label":"Cerrar sesi\xf3n",onClick:()=>(0,i.signOut)({callbackUrl:"/login"}),className:"block w-full text-left rounded-md px-2 py-1.5 text-sm transition hover:bg-gray-100",children:"Cerrar sesi\xf3n"})})})]}),r.jsx("main",{className:"flex-1 p-3 md:p-4",children:e})]})}},77646:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var r=s(10326),a=s(17577),n=s(67317);let i="NOMBRE SESI\xd3N",l=/^\[GRID:(morning|afternoon):(.+?)\]/i;function o(e,t,s){let r=function(e){let t=(e||"").trim();if(!t)return{};let s=t.match(l);return s?{turn:s[1],row:(s[2]||"").trim()}:{}}(e.description);return r.turn===t&&(r.row||"").toUpperCase()===s.toUpperCase()}function c(e){return new Date(`${e}T00:00:00.000Z`).toLocaleDateString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"})}function d(){let[e,t]=(0,a.useState)(()=>(0,n.$9)(new Date)),[s,l]=(0,a.useState)({}),[d,u]=(0,a.useState)(""),[x,m]=(0,a.useState)(""),[p,h]=(0,a.useState)(!0),[f,g]=(0,a.useState)(""),y=(0,a.useMemo)(()=>{let e=[];if(!d)return e;for(let t of Array.from({length:7},(e,t)=>{let s=new Date(`${d}T00:00:00.000Z`);return s.setUTCDate(s.getUTCDate()+t),(0,n.VA)(s)})){let r=s[t]||[];["morning","afternoon"].forEach(s=>{let a=r.find(e=>o(e,s,i));if(!a)return;let n=(r.find(e=>o(e,s,"LUGAR"))?.title||"").trim(),l=(r.find(e=>o(e,s,"HORA"))?.title||"").trim();e.push({id:a.id,title:(a.title||"").trim()||"(Sin nombre)",ymd:t,turn:s,dateISO:a.date,lugar:n,hora:l})})}return e.sort((e,t)=>e.ymd!==t.ymd?e.ymd.localeCompare(t.ymd):e.turn!==t.turn?"morning"===e.turn?-1:1:0)},[s,d]),j=(0,a.useMemo)(()=>f?y.filter(e=>e.ymd===f):y,[y,f]);return(0,r.jsxs)("div",{className:"max-w-5xl mx-auto p-6 space-y-6",children:[(0,r.jsxs)("header",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Sesiones"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Basadas en la fila “",i,"” del editor semanal."]}),(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:["Semana ",d?c(d):"—"," →"," ",x?c(x):"—"," (Lun→Dom)"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"inline-flex rounded-xl border overflow-hidden",children:[r.jsx("button",{onClick:()=>t(e=>{let t=new Date(e);return t.setUTCDate(t.getUTCDate()-7),t}),className:"px-2.5 py-1.5 text-xs hover:bg-gray-50",title:"Semana anterior",children:"◀ Semana anterior"}),r.jsx("div",{className:"w-px bg-gray-200"}),r.jsx("button",{onClick:()=>t((0,n.$9)(new Date)),className:"px-2.5 py-1.5 text-xs hover:bg-gray-50",title:"Volver a esta semana",children:"Hoy"}),r.jsx("div",{className:"w-px bg-gray-200"}),r.jsx("button",{onClick:()=>t(e=>{let t=new Date(e);return t.setUTCDate(t.getUTCDate()+7),t}),className:"px-2.5 py-1.5 text-xs hover:bg-gray-50",title:"Semana siguiente ▶",children:"Semana siguiente ▶"})]}),r.jsx("input",{type:"date",value:f,onChange:e=>(function(e){if(g(e),!e)return;let s=new Date(`${e}T00:00:00.000Z`);t((0,n.$9)(s))})(e.target.value),className:"rounded-xl border px-2 py-1.5 text-sm",title:"Filtrar por fecha"}),r.jsx("button",{onClick:()=>g(""),className:"text-sm px-3 py-1.5 rounded-xl border hover:bg-gray-50",disabled:!f,title:"Quitar filtro",children:"Limpiar"})]})]}),p?r.jsx("div",{className:"text-sm text-gray-500",children:"Cargando sesiones…"}):0===j.length?r.jsx("div",{className:"rounded-lg border p-6 text-sm text-gray-600",children:"No hay sesiones para mostrar en esta semana/fecha."}):r.jsx("ul",{className:"space-y-3",children:j.map(e=>{let t=`/ct/sessions/by-day/${e.ymd}/${e.turn}`;return(0,r.jsxs)("li",{className:"rounded-xl border p-3 shadow-sm flex items-start justify-between bg-white",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-semibold text-[15px]",children:r.jsx("a",{href:t,className:"hover:underline",title:"Abrir sesi\xf3n (d\xeda/turno)",children:e.title})}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 mt-1 space-x-3",children:[(0,r.jsxs)("span",{children:["\uD83D\uDCC5 ",new Date(e.dateISO).toLocaleString()]}),(0,r.jsxs)("span",{children:["\uD83D\uDD51 ","morning"===e.turn?"Ma\xf1ana":"Tarde"]}),e.hora&&(0,r.jsxs)("span",{children:["⏰ ",e.hora]}),e.lugar&&(0,r.jsxs)("span",{children:["\uD83D\uDCCD ",e.lugar]})]})]}),r.jsx("a",{href:t,className:"text-xs px-3 py-1.5 rounded-lg border hover:bg-gray-50",title:"Ver sesi\xf3n (d\xeda/turno)",children:"Ver sesi\xf3n"})]},e.id)})})]})}},42126:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var r=s(10326),a=s(77109);function n({children:e}){return r.jsx(a.SessionProvider,{children:e})}},82152:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var r=s(10326),a=s(17577),n=s(77109),i=s(35047);function l({className:e,label:t="Equipo"}){let{data:s,status:l,update:o}=(0,n.useSession)(),c=(0,i.useRouter)(),d=(0,a.useMemo)(()=>s?.user?.teamIds??[],[s?.user?.teamIds]);s?.user?.currentTeamId;let[u,x]=(0,a.useState)([]),[m,p]=(0,a.useState)(""),[h,f]=(0,a.useState)(!1),[g,y]=(0,a.useState)(!1),[j,b]=(0,a.useState)(null),v=d.length>0;if((0,a.useMemo)(()=>v?[...d].sort().join("|"):"",[v,d]),"loading"===l||!v)return null;async function N(e){let t=e.target.value;if(t&&t!==m){p(t),y(!0),b(null);try{document.cookie=`ctb_team=${encodeURIComponent(t)}; path=/; max-age=2592000; SameSite=Lax`;let e=await fetch("/api/session/team",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:t})});if(!e.ok){let t=await e.json().catch(()=>null);throw Error(t?.error||`Error ${e.status}`)}await o?.(),c.refresh()}catch(e){p(m),b(e?.message||"No se pudo cambiar de equipo.")}finally{y(!1)}}}let w=["flex flex-col gap-1 text-xs",e].filter(Boolean).join(" ");return 0===u.length?null:(0,r.jsxs)("div",{className:w,children:[r.jsx("label",{className:"text-[10px] font-semibold uppercase text-gray-500",children:t}),r.jsx("select",{value:m,onChange:N,disabled:h||g,className:"w-full rounded-md border px-2 py-1.5 text-sm disabled:opacity-60",children:u.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))}),j?r.jsx("span",{className:"text-[11px] text-red-600",children:j}):null]})}},67317:(e,t,s)=>{"use strict";function r(e){let t=e.getUTCFullYear(),s=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0");return`${t}-${s}-${r}`}function a(e){let t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())),s=t.getUTCDay()||7;return 1!==s&&t.setUTCDate(t.getUTCDate()-(s-1)),t.setUTCHours(0,0,0,0),t}async function n({start:e}){let t=await fetch(`/api/sessions?start=${encodeURIComponent(e)}`,{cache:"no-store"}),s=await t.json();if(!t.ok)throw Error(s?.error||"No se pudo cargar la semana");return s}async function i(e){let t=await fetch("/api/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json();if(!t.ok)throw Error(s?.error||"Error al crear la sesi\xf3n");return s}async function l(e,t){let s=await fetch(`/api/sessions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await s.json();if(!s.ok)throw Error(r?.error||"Error al actualizar la sesi\xf3n");return r}async function o(e){let t=await fetch(`/api/sessions/${e}`,{method:"DELETE"}),s=await t.json();if(!t.ok)throw Error(s?.error||"Error al borrar la sesi\xf3n");return s}s.d(t,{$9:()=>a,CT:()=>l,SO:()=>o,VA:()=>r,ed:()=>i,tO:()=>n})},66382:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>l});var r=s(68570);let a=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/layout.tsx`),{__esModule:n,$$typeof:i}=a;a.default;let l=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/layout.tsx#default`)},84560:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>l});var r=s(68570);let a=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/sessions/page.tsx`),{__esModule:n,$$typeof:i}=a;a.default;let l=(0,r.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/sessions/page.tsx#default`)},15495:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d,metadata:()=>c});var r=s(19510);s(5023);var a=s(68570);let n=(0,a.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/providers.tsx`),{__esModule:i,$$typeof:l}=n;n.default;let o=(0,a.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/providers.tsx#default`),c={title:"ctbrain",description:"App"};function d({children:e}){return r.jsx("html",{lang:"es",children:r.jsx("body",{children:r.jsx(o,{children:e})})})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8948,1159,9404],()=>s(58704));module.exports=r})();