(()=>{var e={};e.id=3074,e.ids=[3074],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},28221:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),r(40210),r(66382),r(15495),r(35866);var a=r(23191),s=r(88716),n=r(37922),l=r.n(n),i=r(95231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let d=["",{children:["ct",{children:["plan-semanal",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,40210)),"/Users/Fran/ctbrain-14/src/app/ct/plan-semanal/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,66382)),"/Users/Fran/ctbrain-14/src/app/ct/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,15495)),"/Users/Fran/ctbrain-14/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/Fran/ctbrain-14/src/app/ct/plan-semanal/page.tsx"],u="/ct/plan-semanal/page",x={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/ct/plan-semanal/page",pathname:"/ct/plan-semanal",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},74066:(e,t,r)=>{Promise.resolve().then(r.bind(r,62835))},62835:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b,dynamic:()=>f});var a=r(10326),s=r(77626),n=r.n(s),l=r(17577),i=r(35047),o=r(67317);async function d(e){if(!(await fetch("/api/planner/labels",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rowLabels:e})})).ok)throw Error("save rowLabels failed")}async function c(){if(!(await fetch("/api/planner/labels",{method:"DELETE"})).ok)throw Error("reset rowLabels failed")}async function u(e){let t=e.split("\n").map(e=>e.trim()).filter(Boolean),r=await fetch("/api/planner/labels",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({places:t})});if(!r.ok)throw Error("save places failed");let a=await r.json();return window.dispatchEvent(new Event("planner-places-updated")),a.places||[]}async function x(){await u("")}var p=r(82882);let m={"PRE ENTREN0":"PRE ENTREN0",FÍSICO:"F\xcdSICO","T\xc9CNICO–T\xc1CTICO":"T\xc9CNICO–T\xc1CTICO",COMPENSATORIO:"COMPENSATORIO"};function g({onAfterChange:e}){let[t,r]=(0,l.useState)(!1),[s,n]=(0,l.useState)({}),[i,o]=(0,l.useState)(""),[g,h]=(0,l.useState)(0),[f,b]=(0,l.useState)({});async function y(){r(!0);try{let t={};for(let e of Object.keys(m)){let r=(s[e]||"").trim();r&&(t[e]=r)}await d(t),window.dispatchEvent(new Event("planner-row-labels-updated")),b({...f,...t}),n({}),e?.(),alert("Nombres guardados.")}catch(e){alert(e?.message||"No se pudieron guardar los nombres")}finally{r(!1)}}async function j(){if(confirm("\xbfRestaurar nombres originales?")){r(!0);try{await c(),n({}),b({}),window.dispatchEvent(new Event("planner-row-labels-updated")),e?.(),alert("Restaurado.")}catch(e){alert(e?.message||"No se pudo resetear")}finally{r(!1)}}}async function v(){r(!0);try{let t=await u(i);o(t.join("\n")),h(t.length),e?.(),alert("Lugares guardados.")}catch(e){alert(e?.message||"No se pudo guardar los lugares")}finally{r(!1)}}async function N(){if(confirm("\xbfVaciar la lista de lugares?")){r(!0);try{await x(),o(""),h(0),e?.(),alert("Lista vaciada.")}catch(e){alert(e?.message||"No se pudo vaciar")}finally{r(!1)}}}return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("section",{className:"rounded-xl border p-3",children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[a.jsx("h3",{className:"text-sm font-semibold",children:"Nombres de filas (tu preferencia)"}),a.jsx(p.Z,{text:"Escrib\xed solo si quer\xe9s cambiar el nombre visible. Se guarda en tu usuario."})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2",children:Object.keys(m).map(e=>(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("label",{className:"text-[11px] text-gray-600",children:["Actual: ",f[e]||e]}),a.jsx("input",{className:"h-9 rounded-md border px-2 text-sm",value:s[e]||"",onChange:t=>n(r=>({...r,[e]:t.target.value})),placeholder:"PRE ENTREN0"===e?"Ej: Activaci\xf3n":"F\xcdSICO"===e?"Ej: Entrada en calor":"T\xc9CNICO–T\xc1CTICO"===e?"Ej: Principal":"Ej: Post entreno"})]},e))}),(0,a.jsxs)("div",{className:"mt-3 flex gap-2",children:[a.jsx("button",{onClick:y,disabled:t,className:"px-3 py-1.5 rounded-lg bg-black text-white text-xs hover:opacity-90",children:"Guardar"}),a.jsx("button",{onClick:j,disabled:t,className:"px-3 py-1.5 rounded-lg border text-xs hover:bg-gray-50",children:"Restaurar originales"})]})]}),(0,a.jsxs)("section",{className:"rounded-xl border p-3",children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[a.jsx("h3",{className:"text-sm font-semibold",children:"Lugares"}),a.jsx(p.Z,{text:"Un lugar por l\xednea. Se usan como sugerencias en el campo 'Lugar' del Editor."}),(0,a.jsxs)("span",{className:"ml-auto text-[11px] text-gray-500",children:[g," guardados"]})]}),a.jsx("div",{className:"text-[11px] text-gray-500 mb-1",children:"Ejemplos:"}),(0,a.jsxs)("div",{className:"rounded-md border p-2 text-[12px] text-gray-600 bg-gray-50 mb-2",children:["Cancha 1",a.jsx("br",{}),"Complejo Deportivo",a.jsx("br",{}),"Gimnasio"]}),a.jsx("textarea",{className:"w-full min-h-[120px] rounded-md border p-2 text-sm",placeholder:"Escrib\xed los lugares (uno por l\xednea)…",value:i,onChange:e=>o(e.target.value)}),(0,a.jsxs)("div",{className:"mt-3 flex gap-2",children:[a.jsx("button",{onClick:v,disabled:t,className:"px-3 py-1.5 rounded-lg bg-black text-white text-xs hover:opacity-90",children:"Guardar lugares"}),a.jsx("button",{onClick:N,disabled:t,className:"px-3 py-1.5 rounded-lg border text-xs hover:bg-gray-50",children:"Vaciar lista"})]})]})]})}var h=r(25074);let f="force-dynamic";function b(){return a.jsx(l.Suspense,{fallback:a.jsx("div",{className:"p-4 text-sm text-gray-500",children:"Cargando…"}),children:a.jsx(I,{})})}let y=["PRE ENTREN0","F\xcdSICO","T\xc9CNICO–T\xc1CTICO","COMPENSATORIO"],j="NOMBRE SESI\xd3N",v=[j,"LUGAR","HORA","VIDEO"],N=e=>`[DAYFLAG:${e}]`,w=(e,t)=>"string"==typeof e.description&&e.description.startsWith(N(t));function C(e){return(e||"").trim().replace(/\|/g,"/")}let E=[{value:"",colorClass:""},{value:"MD+1",colorClass:"bg-blue-50"},{value:"MD+2",colorClass:"bg-yellow-50"},{value:"MD-4",colorClass:"bg-red-50"},{value:"MD-3",colorClass:"bg-orange-50"},{value:"MD-2",colorClass:"bg-green-50"},{value:"MD-1",colorClass:"bg-gray-50"},{value:"MD",colorClass:"bg-amber-50"},{value:"DESCANSO",colorClass:"bg-gray-100"}],T=e=>`[MICRO:${e}]`,$=(e,t)=>"string"==typeof e.description&&e.description.startsWith(T(t));function S(e,t){let r=new Date(e);return r.setUTCDate(r.getUTCDate()+t),r}function O(e,t){let r=new Date(`${e}T00:00:00.000Z`);return r.setUTCHours("morning"===t?9:15,0,0,0),r.toISOString()}function k(e,t){return`[GRID:${e}:${t}]`}function R(e,t,r){return`${e}::${t}::${r}`}function I(){let e=(0,i.useSearchParams)();(0,i.useRouter)();let t="1"===e.get("hideHeader"),r="afternoon"===e.get("turn")?"afternoon":"morning",s="tools"===e.get("pane")?"tools":"editor",[d,c]=(0,l.useState)(r),[u,x]=(0,l.useState)(s),[p,m]=(0,l.useState)(()=>(0,o.$9)(new Date)),[f,b]=(0,l.useState)(!1),[I,D]=(0,l.useState)({}),[P,A]=(0,l.useState)(""),[U,L]=(0,l.useState)(""),[M,_]=(0,l.useState)({}),[B,G]=(0,l.useState)([]);async function F(){try{let e=await fetch("/api/planner/labels",{cache:"no-store"}),t=await e.json();_(t.rowLabels||{}),G(t.places||[])}catch{_({}),G([])}}async function q(e){b(!0);try{let t=(0,o.$9)(e),r=(0,o.VA)(t),a=await (0,o.tO)({start:r});D(a.days),A(a.weekStart),L(a.weekEnd),et({})}catch(e){console.error(e),alert("No se pudo cargar la semana.")}finally{b(!1)}}function H(e){if(0===Object.keys(ee).length)return e();confirm("Ten\xe9s cambios sin guardar. \xbfDescartarlos?")&&e()}let V=(0,l.useMemo)(()=>{if(!P)return[];let e=new Date(`${P}T00:00:00.000Z`);return Array.from({length:7}).map((t,r)=>(0,o.VA)(S(e,r)))},[P]),W=e=>M[e]||e,Z=e=>I[e]||[];function z(e,t,r){return Z(e).find(e=>"string"==typeof e.description&&e.description.startsWith(k(t,r)))}function Y(e,t){return Z(e).find(e=>w(e,t))}function J(e,t){let r=Y(e,t);return function(e){let t=(e||"").trim();if(!t)return{kind:"NONE"};let r=t.split("|").map(e=>(e||"").trim()),a=r[0];if("PARTIDO"===a){if(r.length>=4){let[,e,t,a]=r;return{kind:"PARTIDO",rivalId:e||void 0,rival:t||"",logoUrl:a||""}}if(r.length>=3){let[,e,t]=r;return{kind:"PARTIDO",rival:e||"",logoUrl:t||""}}return{kind:"PARTIDO"}}return"LIBRE"===a?{kind:"LIBRE"}:{kind:"NONE"}}(r?.title??"")}async function K(e,t,r){let a=Y(e,t),s=O(e,t),n=`${N(t)} | ${e}`,l=function(e){if("PARTIDO"===e.kind){let t=(e.rivalId||"").trim(),r=C(e.rival),a=C(e.logoUrl);return`PARTIDO|${t}|${r}|${a}`}return"LIBRE"===e.kind?"LIBRE":""}(r);try{if("NONE"===r.kind){a&&await (0,o.SO)(a.id),await q(p);return}a?await (0,o.CT)(a.id,{title:l,description:n,date:s}):await (0,o.ed)({title:l,description:n,date:s,type:"GENERAL"}),await q(p)}catch(e){console.error(e),alert(e?.message||"No se pudo actualizar el estado del d\xeda")}}function X(e,t){return Z(e).find(e=>$(e,t))}async function Q(e,t,r){let a=X(e,t),s=O(e,t),n=`${T(t)} | ${e}`,l=r||"";try{if(!r){a&&await (0,o.SO)(a.id),await q(p);return}a?await (0,o.CT)(a.id,{title:l,description:n,date:s}):await (0,o.ed)({title:l,description:n,date:s,type:"GENERAL"}),await q(p)}catch(e){console.error(e),alert(e?.message||"No se pudo actualizar la intensidad")}}let[ee,et]=(0,l.useState)({}),[er,ea]=(0,l.useState)(!1);function es(e,t,r,a){let s=R(e,t,r);et(n=>{let l={...n},i=z(e,t,r),o=i?.title?.trim()??"";return(a||"").trim()===o?delete l[s]:l[s]=a,l})}async function en(){let e=Object.entries(ee);if(0!==e.length){ea(!0);try{for(let[t,r]of e){let[e,a,s]=t.split("::"),n=z(e,a,s),l=O(e,a),i=k(a,s),d=(r??"").trim();if(!d){n&&await (0,o.SO)(n.id);continue}n?await (0,o.CT)(n.id,{title:d,description:n.description?.startsWith(i)?n.description:`${i} | ${e}`,date:l}):await (0,o.ed)({title:d,description:`${i} | ${e}`,date:l,type:"GENERAL"})}await q(p)}catch(e){console.error(e),alert(e?.message||"Error al guardar cambios")}finally{ea(!1)}}}function el({dayYmd:e,turn:t,row:r}){let s=z(e,t,r),n=(s?.title??"").trim(),i=R(e,t,r),o=void 0!==ee[i]?ee[i]:n;if(r===j){let[s,i]=(0,l.useState)(o||"");return a.jsx("input",{className:"h-8 w-full rounded-md border px-2 text-xs",placeholder:"Nombre de sesi\xf3n (ej: Sesi\xf3n 7 TM)",value:s,onChange:e=>i(e.target.value),onBlur:()=>{let a=(s||"").trim();a!==(n||"")&&es(e,t,r,a)},onKeyDown:e=>{"Enter"===e.key&&e.target.blur()}})}if("LUGAR"===r){let[s,n]=(0,l.useState)(o||"");return a.jsx("input",{list:"places-datalist",className:"h-8 w-full rounded-md border px-2 text-xs",placeholder:"Lugar (texto libre o sugerencias)",value:s,onChange:e=>n(e.target.value),onBlur:()=>es(e,t,r,(s||"").trim())})}if("HORA"===r){let s=/^[0-9]{2}:[0-9]{2}$/.test(o||"")?o:"";return a.jsx("input",{type:"time",className:"h-8 w-full rounded-md border px-2 text-xs",value:s,onChange:a=>es(e,t,r,a.target.value)})}if("VIDEO"===r){let s=function(e){let t=(e||"").trim();if(!t)return{label:"",url:""};let[r,a]=t.split("|").map(e=>e.trim());return!a&&r?.startsWith("http")?{label:"Video",url:r}:{label:r||"",url:a||""}}(o||""),[n,i]=(0,l.useState)(!(s.label||s.url)),[d,c]=(0,l.useState)(s.label),[u,x]=(0,l.useState)(s.url);return n?(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[a.jsx("input",{className:"h-8 w-[45%] rounded-md border px-2 text-xs",placeholder:"T\xedtulo",value:d,onChange:e=>c(e.target.value)}),a.jsx("input",{type:"url",className:"h-8 w-[55%] rounded-md border px-2 text-xs",placeholder:"https://…",value:u,onChange:e=>x(e.target.value)}),a.jsx("button",{type:"button",className:"h-8 px-2 rounded border text-[11px] hover:bg-gray-50",onClick:()=>{es(e,t,r,function(e,t){let r=(e||"").trim(),a=(t||"").trim();return r||a?!r&&a?a:`${r}|${a}`:""}(d,u)),i(!1)},title:"Listo",children:"✓"})]}):(0,a.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[s.url?a.jsx("a",{href:s.url,target:"_blank",rel:"noreferrer",className:"text-[12px] underline text-emerald-700 truncate",title:s.label||"Video",children:s.label||"Video"}):a.jsx("span",{className:"text-[12px] text-gray-500 truncate",children:s.label}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx("button",{type:"button",className:"h-6 px-1.5 rounded border text-[11px] hover:bg-gray-50",onClick:()=>i(!0),title:"Editar",children:"✏️"}),a.jsx("button",{type:"button",className:"h-6 px-1.5 rounded border text-[11px] hover:bg-gray-50",onClick:()=>es(e,t,r,""),title:"Borrar",children:"❌"})]})]})}return null}function ei({dayYmd:e,turn:t,row:r}){let s=z(e,t,r),n=(0,l.useRef)(null),i=ee[R(e,t,r)],o=void 0!==i?i:s?.title??"",d=s?.id?`/ct/sessions/${s.id}`:"",c=J(e,t),u="LIBRE"===c.kind?a.jsx("span",{className:"text-[10px] bg-gray-100 border px-1.5 py-0.5 rounded",children:"D\xcdA LIBRE"}):"PARTIDO"===c.kind?(0,a.jsxs)("span",{className:"text-[10px] bg-amber-100 border px-1.5 py-0.5 rounded",children:["PARTIDO ",c.rival?`vs ${c.rival}`:""]}):null;return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("div",{children:u}),d?a.jsx("a",{href:d,className:"text-[11px] rounded-lg border px-2 py-0.5 hover:bg-gray-50",title:"Abrir el ejercicio completo",children:"Ejercicio completo"}):null]}),a.jsx("div",{ref:n,contentEditable:!0,suppressContentEditableWarning:!0,onBlur:()=>{es(e,t,r,n.current?.innerText??"")},onKeyDown:a=>{(a.ctrlKey||a.metaKey)&&"Enter"===a.key&&(a.preventDefault(),es(e,t,r,n.current?.innerText??""))},className:"min-h-[90px] w-full rounded-xl border p-2 text-[13px] leading-5 outline-none focus:ring-2 focus:ring-emerald-400 whitespace-pre-wrap","data-placeholder":"Contenidos / t\xedtulos (breves)…",dangerouslySetInnerHTML:{__html:(o||"").replace(/\n/g,"<br/>")}})]})}function eo({ymd:e,turn:t}){let r=J(e,t),[s,n]=(0,l.useState)(r.kind),i=r=>K(e,t,r);return a.jsx("div",{className:"p-1",children:(0,a.jsxs)("select",{className:"h-7 w-[140px] rounded-md border px-1.5 text-[11px]",value:s,onChange:e=>{let t=e.target.value;return(n(t),"NONE"===t)?i({kind:"NONE"}):"LIBRE"===t?i({kind:"LIBRE"}):"PARTIDO"===t?i({kind:"PARTIDO",rival:"",logoUrl:"",rivalId:void 0}):void 0},children:[a.jsx("option",{value:"NONE",children:"Normal"}),a.jsx("option",{value:"PARTIDO",children:"Partido (MD)"}),a.jsx("option",{value:"LIBRE",children:"Descanso"})]})})}function ed({turn:e}){return(0,a.jsxs)("div",{className:"grid items-center border-b bg-gray-50/60",style:{gridTemplateColumns:"120px repeat(7, minmax(120px, 1fr))"},children:[a.jsx("div",{className:"px-2 py-1.5 text-[11px] font-medium text-gray-600",children:"Tipo"}),V.map(t=>a.jsx(eo,{ymd:t,turn:e},`${t}-${e}-status`))]})}function ec({ymd:e,turn:t}){let r=J(e,t);if("PARTIDO"!==r.kind)return a.jsx("div",{className:"h-6 text-[11px] text-gray-400 italic px-1 flex items-center",children:"—"});let[s,n]=(0,l.useState)(!(r.rival||r.logoUrl)),[i,o]=(0,l.useState)(r.rival||""),[d,c]=(0,l.useState)(r.logoUrl||""),[u,x]=(0,l.useState)(r.rivalId||""),p=async()=>{await K(e,t,{kind:"PARTIDO",rival:(i||"").trim(),logoUrl:(d||"").trim(),rivalId:(u||"").trim()||void 0}),n(!1)};if(!s){let r=`/ct/sessions/by-day/${e}/${t}`;return(0,a.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,a.jsxs)("div",{className:"h-6 text-[11px] px-1 flex items-center truncate gap-1",children:[d?a.jsx("img",{src:d,alt:"Logo",className:"w-[16px] h-[16px] object-contain rounded"}):null,a.jsx("span",{className:"truncate",children:i||"—"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(h.Z,{rivalId:u||void 0,rivalName:i||void 0,label:"Plan rival",className:"h-6",fallbackHref:r}),a.jsx("button",{type:"button",className:"h-6 px-1.5 rounded border text-[11px] hover:bg-gray-50",onClick:()=>n(!0),title:"Editar",children:"✏️"}),a.jsx("button",{type:"button",className:"h-6 px-1.5 rounded border text-[11px] hover:bg-gray-50",onClick:async()=>{o(""),c(""),x(""),await K(e,t,{kind:"PARTIDO",rival:"",logoUrl:"",rivalId:void 0})},title:"Borrar",children:"❌"})]})]})}return(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[a.jsx("input",{className:"h-8 w-[58%] rounded-md border px-2 text-xs",placeholder:"Rival (nombre o link /ct/rivales/:id)",value:i,onChange:e=>(function(e){o(e);let t=function(e){let t=e.match(/\/ct\/rivales\/([a-z0-9]+)(?:[/?#]|$)/i);return t?.[1]}(e);t&&x(t)})(e.target.value)}),a.jsx("input",{type:"url",className:"h-8 w-[34%] rounded-md border px-2 text-xs",placeholder:"Logo URL",value:d,onChange:e=>c(e.target.value)}),a.jsx("button",{type:"button",className:"h-8 px-2 rounded border text-[11px] hover:bg-gray-50",onClick:p,title:"Listo",children:"✓"})]})}function eu({turn:e}){return(0,a.jsxs)("div",{className:"grid items-center border-b",style:{gridTemplateColumns:"120px repeat(7, minmax(120px, 1fr))"},children:[a.jsx("div",{className:"px-2 py-1.5 text-[11px] font-medium text-gray-600",children:"Partido"}),V.map(t=>a.jsx("div",{className:"p-1",children:a.jsx(ec,{ymd:t,turn:e})},`${t}-${e}-partido`))]})}function ex({ymd:e,turn:t}){let[r,s]=(0,l.useState)(function(e,t){let r=X(e,t);return function(e){let t=(e||"").trim();return t&&E.find(e=>e.value===t)?.value||""}(r?.title)}(e,t)),n=E.find(e=>e.value===r)?.colorClass||"";return a.jsx("div",{className:`p-1 ${n}`,children:a.jsx("select",{className:`h-7 w-full rounded-md border px-1.5 text-[11px] ${n}`,value:r,onChange:async r=>{let a=r.target.value;s(a),await Q(e,t,a)},children:E.map(e=>a.jsx("option",{value:e.value,children:e.value||"—"},e.value||"none"))})})}function ep({turn:e}){return(0,a.jsxs)("div",{className:"grid items-center border-b",style:{gridTemplateColumns:"120px repeat(7, minmax(120px, 1fr))"},children:[a.jsx("div",{className:"px-2 py-1.5 text-[11px] font-medium text-gray-600",children:"Intensidad"}),V.map(t=>a.jsx(ex,{ymd:t,turn:e},`${t}-${e}-micro`))]})}function em({children:e}){return a.jsx("div",{className:"bg-emerald-50 text-emerald-900 font-semibold px-2 py-1 border-b uppercase tracking-wide text-[12px]",children:e})}let eg=Object.keys(ee).length;return(0,a.jsxs)("div",{className:"jsx-83c39fd188e7c9f3 p-3 md:p-4 space-y-3",children:[a.jsx(n(),{id:"83c39fd188e7c9f3",children:"[contenteditable][data-placeholder].jsx-83c39fd188e7c9f3:empty:before{content:attr(data-placeholder);color:#9ca3af;pointer-events:none;display:block}"}),!t&&(0,a.jsxs)("header",{className:"jsx-83c39fd188e7c9f3 flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[(0,a.jsxs)("div",{className:"jsx-83c39fd188e7c9f3",children:[a.jsx("h1",{className:"jsx-83c39fd188e7c9f3 text-lg md:text-xl font-bold",children:"Plan semanal — Editor en tabla"}),(0,a.jsxs)("p",{className:"jsx-83c39fd188e7c9f3 text-xs md:text-sm text-gray-500",children:["Semana ",P||"—"," → ",U||"—"," (Lun→Dom)"]})]}),(0,a.jsxs)("div",{className:"jsx-83c39fd188e7c9f3 flex flex-wrap items-center gap-2",children:[a.jsx("button",{onClick:()=>H(()=>m(e=>S(e,-7))),className:"jsx-83c39fd188e7c9f3 px-2.5 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"◀ Semana anterior"}),a.jsx("button",{onClick:()=>H(()=>m((0,o.$9)(new Date))),className:"jsx-83c39fd188e7c9f3 px-2.5 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"Hoy"}),a.jsx("button",{onClick:()=>H(()=>m(e=>S(e,7))),className:"jsx-83c39fd188e7c9f3 px-2.5 py-1.5 rounded-xl border hover:bg-gray-50 text-xs",children:"Semana siguiente ▶"}),a.jsx("div",{className:"jsx-83c39fd188e7c9f3 w-px h-6 bg-gray-200 mx-1"}),a.jsx("button",{onClick:en,disabled:0===eg||er,title:eg?`${eg} cambio(s) por guardar`:"Sin cambios",className:`jsx-83c39fd188e7c9f3 px-3 py-1.5 rounded-xl text-xs ${0===eg||er?"bg-gray-200 text-gray-500":"bg-black text-white hover:opacity-90"}`,children:er?"Guardando...":`Guardar cambios${eg?` (${eg})`:""}`})]})]}),(0,a.jsxs)("div",{className:"jsx-83c39fd188e7c9f3 flex items-center gap-2",children:[a.jsx("button",{onClick:()=>{x("editor"),c("morning")},className:`jsx-83c39fd188e7c9f3 px-3 py-1.5 rounded-xl border text-xs ${"editor"===u&&"morning"===d?"bg-black text-white":"hover:bg-gray-50"}`,children:"Ma\xf1ana"}),a.jsx("button",{onClick:()=>{x("editor"),c("afternoon")},className:`jsx-83c39fd188e7c9f3 px-3 py-1.5 rounded-xl border text-xs ${"editor"===u&&"afternoon"===d?"bg-black text-white":"hover:bg-gray-50"}`,children:"Tarde"}),a.jsx("button",{onClick:()=>x("tools"),title:"Herramientas","aria-label":"Herramientas",className:`jsx-83c39fd188e7c9f3 px-3 py-1.5 rounded-xl border text-xs ${"tools"===u?"bg-black text-white":"hover:bg-gray-50"}`,children:"⚙️"})]}),"tools"===u?a.jsx("div",{className:"jsx-83c39fd188e7c9f3 rounded-2xl border bg-white shadow-sm p-3",children:a.jsx(g,{onAfterChange:()=>{q(p),F()}})}):f?a.jsx("div",{className:"jsx-83c39fd188e7c9f3 text-gray-500",children:"Cargando semana…"}):a.jsx("div",{className:"jsx-83c39fd188e7c9f3 overflow-x-auto rounded-2xl border bg-white shadow-sm",children:a.jsx(function({turn:e}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid text-xs",style:{gridTemplateColumns:"120px repeat(7, minmax(120px, 1fr))"},children:[a.jsx("div",{className:"bg-gray-50 border-b px-2 py-1.5 font-semibold text-gray-600"}),V.map(t=>(0,a.jsxs)("div",{className:"bg-gray-50 border-b px-2 py-1.5",children:[a.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide",children:new Date(`${t}T00:00:00.000Z`).toLocaleDateString(void 0,{weekday:"short",day:"2-digit",month:"2-digit",timeZone:"UTC"})}),a.jsx("div",{className:"text-[10px] text-gray-400",children:t})]},`${e}-${t}`))]}),a.jsx(em,{children:"MICROCICLO"}),a.jsx(ed,{turn:e}),a.jsx(ep,{turn:e}),a.jsx(eu,{turn:e}),a.jsx(em,{children:"DETALLES"}),v.map(t=>(0,a.jsxs)("div",{className:"grid items-center",style:{gridTemplateColumns:"120px repeat(7, minmax(120px, 1fr))"},children:[a.jsx("div",{className:"bg-gray-50/60 border-r px-2 py-1.5 text-[11px] font-medium text-gray-600",children:t}),V.map(r=>a.jsx("div",{className:"p-1",children:a.jsx(el,{dayYmd:r,turn:e,row:t})},`${r}-${e}-${t}`))]},`${e}-meta-${t}`)),(0,a.jsxs)("div",{className:"border-t",children:[(0,a.jsxs)("div",{className:"px-2 py-1 text-[10px] text-gray-600 border-b bg-gray-50",children:["Escrib\xed el ",a.jsx("b",{children:"contenido general"})," (t\xedtulos). El detalle se edita en ",a.jsx("b",{children:"“Ejercicio completo”"}),"."]}),a.jsx("div",{className:"bg-emerald-100/70 text-emerald-900 font-semibold px-2 py-1 border-b uppercase tracking-wide text-[12px]",children:"morning"===e?"TURNO MA\xd1ANA":"TURNO TARDE"}),y.map(t=>(0,a.jsxs)("div",{className:"grid items-stretch",style:{gridTemplateColumns:"120px repeat(7, minmax(120px, 1fr))"},children:[a.jsx("div",{className:"bg-gray-50/60 border-r px-2 py-2 text-[11px] font-medium text-gray-600 whitespace-pre-line",children:W(t)}),V.map(r=>a.jsx("div",{className:"p-1",children:a.jsx(ei,{dayYmd:r,turn:e,row:t})},`${r}-${e}-${t}`))]},`${e}-${t}`))]})]})},{turn:d,className:"jsx-83c39fd188e7c9f3"})}),a.jsx("datalist",{id:"places-datalist",className:"jsx-83c39fd188e7c9f3",children:(B||[]).map(e=>a.jsx("option",{value:e,className:"jsx-83c39fd188e7c9f3"},e))})]})}},82882:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var a=r(10326),s=r(17577);function n({text:e,side:t="top",className:r="",sizePx:n=16}){let l=s.useId(),i=(()=>{switch(t){case"bottom":return"left-1/2 -translate-x-1/2 top-full mt-1";case"left":return"right-full mr-2 top-1/2 -translate-y-1/2";case"right":return"left-full ml-2 top-1/2 -translate-y-1/2";default:return"left-1/2 -translate-x-1/2 bottom-full mb-1"}})(),o="absolute w-0 h-0 border-transparent",d=Math.max(12,Math.min(22,n)),c=(()=>{switch(t){case"bottom":return a.jsx("span",{"aria-hidden":!0,className:`${o} left-1/2 -translate-x-1/2 -top-[6px] border-b-white border-[6px]`,style:{borderTopWidth:0,borderLeftColor:"transparent",borderRightColor:"transparent"}});case"left":return a.jsx("span",{"aria-hidden":!0,className:`${o} -right-[6px] top-1/2 -translate-y-1/2 border-l-white border-[6px]`,style:{borderTopColor:"transparent",borderBottomColor:"transparent",borderRightWidth:0}});case"right":return a.jsx("span",{"aria-hidden":!0,className:`${o} -left-[6px] top-1/2 -translate-y-1/2 border-r-white border-[6px]`,style:{borderTopColor:"transparent",borderBottomColor:"transparent",borderLeftWidth:0}});default:return a.jsx("span",{"aria-hidden":!0,className:`${o} left-1/2 -translate-x-1/2 -bottom-[6px] border-t-white border-[6px]`,style:{borderLeftColor:"transparent",borderRightColor:"transparent",borderBottomWidth:0}})}})();return a.jsx("span",{className:`relative inline-flex items-center align-middle ${r}`,children:(0,a.jsxs)("span",{className:"group relative inline-flex",children:[a.jsx("button",{type:"button","aria-describedby":l,className:"inline-flex items-center justify-center rounded-full border text-[10px] leading-none select-none cursor-help text-gray-700 border-gray-300 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-black",style:{width:d,height:d},children:"?"}),(0,a.jsxs)("span",{id:l,role:"tooltip",className:`pointer-events-none absolute z-50 hidden max-w-xs rounded-md border bg-white px-2 py-1 text-xs text-gray-700 shadow-lg ${i} group-hover:block group-focus-within:block`,children:[e,c]})]})})}},25074:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var a=r(10326),s=r(17577);let n=function(){for(var e,t,r=0,a="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=function e(t){var r,a,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t){if(Array.isArray(t)){var n=t.length;for(r=0;r<n;r++)t[r]&&(a=e(t[r]))&&(s&&(s+=" "),s+=a)}else for(a in t)t[a]&&(s&&(s+=" "),s+=a)}return s}(e))&&(a&&(a+=" "),a+=t);return a};function l({rivalId:e,rivalName:t,label:r="Plan de partido",className:l,fallbackHref:i,tab:o="plan"}){let[d,c]=(0,s.useState)(null),[u,x]=(0,s.useState)(!1),p=(t||"").trim(),m=(0,s.useMemo)(()=>{if(!e)return"";let t=o?`?tab=${encodeURIComponent(o)}`:"";return`/ct/rivales/${e}${t}`},[e,o]),g=(0,s.useMemo)(()=>{if(m)return m;if(d?.id){let e=o?`?tab=${encodeURIComponent(o)}`:"";return`/ct/rivales/${d.id}${e}`}return i||(p?`/ct/rivales?search=${encodeURIComponent(p)}`:"/ct/rivales")},[m,d,i,p,o]);return a.jsx("a",{href:g,className:n("inline-flex items-center rounded border px-1.5 py-0.5 text-[11px] hover:bg-gray-100 whitespace-nowrap",l),title:d?.name||p||"Plan de partido","aria-busy":u,children:r})}},67317:(e,t,r)=>{"use strict";function a(e){let t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),a=String(e.getUTCDate()).padStart(2,"0");return`${t}-${r}-${a}`}function s(e){let t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())),r=t.getUTCDay()||7;return 1!==r&&t.setUTCDate(t.getUTCDate()-(r-1)),t.setUTCHours(0,0,0,0),t}async function n({start:e}){let t=await fetch(`/api/sessions?start=${encodeURIComponent(e)}`,{cache:"no-store"}),r=await t.json();if(!t.ok)throw Error(r?.error||"No se pudo cargar la semana");return r}async function l(e){let t=await fetch("/api/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw Error(r?.error||"Error al crear la sesi\xf3n");return r}async function i(e,t){let r=await fetch(`/api/sessions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await r.json();if(!r.ok)throw Error(a?.error||"Error al actualizar la sesi\xf3n");return a}async function o(e){let t=await fetch(`/api/sessions/${e}`,{method:"DELETE"}),r=await t.json();if(!t.ok)throw Error(r?.error||"Error al borrar la sesi\xf3n");return r}r.d(t,{$9:()=>s,CT:()=>i,SO:()=>o,VA:()=>a,ed:()=>l,tO:()=>n})},40210:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>l,__esModule:()=>n,default:()=>o,dynamic:()=>i});var a=r(68570);let s=(0,a.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/plan-semanal/page.tsx`),{__esModule:n,$$typeof:l}=s;s.default;let i=(0,a.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/plan-semanal/page.tsx#dynamic`),o=(0,a.createProxy)(String.raw`/Users/Fran/ctbrain-14/src/app/ct/plan-semanal/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,1159,9404,2473],()=>r(28221));module.exports=a})();