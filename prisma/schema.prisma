// ---------- PRISMA SCHEMA (CTBrain) ----------
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ------- MODELOS EXISTENTES (ejemplo mínimo) -------
// Asegurate de mantener tu User/Role tal como ya lo tenés.
// Si ya existen, dejalos. Si tus nombres difieren, adaptá los @relation.

enum Role {
  ADMIN
  CT
  MEDICO
  JUGADOR
  DIRECTIVO
}

// Si YA TENÉS este modelo, mantené tu versión (no dupliques).
model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  role      Role     @default(JUGADOR)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relación con Session (creadas por un CT/Admin)
  sessionsCreated Session[] @relation("SessionsCreatedBy")
}

// ------- NUEVO: Enum de tipos de sesión -------
enum SessionType {
  PARTIDO
  TACTICO
  FUERZA
  RECUPERACION
  EVALUACION
  LIBRE
}

// ------- NUEVO: Modelo Session -------
model Session {
  id          String      @id @default(cuid())
  date        DateTime    // Día base de la sesión (UTC)
  start       DateTime?   // Inicio (UTC)
  end         DateTime?   // Fin (UTC)
  title       String
  type        SessionType
  notes       String?     @db.Text
  rpe         Int?        // 0-10
  load        Int?        // Carga interna (arbitraria)
  microcycle  Int?        // Semana ISO (opcional si lo usás)
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  // Quién la creó (CT/Admin). Ajustá si tu User se llama distinto.
  createdById String
  createdBy   User        @relation("SessionsCreatedBy", fields: [createdById], references: [id], onDelete: Cascade)

  @@index([date])
  @@index([type])
  @@index([createdById])
}
